var gv=Object.defineProperty;var pl=t=>{throw TypeError(t)};var xv=(t,e,r)=>e in t?gv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var _=(t,e,r)=>xv(t,typeof e!="symbol"?e+"":e,r),Pi=(t,e,r)=>e.has(t)||pl("Cannot "+r);var N=(t,e,r)=>(Pi(t,e,"read from private field"),r?r.call(t):e.get(t)),de=(t,e,r)=>e.has(t)?pl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),J=(t,e,r,a)=>(Pi(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),Ne=(t,e,r)=>(Pi(t,e,"access private method"),r);var bn=(t,e,r,a)=>({set _(n){J(t,e,n,r)},get _(){return N(t,e,a)}});import{j as s,P as Ae,c as um,a as $r,u as ot,B as yv,b as qa,d as qr,e as Jt,f as xe,R as vv,g as hm,h as ts,i as bv,k as ii,A as mm,D as fm,C as pm,l as gm,m as wv,S as xm,O as ym,n as vm,o as jv,T as bm,p as wm,q as Nv,r as Sv,s as kv,t as jm,v as Nm,w as Cv,x as Sm,I as km,y as Cm,z as _m,E as Tm,L as Pm,F as Am,G as _v,H as Tv,J as To,K as Em,M as oi,N as Pv,Q as Av,U as Ev,V as Iv,W as Rv,X as Mv,Y as Ov,Z as Dv,_ as Fv}from"./ui-BiUw_ZU1.js";import{a as li,r as d,c as Lv,R as De}from"./vendor-CX2mysxk.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Im,gl=li;Im=gl.createRoot,gl.hydrateRoot;function Vv(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,a,n,i,o=[],l="",c=t.split("/");for(c[0]||c.shift();n=c.shift();)r=n[0],r==="*"?(o.push(r),l+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(a=n.indexOf("?",1),i=n.indexOf(".",1),o.push(n.substring(1,~a?a:~i?i:n.length)),l+=~a&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(l+=(~a?"?":"")+"\\"+n.substring(i))):l+="/"+n;return{keys:o,pattern:new RegExp("^"+l+(e?"(?=$|/)":"/?$"),"i")}}var Rm={exports:{}},Mm={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fa=d;function zv(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $v=typeof Object.is=="function"?Object.is:zv,qv=fa.useState,Uv=fa.useEffect,Bv=fa.useLayoutEffect,Kv=fa.useDebugValue;function Qv(t,e){var r=e(),a=qv({inst:{value:r,getSnapshot:e}}),n=a[0].inst,i=a[1];return Bv(function(){n.value=r,n.getSnapshot=e,Ai(n)&&i({inst:n})},[t,r,e]),Uv(function(){return Ai(n)&&i({inst:n}),t(function(){Ai(n)&&i({inst:n})})},[t]),Kv(r),r}function Ai(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!$v(t,r)}catch{return!0}}function Hv(t,e){return e()}var Zv=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Hv:Qv;Mm.useSyncExternalStore=fa.useSyncExternalStore!==void 0?fa.useSyncExternalStore:Zv;Rm.exports=Mm;var Wv=Rm.exports;const Gv=Lv.useInsertionEffect,Xv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Jv=Xv?d.useLayoutEffect:d.useEffect,Yv=Gv||Jv,Om=t=>{const e=d.useRef([t,(...r)=>e[0](...r)]).current;return Yv(()=>{e[0]=t}),e[1]},e0="popstate",Po="pushState",Ao="replaceState",t0="hashchange",xl=[e0,Po,Ao,t0],s0=t=>{for(const e of xl)addEventListener(e,t);return()=>{for(const e of xl)removeEventListener(e,t)}},Dm=(t,e)=>Wv.useSyncExternalStore(s0,t,e),r0=()=>location.search,a0=({ssrSearch:t=""}={})=>Dm(r0,()=>t),yl=()=>location.pathname,n0=({ssrPath:t}={})=>Dm(yl,t?()=>t:yl),i0=(t,{replace:e=!1,state:r=null}={})=>history[e?Ao:Po](r,"",t),o0=(t={})=>[n0(t),i0],vl=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[vl]>"u"){for(const t of[Po,Ao]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),a=new Event(t);return a.arguments=arguments,dispatchEvent(a),r}}Object.defineProperty(window,vl,{value:!0})}const l0=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",Fm=(t="")=>t==="/"?"":t,c0=(t,e)=>t[0]==="~"?t.slice(1):Fm(e)+t,d0=(t="",e)=>l0(bl(Fm(t)),bl(e)),bl=t=>{try{return decodeURI(t)}catch{return t}},Lm={hook:o0,searchHook:a0,parser:Vv,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:t=>t},Vm=d.createContext(Lm),ja=()=>d.useContext(Vm),zm={},$m=d.createContext(zm),qm=()=>d.useContext($m),ci=t=>{const[e,r]=t.hook(t);return[d0(t.base,e),Om((a,n)=>r(c0(a,t.base),n))]},ys=()=>ci(ja()),Eo=(t,e,r,a)=>{const{pattern:n,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",a),o=n.exec(r)||[],[l,...c]=o;return l!==void 0?[!0,(()=>{const h=i!==!1?Object.fromEntries(i.map((p,f)=>[p,c[f]])):o.groups;let u={...c};return h&&Object.assign(u,h),u})(),...a?[l]:[]]:[!1,null]},Um=t=>Eo(ja().parser,t,ys()[0]),u0=({children:t,...e})=>{var u,p;const r=ja(),a=e.hook?Lm:r;let n=a;const[i,o]=((u=e.ssrPath)==null?void 0:u.split("?"))??[];o&&(e.ssrSearch=o,e.ssrPath=i),e.hrefs=e.hrefs??((p=e.hook)==null?void 0:p.hrefs);let l=d.useRef({}),c=l.current,h=c;for(let f in a){const g=f==="base"?a[f]+(e[f]||""):e[f]||a[f];c===h&&g!==h[f]&&(l.current=h={...h}),h[f]=g,g!==a[f]&&(n=h)}return d.createElement(Vm.Provider,{value:n,children:t})},wl=({children:t,component:e},r)=>e?d.createElement(e,{params:r}):typeof t=="function"?t(r):t,h0=t=>{let e=d.useRef(zm),r=e.current;for(const a in t)t[a]!==r[a]&&(r=t);return Object.keys(t).length===0&&(r=t),e.current=r},rt=({path:t,nest:e,match:r,...a})=>{const n=ja(),[i]=ci(n),[o,l,c]=r??Eo(n.parser,t,i,e),h=h0({...qm(),...l});if(!o)return null;const u=c?d.createElement(u0,{base:c},wl(a,h)):wl(a,h);return d.createElement($m.Provider,{value:h,children:u})},jt=d.forwardRef((t,e)=>{const r=ja(),[a,n]=ci(r),{to:i="",href:o=i,onClick:l,asChild:c,children:h,className:u,replace:p,state:f,...g}=t,j=Om(m=>{m.ctrlKey||m.metaKey||m.altKey||m.shiftKey||m.button!==0||(l==null||l(m),m.defaultPrevented||(m.preventDefault(),n(o,t)))}),x=r.hrefs(o[0]==="~"?o.slice(1):r.base+o,r);return c&&d.isValidElement(h)?d.cloneElement(h,{onClick:j,href:x}):d.createElement("a",{...g,onClick:j,href:x,className:u!=null&&u.call?u(a===o):u,children:h,ref:e})}),Bm=t=>Array.isArray(t)?t.flatMap(e=>Bm(e&&e.type===d.Fragment?e.props.children:e)):[t],m0=({children:t,location:e})=>{const r=ja(),[a]=ci(r);for(const n of Bm(t)){let i=0;if(d.isValidElement(n)&&(i=Eo(r.parser,n.props.path,e||a,n.props.nest))[0])return d.cloneElement(n,{match:i})}return null};var Na=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Mr=typeof window>"u"||"Deno"in globalThis;function as(){}function f0(t,e){return typeof t=="function"?t(e):t}function qi(t){return typeof t=="number"&&t>=0&&t!==1/0}function Km(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Zr(t,e){return typeof t=="function"?t(e):t}function ds(t,e){return typeof t=="function"?t(e):t}function jl(t,e){const{type:r="all",exact:a,fetchStatus:n,predicate:i,queryKey:o,stale:l}=t;if(o){if(a){if(e.queryHash!==Io(o,e.options))return!1}else if(!Ua(e.queryKey,o))return!1}if(r!=="all"){const c=e.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||n&&n!==e.state.fetchStatus||i&&!i(e))}function Nl(t,e){const{exact:r,status:a,predicate:n,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(r){if(Or(e.options.mutationKey)!==Or(i))return!1}else if(!Ua(e.options.mutationKey,i))return!1}return!(a&&e.state.status!==a||n&&!n(e))}function Io(t,e){return((e==null?void 0:e.queryKeyHashFn)||Or)(t)}function Or(t){return JSON.stringify(t,(e,r)=>Ui(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function Ua(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(r=>!Ua(t[r],e[r])):!1}function Qm(t,e){if(t===e)return t;const r=Sl(t)&&Sl(e);if(r||Ui(t)&&Ui(e)){const a=r?t:Object.keys(t),n=a.length,i=r?e:Object.keys(e),o=i.length,l=r?[]:{};let c=0;for(let h=0;h<o;h++){const u=r?h:i[h];(!r&&a.includes(u)||r)&&t[u]===void 0&&e[u]===void 0?(l[u]=void 0,c++):(l[u]=Qm(t[u],e[u]),l[u]===t[u]&&t[u]!==void 0&&c++)}return n===o&&c===n?t:l}return e}function En(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function Sl(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Ui(t){if(!kl(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!kl(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function kl(t){return Object.prototype.toString.call(t)==="[object Object]"}function p0(t){return new Promise(e=>{setTimeout(e,t)})}function Bi(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?Qm(t,e):e}function g0(t,e,r=0){const a=[...t,e];return r&&a.length>r?a.slice(1):a}function x0(t,e,r=0){const a=[e,...t];return r&&a.length>r?a.slice(0,-1):a}var Ro=Symbol();function Hm(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Ro?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var Cr,Js,ta,vc,y0=(vc=class extends Na{constructor(){super();de(this,Cr);de(this,Js);de(this,ta);J(this,ta,e=>{if(!Mr&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){N(this,Js)||this.setEventListener(N(this,ta))}onUnsubscribe(){var e;this.hasListeners()||((e=N(this,Js))==null||e.call(this),J(this,Js,void 0))}setEventListener(e){var r;J(this,ta,e),(r=N(this,Js))==null||r.call(this),J(this,Js,e(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(e){N(this,Cr)!==e&&(J(this,Cr,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof N(this,Cr)=="boolean"?N(this,Cr):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Cr=new WeakMap,Js=new WeakMap,ta=new WeakMap,vc),Mo=new y0,sa,Ys,ra,bc,v0=(bc=class extends Na{constructor(){super();de(this,sa,!0);de(this,Ys);de(this,ra);J(this,ra,e=>{if(!Mr&&window.addEventListener){const r=()=>e(!0),a=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}}})}onSubscribe(){N(this,Ys)||this.setEventListener(N(this,ra))}onUnsubscribe(){var e;this.hasListeners()||((e=N(this,Ys))==null||e.call(this),J(this,Ys,void 0))}setEventListener(e){var r;J(this,ra,e),(r=N(this,Ys))==null||r.call(this),J(this,Ys,e(this.setOnline.bind(this)))}setOnline(e){N(this,sa)!==e&&(J(this,sa,e),this.listeners.forEach(a=>{a(e)}))}isOnline(){return N(this,sa)}},sa=new WeakMap,Ys=new WeakMap,ra=new WeakMap,bc),In=new v0;function Ki(){let t,e;const r=new Promise((n,i)=>{t=n,e=i});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),t(n)},r.reject=n=>{a({status:"rejected",reason:n}),e(n)},r}function b0(t){return Math.min(1e3*2**t,3e4)}function Zm(t){return(t??"online")==="online"?In.isOnline():!0}var Wm=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Ei(t){return t instanceof Wm}function Gm(t){let e=!1,r=0,a=!1,n;const i=Ki(),o=x=>{var m;a||(f(new Wm(x)),(m=t.abort)==null||m.call(t))},l=()=>{e=!0},c=()=>{e=!1},h=()=>Mo.isFocused()&&(t.networkMode==="always"||In.isOnline())&&t.canRun(),u=()=>Zm(t.networkMode)&&t.canRun(),p=x=>{var m;a||(a=!0,(m=t.onSuccess)==null||m.call(t,x),n==null||n(),i.resolve(x))},f=x=>{var m;a||(a=!0,(m=t.onError)==null||m.call(t,x),n==null||n(),i.reject(x))},g=()=>new Promise(x=>{var m;n=S=>{(a||h())&&x(S)},(m=t.onPause)==null||m.call(t)}).then(()=>{var x;n=void 0,a||(x=t.onContinue)==null||x.call(t)}),j=()=>{if(a)return;let x;const m=r===0?t.initialPromise:void 0;try{x=m??t.fn()}catch(S){x=Promise.reject(S)}Promise.resolve(x).then(p).catch(S=>{var D;if(a)return;const v=t.retry??(Mr?0:3),y=t.retryDelay??b0,C=typeof y=="function"?y(r,S):y,k=v===!0||typeof v=="number"&&r<v||typeof v=="function"&&v(r,S);if(e||!k){f(S);return}r++,(D=t.onFail)==null||D.call(t,r,S),p0(C).then(()=>h()?void 0:g()).then(()=>{e?f(S):j()})})};return{promise:i,cancel:o,continue:()=>(n==null||n(),i),cancelRetry:l,continueRetry:c,canStart:u,start:()=>(u()?j():g().then(j),i)}}function w0(){let t=[],e=0,r=l=>{l()},a=l=>{l()},n=l=>setTimeout(l,0);const i=l=>{e?t.push(l):n(()=>{r(l)})},o=()=>{const l=t;t=[],l.length&&n(()=>{a(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;e++;try{c=l()}finally{e--,e||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{a=l},setScheduler:l=>{n=l}}}var mt=w0(),_r,wc,Xm=(wc=class{constructor(){de(this,_r)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),qi(this.gcTime)&&J(this,_r,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Mr?1/0:5*60*1e3))}clearGcTimeout(){N(this,_r)&&(clearTimeout(N(this,_r)),J(this,_r,void 0))}},_r=new WeakMap,wc),aa,na,rs,Tt,cn,Tr,cs,Ds,jc,j0=(jc=class extends Xm{constructor(e){super();de(this,cs);de(this,aa);de(this,na);de(this,rs);de(this,Tt);de(this,cn);de(this,Tr);J(this,Tr,!1),J(this,cn,e.defaultOptions),this.setOptions(e.options),this.observers=[],J(this,rs,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,J(this,aa,N0(this.options)),this.state=e.state??N(this,aa),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=N(this,Tt))==null?void 0:e.promise}setOptions(e){this.options={...N(this,cn),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&N(this,rs).remove(this)}setData(e,r){const a=Bi(this.state.data,e,this.options);return Ne(this,cs,Ds).call(this,{data:a,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),a}setState(e,r){Ne(this,cs,Ds).call(this,{type:"setState",state:e,setStateOptions:r})}cancel(e){var a,n;const r=(a=N(this,Tt))==null?void 0:a.promise;return(n=N(this,Tt))==null||n.cancel(e),r?r.then(as).catch(as):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(N(this,aa))}isActive(){return this.observers.some(e=>ds(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ro||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!Km(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(a=>a.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=N(this,Tt))==null||r.continue()}onOnline(){var r;const e=this.observers.find(a=>a.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=N(this,Tt))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),N(this,rs).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(N(this,Tt)&&(N(this,Tr)?N(this,Tt).cancel({revert:!0}):N(this,Tt).cancelRetry()),this.scheduleGc()),N(this,rs).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ne(this,cs,Ds).call(this,{type:"invalidate"})}fetch(e,r){var c,h,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(N(this,Tt))return N(this,Tt).continueRetry(),N(this,Tt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const p=this.observers.find(f=>f.options.queryFn);p&&this.setOptions(p.options)}const a=new AbortController,n=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(J(this,Tr,!0),a.signal)})},i=()=>{const p=Hm(this.options,r),f={queryKey:this.queryKey,meta:this.meta};return n(f),J(this,Tr,!1),this.options.persister?this.options.persister(p,f,this):p(f)},o={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};n(o),(c=this.options.behavior)==null||c.onFetch(o,this),J(this,na,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=o.fetchOptions)==null?void 0:h.meta))&&Ne(this,cs,Ds).call(this,{type:"fetch",meta:(u=o.fetchOptions)==null?void 0:u.meta});const l=p=>{var f,g,j,x;Ei(p)&&p.silent||Ne(this,cs,Ds).call(this,{type:"error",error:p}),Ei(p)||((g=(f=N(this,rs).config).onError)==null||g.call(f,p,this),(x=(j=N(this,rs).config).onSettled)==null||x.call(j,this.state.data,p,this)),this.scheduleGc()};return J(this,Tt,Gm({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:a.abort.bind(a),onSuccess:p=>{var f,g,j,x;if(p===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(p)}catch(m){l(m);return}(g=(f=N(this,rs).config).onSuccess)==null||g.call(f,p,this),(x=(j=N(this,rs).config).onSettled)==null||x.call(j,p,this.state.error,this),this.scheduleGc()},onError:l,onFail:(p,f)=>{Ne(this,cs,Ds).call(this,{type:"failed",failureCount:p,error:f})},onPause:()=>{Ne(this,cs,Ds).call(this,{type:"pause"})},onContinue:()=>{Ne(this,cs,Ds).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),N(this,Tt).start()}},aa=new WeakMap,na=new WeakMap,rs=new WeakMap,Tt=new WeakMap,cn=new WeakMap,Tr=new WeakMap,cs=new WeakSet,Ds=function(e){const r=a=>{switch(e.type){case"failed":return{...a,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...Jm(a.data,this.options),fetchMeta:e.meta??null};case"success":return{...a,data:e.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=e.error;return Ei(n)&&n.revert&&N(this,na)?{...N(this,na),fetchStatus:"idle"}:{...a,error:n,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...e.state}}};this.state=r(this.state),mt.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),N(this,rs).notify({query:this,type:"updated",action:e})})},jc);function Jm(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Zm(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function N0(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,a=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var bs,Nc,S0=(Nc=class extends Na{constructor(e={}){super();de(this,bs);this.config=e,J(this,bs,new Map)}build(e,r,a){const n=r.queryKey,i=r.queryHash??Io(n,r);let o=this.get(i);return o||(o=new j0({cache:this,queryKey:n,queryHash:i,options:e.defaultQueryOptions(r),state:a,defaultOptions:e.getQueryDefaults(n)}),this.add(o)),o}add(e){N(this,bs).has(e.queryHash)||(N(this,bs).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const r=N(this,bs).get(e.queryHash);r&&(e.destroy(),r===e&&N(this,bs).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){mt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return N(this,bs).get(e)}getAll(){return[...N(this,bs).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(a=>jl(r,a))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(a=>jl(e,a)):r}notify(e){mt.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){mt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){mt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},bs=new WeakMap,Nc),ws,Et,Pr,js,Ws,Sc,k0=(Sc=class extends Xm{constructor(e){super();de(this,js);de(this,ws);de(this,Et);de(this,Pr);this.mutationId=e.mutationId,J(this,Et,e.mutationCache),J(this,ws,[]),this.state=e.state||Ym(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){N(this,ws).includes(e)||(N(this,ws).push(e),this.clearGcTimeout(),N(this,Et).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){J(this,ws,N(this,ws).filter(r=>r!==e)),this.scheduleGc(),N(this,Et).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){N(this,ws).length||(this.state.status==="pending"?this.scheduleGc():N(this,Et).remove(this))}continue(){var e;return((e=N(this,Pr))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var n,i,o,l,c,h,u,p,f,g,j,x,m,S,v,y,C,k,D,Q;J(this,Pr,Gm({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(H,M)=>{Ne(this,js,Ws).call(this,{type:"failed",failureCount:H,error:M})},onPause:()=>{Ne(this,js,Ws).call(this,{type:"pause"})},onContinue:()=>{Ne(this,js,Ws).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>N(this,Et).canRun(this)}));const r=this.state.status==="pending",a=!N(this,Pr).canStart();try{if(!r){Ne(this,js,Ws).call(this,{type:"pending",variables:e,isPaused:a}),await((i=(n=N(this,Et).config).onMutate)==null?void 0:i.call(n,e,this));const M=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,e));M!==this.state.context&&Ne(this,js,Ws).call(this,{type:"pending",context:M,variables:e,isPaused:a})}const H=await N(this,Pr).start();return await((h=(c=N(this,Et).config).onSuccess)==null?void 0:h.call(c,H,e,this.state.context,this)),await((p=(u=this.options).onSuccess)==null?void 0:p.call(u,H,e,this.state.context)),await((g=(f=N(this,Et).config).onSettled)==null?void 0:g.call(f,H,null,this.state.variables,this.state.context,this)),await((x=(j=this.options).onSettled)==null?void 0:x.call(j,H,null,e,this.state.context)),Ne(this,js,Ws).call(this,{type:"success",data:H}),H}catch(H){try{throw await((S=(m=N(this,Et).config).onError)==null?void 0:S.call(m,H,e,this.state.context,this)),await((y=(v=this.options).onError)==null?void 0:y.call(v,H,e,this.state.context)),await((k=(C=N(this,Et).config).onSettled)==null?void 0:k.call(C,void 0,H,this.state.variables,this.state.context,this)),await((Q=(D=this.options).onSettled)==null?void 0:Q.call(D,void 0,H,e,this.state.context)),H}finally{Ne(this,js,Ws).call(this,{type:"error",error:H})}}finally{N(this,Et).runNext(this)}}},ws=new WeakMap,Et=new WeakMap,Pr=new WeakMap,js=new WeakSet,Ws=function(e){const r=a=>{switch(e.type){case"failed":return{...a,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...a,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:e.error,failureCount:a.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),mt.batch(()=>{N(this,ws).forEach(a=>{a.onMutationUpdate(e)}),N(this,Et).notify({mutation:this,type:"updated",action:e})})},Sc);function Ym(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Gt,dn,kc,C0=(kc=class extends Na{constructor(e={}){super();de(this,Gt);de(this,dn);this.config=e,J(this,Gt,new Map),J(this,dn,Date.now())}build(e,r,a){const n=new k0({mutationCache:this,mutationId:++bn(this,dn)._,options:e.defaultMutationOptions(r),state:a});return this.add(n),n}add(e){const r=wn(e),a=N(this,Gt).get(r)??[];a.push(e),N(this,Gt).set(r,a),this.notify({type:"added",mutation:e})}remove(e){var a;const r=wn(e);if(N(this,Gt).has(r)){const n=(a=N(this,Gt).get(r))==null?void 0:a.filter(i=>i!==e);n&&(n.length===0?N(this,Gt).delete(r):N(this,Gt).set(r,n))}this.notify({type:"removed",mutation:e})}canRun(e){var a;const r=(a=N(this,Gt).get(wn(e)))==null?void 0:a.find(n=>n.state.status==="pending");return!r||r===e}runNext(e){var a;const r=(a=N(this,Gt).get(wn(e)))==null?void 0:a.find(n=>n!==e&&n.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){mt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...N(this,Gt).values()].flat()}find(e){const r={exact:!0,...e};return this.getAll().find(a=>Nl(r,a))}findAll(e={}){return this.getAll().filter(r=>Nl(e,r))}notify(e){mt.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return mt.batch(()=>Promise.all(e.map(r=>r.continue().catch(as))))}},Gt=new WeakMap,dn=new WeakMap,kc);function wn(t){var e;return((e=t.options.scope)==null?void 0:e.id)??String(t.mutationId)}function Cl(t){return{onFetch:(e,r)=>{var u,p,f,g,j;const a=e.options,n=(f=(p=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:p.fetchMore)==null?void 0:f.direction,i=((g=e.state.data)==null?void 0:g.pages)||[],o=((j=e.state.data)==null?void 0:j.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const h=async()=>{let x=!1;const m=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(e.signal.aborted?x=!0:e.signal.addEventListener("abort",()=>{x=!0}),e.signal)})},S=Hm(e.options,e.fetchOptions),v=async(y,C,k)=>{if(x)return Promise.reject();if(C==null&&y.pages.length)return Promise.resolve(y);const D={queryKey:e.queryKey,pageParam:C,direction:k?"backward":"forward",meta:e.options.meta};m(D);const Q=await S(D),{maxPages:H}=e.options,M=k?x0:g0;return{pages:M(y.pages,Q,H),pageParams:M(y.pageParams,C,H)}};if(n&&i.length){const y=n==="backward",C=y?_0:_l,k={pages:i,pageParams:o},D=C(a,k);l=await v(k,D,y)}else{const y=t??i.length;do{const C=c===0?o[0]??a.initialPageParam:_l(a,l);if(c>0&&C==null)break;l=await v(l,C),c++}while(c<y)}return l};e.options.persister?e.fetchFn=()=>{var x,m;return(m=(x=e.options).persister)==null?void 0:m.call(x,h,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=h}}}function _l(t,{pages:e,pageParams:r}){const a=e.length-1;return e.length>0?t.getNextPageParam(e[a],e,r[a],r):void 0}function _0(t,{pages:e,pageParams:r}){var a;return e.length>0?(a=t.getPreviousPageParam)==null?void 0:a.call(t,e[0],e,r[0],r):void 0}var et,er,tr,ia,oa,sr,la,ca,Cc,T0=(Cc=class{constructor(t={}){de(this,et);de(this,er);de(this,tr);de(this,ia);de(this,oa);de(this,sr);de(this,la);de(this,ca);J(this,et,t.queryCache||new S0),J(this,er,t.mutationCache||new C0),J(this,tr,t.defaultOptions||{}),J(this,ia,new Map),J(this,oa,new Map),J(this,sr,0)}mount(){bn(this,sr)._++,N(this,sr)===1&&(J(this,la,Mo.subscribe(async t=>{t&&(await this.resumePausedMutations(),N(this,et).onFocus())})),J(this,ca,In.subscribe(async t=>{t&&(await this.resumePausedMutations(),N(this,et).onOnline())})))}unmount(){var t,e;bn(this,sr)._--,N(this,sr)===0&&((t=N(this,la))==null||t.call(this),J(this,la,void 0),(e=N(this,ca))==null||e.call(this),J(this,ca,void 0))}isFetching(t){return N(this,et).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return N(this,er).findAll({...t,status:"pending"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=N(this,et).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const r=this.defaultQueryOptions(t),a=N(this,et).build(this,r);return t.revalidateIfStale&&a.isStaleByTime(Zr(r.staleTime,a))&&this.prefetchQuery(r),Promise.resolve(e)}}getQueriesData(t){return N(this,et).findAll(t).map(({queryKey:e,state:r})=>{const a=r.data;return[e,a]})}setQueryData(t,e,r){const a=this.defaultQueryOptions({queryKey:t}),n=N(this,et).get(a.queryHash),i=n==null?void 0:n.state.data,o=f0(e,i);if(o!==void 0)return N(this,et).build(this,a).setData(o,{...r,manual:!0})}setQueriesData(t,e,r){return mt.batch(()=>N(this,et).findAll(t).map(({queryKey:a})=>[a,this.setQueryData(a,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=N(this,et).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=N(this,et);mt.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=N(this,et),a={type:"active",...t};return mt.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries(a,e)))}cancelQueries(t={},e={}){const r={revert:!0,...e},a=mt.batch(()=>N(this,et).findAll(t).map(n=>n.cancel(r)));return Promise.all(a).then(as).catch(as)}invalidateQueries(t={},e={}){return mt.batch(()=>{if(N(this,et).findAll(t).forEach(a=>{a.invalidate()}),t.refetchType==="none")return Promise.resolve();const r={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(r,e)})}refetchQueries(t={},e){const r={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},a=mt.batch(()=>N(this,et).findAll(t).filter(n=>!n.isDisabled()).map(n=>{let i=n.fetch(void 0,r);return r.throwOnError||(i=i.catch(as)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(a).then(as)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=N(this,et).build(this,e);return r.isStaleByTime(Zr(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(as).catch(as)}fetchInfiniteQuery(t){return t.behavior=Cl(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(as).catch(as)}ensureInfiniteQueryData(t){return t.behavior=Cl(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return In.isOnline()?N(this,er).resumePausedMutations():Promise.resolve()}getQueryCache(){return N(this,et)}getMutationCache(){return N(this,er)}getDefaultOptions(){return N(this,tr)}setDefaultOptions(t){J(this,tr,t)}setQueryDefaults(t,e){N(this,ia).set(Or(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...N(this,ia).values()];let r={};return e.forEach(a=>{Ua(t,a.queryKey)&&(r={...r,...a.defaultOptions})}),r}setMutationDefaults(t,e){N(this,oa).set(Or(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...N(this,oa).values()];let r={};return e.forEach(a=>{Ua(t,a.mutationKey)&&(r={...r,...a.defaultOptions})}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...N(this,tr).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Io(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===Ro&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...N(this,tr).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){N(this,et).clear(),N(this,er).clear()}},et=new WeakMap,er=new WeakMap,tr=new WeakMap,ia=new WeakMap,oa=new WeakMap,sr=new WeakMap,la=new WeakMap,ca=new WeakMap,Cc),qt,Ie,un,It,Ar,da,rr,Ns,hn,ua,ha,Er,Ir,ar,ma,Ue,Ra,Qi,Hi,Zi,Wi,Gi,Xi,Ji,ef,_c,P0=(_c=class extends Na{constructor(e,r){super();de(this,Ue);de(this,qt);de(this,Ie);de(this,un);de(this,It);de(this,Ar);de(this,da);de(this,rr);de(this,Ns);de(this,hn);de(this,ua);de(this,ha);de(this,Er);de(this,Ir);de(this,ar);de(this,ma,new Set);this.options=r,J(this,qt,e),J(this,Ns,null),J(this,rr,Ki()),this.options.experimental_prefetchInRender||N(this,rr).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(N(this,Ie).addObserver(this),Tl(N(this,Ie),this.options)?Ne(this,Ue,Ra).call(this):this.updateResult(),Ne(this,Ue,Wi).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Yi(N(this,Ie),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Yi(N(this,Ie),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ne(this,Ue,Gi).call(this),Ne(this,Ue,Xi).call(this),N(this,Ie).removeObserver(this)}setOptions(e,r){const a=this.options,n=N(this,Ie);if(this.options=N(this,qt).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ds(this.options.enabled,N(this,Ie))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ne(this,Ue,Ji).call(this),N(this,Ie).setOptions(this.options),a._defaulted&&!En(this.options,a)&&N(this,qt).getQueryCache().notify({type:"observerOptionsUpdated",query:N(this,Ie),observer:this});const i=this.hasListeners();i&&Pl(N(this,Ie),n,this.options,a)&&Ne(this,Ue,Ra).call(this),this.updateResult(r),i&&(N(this,Ie)!==n||ds(this.options.enabled,N(this,Ie))!==ds(a.enabled,N(this,Ie))||Zr(this.options.staleTime,N(this,Ie))!==Zr(a.staleTime,N(this,Ie)))&&Ne(this,Ue,Qi).call(this);const o=Ne(this,Ue,Hi).call(this);i&&(N(this,Ie)!==n||ds(this.options.enabled,N(this,Ie))!==ds(a.enabled,N(this,Ie))||o!==N(this,ar))&&Ne(this,Ue,Zi).call(this,o)}getOptimisticResult(e){const r=N(this,qt).getQueryCache().build(N(this,qt),e),a=this.createResult(r,e);return E0(this,a)&&(J(this,It,a),J(this,da,this.options),J(this,Ar,N(this,Ie).state)),a}getCurrentResult(){return N(this,It)}trackResult(e,r){const a={};return Object.keys(e).forEach(n=>{Object.defineProperty(a,n,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(n),r==null||r(n),e[n])})}),a}trackProp(e){N(this,ma).add(e)}getCurrentQuery(){return N(this,Ie)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const r=N(this,qt).defaultQueryOptions(e),a=N(this,qt).getQueryCache().build(N(this,qt),r);return a.fetch().then(()=>this.createResult(a,r))}fetch(e){return Ne(this,Ue,Ra).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),N(this,It)))}createResult(e,r){var H;const a=N(this,Ie),n=this.options,i=N(this,It),o=N(this,Ar),l=N(this,da),h=e!==a?e.state:N(this,un),{state:u}=e;let p={...u},f=!1,g;if(r._optimisticResults){const M=this.hasListeners(),L=!M&&Tl(e,r),$=M&&Pl(e,a,r,n);(L||$)&&(p={...p,...Jm(u.data,e.options)}),r._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:j,errorUpdatedAt:x,status:m}=p;if(r.select&&p.data!==void 0)if(i&&p.data===(o==null?void 0:o.data)&&r.select===N(this,hn))g=N(this,ua);else try{J(this,hn,r.select),g=r.select(p.data),g=Bi(i==null?void 0:i.data,g,r),J(this,ua,g),J(this,Ns,null)}catch(M){J(this,Ns,M)}else g=p.data;if(r.placeholderData!==void 0&&g===void 0&&m==="pending"){let M;if(i!=null&&i.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData))M=i.data;else if(M=typeof r.placeholderData=="function"?r.placeholderData((H=N(this,ha))==null?void 0:H.state.data,N(this,ha)):r.placeholderData,r.select&&M!==void 0)try{M=r.select(M),J(this,Ns,null)}catch(L){J(this,Ns,L)}M!==void 0&&(m="success",g=Bi(i==null?void 0:i.data,M,r),f=!0)}N(this,Ns)&&(j=N(this,Ns),g=N(this,ua),x=Date.now(),m="error");const S=p.fetchStatus==="fetching",v=m==="pending",y=m==="error",C=v&&S,k=g!==void 0,Q={status:m,fetchStatus:p.fetchStatus,isPending:v,isSuccess:m==="success",isError:y,isInitialLoading:C,isLoading:C,data:g,dataUpdatedAt:p.dataUpdatedAt,error:j,errorUpdatedAt:x,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>h.dataUpdateCount||p.errorUpdateCount>h.errorUpdateCount,isFetching:S,isRefetching:S&&!v,isLoadingError:y&&!k,isPaused:p.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:y&&k,isStale:Oo(e,r),refetch:this.refetch,promise:N(this,rr)};if(this.options.experimental_prefetchInRender){const M=w=>{Q.status==="error"?w.reject(Q.error):Q.data!==void 0&&w.resolve(Q.data)},L=()=>{const w=J(this,rr,Q.promise=Ki());M(w)},$=N(this,rr);switch($.status){case"pending":e.queryHash===a.queryHash&&M($);break;case"fulfilled":(Q.status==="error"||Q.data!==$.value)&&L();break;case"rejected":(Q.status!=="error"||Q.error!==$.reason)&&L();break}}return Q}updateResult(e){const r=N(this,It),a=this.createResult(N(this,Ie),this.options);if(J(this,Ar,N(this,Ie).state),J(this,da,this.options),N(this,Ar).data!==void 0&&J(this,ha,N(this,Ie)),En(a,r))return;J(this,It,a);const n={},i=()=>{if(!r)return!0;const{notifyOnChangeProps:o}=this.options,l=typeof o=="function"?o():o;if(l==="all"||!l&&!N(this,ma).size)return!0;const c=new Set(l??N(this,ma));return this.options.throwOnError&&c.add("error"),Object.keys(N(this,It)).some(h=>{const u=h;return N(this,It)[u]!==r[u]&&c.has(u)})};(e==null?void 0:e.listeners)!==!1&&i()&&(n.listeners=!0),Ne(this,Ue,ef).call(this,{...n,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ne(this,Ue,Wi).call(this)}},qt=new WeakMap,Ie=new WeakMap,un=new WeakMap,It=new WeakMap,Ar=new WeakMap,da=new WeakMap,rr=new WeakMap,Ns=new WeakMap,hn=new WeakMap,ua=new WeakMap,ha=new WeakMap,Er=new WeakMap,Ir=new WeakMap,ar=new WeakMap,ma=new WeakMap,Ue=new WeakSet,Ra=function(e){Ne(this,Ue,Ji).call(this);let r=N(this,Ie).fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(as)),r},Qi=function(){Ne(this,Ue,Gi).call(this);const e=Zr(this.options.staleTime,N(this,Ie));if(Mr||N(this,It).isStale||!qi(e))return;const a=Km(N(this,It).dataUpdatedAt,e)+1;J(this,Er,setTimeout(()=>{N(this,It).isStale||this.updateResult()},a))},Hi=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(N(this,Ie)):this.options.refetchInterval)??!1},Zi=function(e){Ne(this,Ue,Xi).call(this),J(this,ar,e),!(Mr||ds(this.options.enabled,N(this,Ie))===!1||!qi(N(this,ar))||N(this,ar)===0)&&J(this,Ir,setInterval(()=>{(this.options.refetchIntervalInBackground||Mo.isFocused())&&Ne(this,Ue,Ra).call(this)},N(this,ar)))},Wi=function(){Ne(this,Ue,Qi).call(this),Ne(this,Ue,Zi).call(this,Ne(this,Ue,Hi).call(this))},Gi=function(){N(this,Er)&&(clearTimeout(N(this,Er)),J(this,Er,void 0))},Xi=function(){N(this,Ir)&&(clearInterval(N(this,Ir)),J(this,Ir,void 0))},Ji=function(){const e=N(this,qt).getQueryCache().build(N(this,qt),this.options);if(e===N(this,Ie))return;const r=N(this,Ie);J(this,Ie,e),J(this,un,e.state),this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))},ef=function(e){mt.batch(()=>{e.listeners&&this.listeners.forEach(r=>{r(N(this,It))}),N(this,qt).getQueryCache().notify({query:N(this,Ie),type:"observerResultsUpdated"})})},_c);function A0(t,e){return ds(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Tl(t,e){return A0(t,e)||t.state.data!==void 0&&Yi(t,e,e.refetchOnMount)}function Yi(t,e,r){if(ds(e.enabled,t)!==!1){const a=typeof r=="function"?r(t):r;return a==="always"||a!==!1&&Oo(t,e)}return!1}function Pl(t,e,r,a){return(t!==e||ds(a.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&Oo(t,r)}function Oo(t,e){return ds(e.enabled,t)!==!1&&t.isStaleByTime(Zr(e.staleTime,t))}function E0(t,e){return!En(t.getCurrentResult(),e)}var nr,ir,Ut,zs,Us,Sn,eo,Tc,I0=(Tc=class extends Na{constructor(r,a){super();de(this,Us);de(this,nr);de(this,ir);de(this,Ut);de(this,zs);J(this,nr,r),this.setOptions(a),this.bindMethods(),Ne(this,Us,Sn).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var n;const a=this.options;this.options=N(this,nr).defaultMutationOptions(r),En(this.options,a)||N(this,nr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:N(this,Ut),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&Or(a.mutationKey)!==Or(this.options.mutationKey)?this.reset():((n=N(this,Ut))==null?void 0:n.state.status)==="pending"&&N(this,Ut).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=N(this,Ut))==null||r.removeObserver(this)}onMutationUpdate(r){Ne(this,Us,Sn).call(this),Ne(this,Us,eo).call(this,r)}getCurrentResult(){return N(this,ir)}reset(){var r;(r=N(this,Ut))==null||r.removeObserver(this),J(this,Ut,void 0),Ne(this,Us,Sn).call(this),Ne(this,Us,eo).call(this)}mutate(r,a){var n;return J(this,zs,a),(n=N(this,Ut))==null||n.removeObserver(this),J(this,Ut,N(this,nr).getMutationCache().build(N(this,nr),this.options)),N(this,Ut).addObserver(this),N(this,Ut).execute(r)}},nr=new WeakMap,ir=new WeakMap,Ut=new WeakMap,zs=new WeakMap,Us=new WeakSet,Sn=function(){var a;const r=((a=N(this,Ut))==null?void 0:a.state)??Ym();J(this,ir,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},eo=function(r){mt.batch(()=>{var a,n,i,o,l,c,h,u;if(N(this,zs)&&this.hasListeners()){const p=N(this,ir).variables,f=N(this,ir).context;(r==null?void 0:r.type)==="success"?((n=(a=N(this,zs)).onSuccess)==null||n.call(a,r.data,p,f),(o=(i=N(this,zs)).onSettled)==null||o.call(i,r.data,null,p,f)):(r==null?void 0:r.type)==="error"&&((c=(l=N(this,zs)).onError)==null||c.call(l,r.error,p,f),(u=(h=N(this,zs)).onSettled)==null||u.call(h,void 0,r.error,p,f))}this.listeners.forEach(p=>{p(N(this,ir))})})},Tc),tf=d.createContext(void 0),vs=t=>{const e=d.useContext(tf);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},R0=({client:t,children:e})=>(d.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),s.jsx(tf.Provider,{value:t,children:e})),sf=d.createContext(!1),M0=()=>d.useContext(sf);sf.Provider;function O0(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var D0=d.createContext(O0()),F0=()=>d.useContext(D0);function rf(t,e){return typeof t=="function"?t(...e):!!t}function to(){}var L0=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},V0=t=>{d.useEffect(()=>{t.clearReset()},[t])},z0=({result:t,errorResetBoundary:e,throwOnError:r,query:a})=>t.isError&&!e.isReset()&&!t.isFetching&&a&&rf(r,[t.error,a]),$0=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},q0=(t,e)=>t.isLoading&&t.isFetching&&!e,U0=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Al=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function B0(t,e,r){var u,p,f,g,j;const a=vs(),n=M0(),i=F0(),o=a.defaultQueryOptions(t);(p=(u=a.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||p.call(u,o),o._optimisticResults=n?"isRestoring":"optimistic",$0(o),L0(o,i),V0(i);const l=!a.getQueryCache().get(o.queryHash),[c]=d.useState(()=>new e(a,o)),h=c.getOptimisticResult(o);if(d.useSyncExternalStore(d.useCallback(x=>{const m=n?to:c.subscribe(mt.batchCalls(x));return c.updateResult(),m},[c,n]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),d.useEffect(()=>{c.setOptions(o,{listeners:!1})},[o,c]),U0(o,h))throw Al(o,c,i);if(z0({result:h,errorResetBoundary:i,throwOnError:o.throwOnError,query:a.getQueryCache().get(o.queryHash)}))throw h.error;if((g=(f=a.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||g.call(f,o,h),o.experimental_prefetchInRender&&!Mr&&q0(h,n)){const x=l?Al(o,c,i):(j=a.getQueryCache().get(o.queryHash))==null?void 0:j.promise;x==null||x.catch(to).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?h:c.trackResult(h)}function ye(t,e){return B0(t,P0)}function Se(t,e){const r=vs(),[a]=d.useState(()=>new I0(r,t));d.useEffect(()=>{a.setOptions(t)},[a,t]);const n=d.useSyncExternalStore(d.useCallback(o=>a.subscribe(mt.batchCalls(o)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),i=d.useCallback((o,l)=>{a.mutate(o,l).catch(to)},[a]);if(n.error&&rf(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}async function K0(t){if(!t.ok){const e=await t.text()||t.statusText;throw new Error(`${t.status}: ${e}`)}}async function ce(t,e={}){const r=localStorage.getItem("auth_token"),a=await fetch(t,{...e,headers:{...e.headers,...r&&{Authorization:`Bearer ${r}`}}});if(!a.ok){const n=await a.text();let i=`${a.status}: ${a.statusText}`;try{i=JSON.parse(n).message||i}catch{}throw new Error(i)}return a.json()}const Q0=({on401:t})=>async({queryKey:e})=>{const r=localStorage.getItem("auth_token"),a=await fetch(e.join("/"),{headers:{...r&&{Authorization:`Bearer ${r}`}}});return t==="returnNull"&&a.status===401?null:(await K0(a),await a.json())},ft=new T0({defaultOptions:{queries:{queryFn:Q0({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),H0=1,Z0=1e6;let Ii=0;function W0(){return Ii=(Ii+1)%Number.MAX_SAFE_INTEGER,Ii.toString()}const Ri=new Map,El=t=>{if(Ri.has(t))return;const e=setTimeout(()=>{Ri.delete(t),Fa({type:"REMOVE_TOAST",toastId:t})},Z0);Ri.set(t,e)},G0=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,H0)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===e.toast.id?{...r,...e.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=e;return r?El(r):t.toasts.forEach(a=>{El(a.id)}),{...t,toasts:t.toasts.map(a=>a.id===r||r===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==e.toastId)}}},kn=[];let Cn={toasts:[]};function Fa(t){Cn=G0(Cn,t),kn.forEach(e=>{e(Cn)})}function X0({...t}){const e=W0(),r=n=>Fa({type:"UPDATE_TOAST",toast:{...n,id:e}}),a=()=>Fa({type:"DISMISS_TOAST",toastId:e});return Fa({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:n=>{n||a()}}}),{id:e,dismiss:a,update:r}}function lt(){const[t,e]=d.useState(Cn);return d.useEffect(()=>(kn.push(e),()=>{const r=kn.indexOf(e);r>-1&&kn.splice(r,1)}),[t]),{...t,toast:X0,dismiss:r=>Fa({type:"DISMISS_TOAST",toastId:r})}}var J0="VisuallyHidden",mn=d.forwardRef((t,e)=>s.jsx(Ae.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));mn.displayName=J0;var Y0=mn,Do="ToastProvider",[Fo,eb,tb]=um("Toast"),[af,gk]=$r("Toast",[tb]),[sb,di]=af(Do),nf=t=>{const{__scopeToast:e,label:r="Notification",duration:a=5e3,swipeDirection:n="right",swipeThreshold:i=50,children:o}=t,[l,c]=d.useState(null),[h,u]=d.useState(0),p=d.useRef(!1),f=d.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${Do}\`. Expected non-empty \`string\`.`),s.jsx(Fo.Provider,{scope:e,children:s.jsx(sb,{scope:e,label:r,duration:a,swipeDirection:n,swipeThreshold:i,toastCount:h,viewport:l,onViewportChange:c,onToastAdd:d.useCallback(()=>u(g=>g+1),[]),onToastRemove:d.useCallback(()=>u(g=>g-1),[]),isFocusedToastEscapeKeyDownRef:p,isClosePausedRef:f,children:o})})};nf.displayName=Do;var of="ToastViewport",rb=["F8"],so="toast.viewportPause",ro="toast.viewportResume",lf=d.forwardRef((t,e)=>{const{__scopeToast:r,hotkey:a=rb,label:n="Notifications ({hotkey})",...i}=t,o=di(of,r),l=eb(r),c=d.useRef(null),h=d.useRef(null),u=d.useRef(null),p=d.useRef(null),f=ot(e,p,o.onViewportChange),g=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),j=o.toastCount>0;d.useEffect(()=>{const m=S=>{var y;a.length!==0&&a.every(C=>S[C]||S.code===C)&&((y=p.current)==null||y.focus())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[a]),d.useEffect(()=>{const m=c.current,S=p.current;if(j&&m&&S){const v=()=>{if(!o.isClosePausedRef.current){const D=new CustomEvent(so);S.dispatchEvent(D),o.isClosePausedRef.current=!0}},y=()=>{if(o.isClosePausedRef.current){const D=new CustomEvent(ro);S.dispatchEvent(D),o.isClosePausedRef.current=!1}},C=D=>{!m.contains(D.relatedTarget)&&y()},k=()=>{m.contains(document.activeElement)||y()};return m.addEventListener("focusin",v),m.addEventListener("focusout",C),m.addEventListener("pointermove",v),m.addEventListener("pointerleave",k),window.addEventListener("blur",v),window.addEventListener("focus",y),()=>{m.removeEventListener("focusin",v),m.removeEventListener("focusout",C),m.removeEventListener("pointermove",v),m.removeEventListener("pointerleave",k),window.removeEventListener("blur",v),window.removeEventListener("focus",y)}}},[j,o.isClosePausedRef]);const x=d.useCallback(({tabbingDirection:m})=>{const v=l().map(y=>{const C=y.ref.current,k=[C,...gb(C)];return m==="forwards"?k:k.reverse()});return(m==="forwards"?v.reverse():v).flat()},[l]);return d.useEffect(()=>{const m=p.current;if(m){const S=v=>{var k,D,Q;const y=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!y){const H=document.activeElement,M=v.shiftKey;if(v.target===m&&M){(k=h.current)==null||k.focus();return}const w=x({tabbingDirection:M?"backwards":"forwards"}),A=w.findIndex(I=>I===H);Mi(w.slice(A+1))?v.preventDefault():M?(D=h.current)==null||D.focus():(Q=u.current)==null||Q.focus()}};return m.addEventListener("keydown",S),()=>m.removeEventListener("keydown",S)}},[l,x]),s.jsxs(yv,{ref:c,role:"region","aria-label":n.replace("{hotkey}",g),tabIndex:-1,style:{pointerEvents:j?void 0:"none"},children:[j&&s.jsx(ao,{ref:h,onFocusFromOutsideViewport:()=>{const m=x({tabbingDirection:"forwards"});Mi(m)}}),s.jsx(Fo.Slot,{scope:r,children:s.jsx(Ae.ol,{tabIndex:-1,...i,ref:f})}),j&&s.jsx(ao,{ref:u,onFocusFromOutsideViewport:()=>{const m=x({tabbingDirection:"backwards"});Mi(m)}})]})});lf.displayName=of;var cf="ToastFocusProxy",ao=d.forwardRef((t,e)=>{const{__scopeToast:r,onFocusFromOutsideViewport:a,...n}=t,i=di(cf,r);return s.jsx(mn,{"aria-hidden":!0,tabIndex:0,...n,ref:e,style:{position:"fixed"},onFocus:o=>{var h;const l=o.relatedTarget;!((h=i.viewport)!=null&&h.contains(l))&&a()}})});ao.displayName=cf;var ui="Toast",ab="toast.swipeStart",nb="toast.swipeMove",ib="toast.swipeCancel",ob="toast.swipeEnd",df=d.forwardRef((t,e)=>{const{forceMount:r,open:a,defaultOpen:n,onOpenChange:i,...o}=t,[l=!0,c]=qa({prop:a,defaultProp:n,onChange:i});return s.jsx(qr,{present:r||l,children:s.jsx(db,{open:l,...o,ref:e,onClose:()=>c(!1),onPause:Jt(t.onPause),onResume:Jt(t.onResume),onSwipeStart:xe(t.onSwipeStart,h=>{h.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:xe(t.onSwipeMove,h=>{const{x:u,y:p}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","move"),h.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${p}px`)}),onSwipeCancel:xe(t.onSwipeCancel,h=>{h.currentTarget.setAttribute("data-swipe","cancel"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:xe(t.onSwipeEnd,h=>{const{x:u,y:p}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","end"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${p}px`),c(!1)})})})});df.displayName=ui;var[lb,cb]=af(ui,{onClose(){}}),db=d.forwardRef((t,e)=>{const{__scopeToast:r,type:a="foreground",duration:n,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:h,onSwipeStart:u,onSwipeMove:p,onSwipeCancel:f,onSwipeEnd:g,...j}=t,x=di(ui,r),[m,S]=d.useState(null),v=ot(e,I=>S(I)),y=d.useRef(null),C=d.useRef(null),k=n||x.duration,D=d.useRef(0),Q=d.useRef(k),H=d.useRef(0),{onToastAdd:M,onToastRemove:L}=x,$=Jt(()=>{var K;(m==null?void 0:m.contains(document.activeElement))&&((K=x.viewport)==null||K.focus()),o()}),w=d.useCallback(I=>{!I||I===1/0||(window.clearTimeout(H.current),D.current=new Date().getTime(),H.current=window.setTimeout($,I))},[$]);d.useEffect(()=>{const I=x.viewport;if(I){const K=()=>{w(Q.current),h==null||h()},E=()=>{const U=new Date().getTime()-D.current;Q.current=Q.current-U,window.clearTimeout(H.current),c==null||c()};return I.addEventListener(so,E),I.addEventListener(ro,K),()=>{I.removeEventListener(so,E),I.removeEventListener(ro,K)}}},[x.viewport,k,c,h,w]),d.useEffect(()=>{i&&!x.isClosePausedRef.current&&w(k)},[i,k,x.isClosePausedRef,w]),d.useEffect(()=>(M(),()=>L()),[M,L]);const A=d.useMemo(()=>m?xf(m):null,[m]);return x.viewport?s.jsxs(s.Fragment,{children:[A&&s.jsx(ub,{__scopeToast:r,role:"status","aria-live":a==="foreground"?"assertive":"polite","aria-atomic":!0,children:A}),s.jsx(lb,{scope:r,onClose:$,children:li.createPortal(s.jsx(Fo.ItemSlot,{scope:r,children:s.jsx(vv,{asChild:!0,onEscapeKeyDown:xe(l,()=>{x.isFocusedToastEscapeKeyDownRef.current||$(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(Ae.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...j,ref:v,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:xe(t.onKeyDown,I=>{I.key==="Escape"&&(l==null||l(I.nativeEvent),I.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,$()))}),onPointerDown:xe(t.onPointerDown,I=>{I.button===0&&(y.current={x:I.clientX,y:I.clientY})}),onPointerMove:xe(t.onPointerMove,I=>{if(!y.current)return;const K=I.clientX-y.current.x,E=I.clientY-y.current.y,U=!!C.current,te=["left","right"].includes(x.swipeDirection),q=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,ge=te?q(0,K):0,Me=te?0:q(0,E),Ke=I.pointerType==="touch"?10:2,Qe={x:ge,y:Me},ut={originalEvent:I,delta:Qe};U?(C.current=Qe,jn(nb,p,ut,{discrete:!1})):Il(Qe,x.swipeDirection,Ke)?(C.current=Qe,jn(ab,u,ut,{discrete:!1}),I.target.setPointerCapture(I.pointerId)):(Math.abs(K)>Ke||Math.abs(E)>Ke)&&(y.current=null)}),onPointerUp:xe(t.onPointerUp,I=>{const K=C.current,E=I.target;if(E.hasPointerCapture(I.pointerId)&&E.releasePointerCapture(I.pointerId),C.current=null,y.current=null,K){const U=I.currentTarget,te={originalEvent:I,delta:K};Il(K,x.swipeDirection,x.swipeThreshold)?jn(ob,g,te,{discrete:!0}):jn(ib,f,te,{discrete:!0}),U.addEventListener("click",q=>q.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),ub=t=>{const{__scopeToast:e,children:r,...a}=t,n=di(ui,e),[i,o]=d.useState(!1),[l,c]=d.useState(!1);return fb(()=>o(!0)),d.useEffect(()=>{const h=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(h)},[]),l?null:s.jsx(hm,{asChild:!0,children:s.jsx(mn,{...a,children:i&&s.jsxs(s.Fragment,{children:[n.label," ",r]})})})},hb="ToastTitle",uf=d.forwardRef((t,e)=>{const{__scopeToast:r,...a}=t;return s.jsx(Ae.div,{...a,ref:e})});uf.displayName=hb;var mb="ToastDescription",hf=d.forwardRef((t,e)=>{const{__scopeToast:r,...a}=t;return s.jsx(Ae.div,{...a,ref:e})});hf.displayName=mb;var mf="ToastAction",ff=d.forwardRef((t,e)=>{const{altText:r,...a}=t;return r.trim()?s.jsx(gf,{altText:r,asChild:!0,children:s.jsx(Lo,{...a,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${mf}\`. Expected non-empty \`string\`.`),null)});ff.displayName=mf;var pf="ToastClose",Lo=d.forwardRef((t,e)=>{const{__scopeToast:r,...a}=t,n=cb(pf,r);return s.jsx(gf,{asChild:!0,children:s.jsx(Ae.button,{type:"button",...a,ref:e,onClick:xe(t.onClick,n.onClose)})})});Lo.displayName=pf;var gf=d.forwardRef((t,e)=>{const{__scopeToast:r,altText:a,...n}=t;return s.jsx(Ae.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":a||void 0,...n,ref:e})});function xf(t){const e=[];return Array.from(t.childNodes).forEach(a=>{if(a.nodeType===a.TEXT_NODE&&a.textContent&&e.push(a.textContent),pb(a)){const n=a.ariaHidden||a.hidden||a.style.display==="none",i=a.dataset.radixToastAnnounceExclude==="";if(!n)if(i){const o=a.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...xf(a))}}),e}function jn(t,e,r,{discrete:a}){const n=r.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});e&&n.addEventListener(t,e,{once:!0}),a?bv(n,i):n.dispatchEvent(i)}var Il=(t,e,r=0)=>{const a=Math.abs(t.x),n=Math.abs(t.y),i=a>n;return e==="left"||e==="right"?i&&a>r:!i&&n>r};function fb(t=()=>{}){const e=Jt(t);ts(()=>{let r=0,a=0;return r=window.requestAnimationFrame(()=>a=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(a)}},[e])}function pb(t){return t.nodeType===t.ELEMENT_NODE}function gb(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const n=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||n?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function Mi(t){const e=document.activeElement;return t.some(r=>r===e?!0:(r.focus(),document.activeElement!==e))}var xb=nf,yf=lf,vf=df,bf=uf,wf=hf,jf=ff,Nf=Lo;function Sf(t){var e,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=Sf(t[e]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function kf(){for(var t,e,r=0,a="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=Sf(t))&&(a&&(a+=" "),a+=e);return a}const Rl=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Ml=kf,hi=(t,e)=>r=>{var a;if((e==null?void 0:e.variants)==null)return Ml(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:n,defaultVariants:i}=e,o=Object.keys(n).map(h=>{const u=r==null?void 0:r[h],p=i==null?void 0:i[h];if(u===null)return null;const f=Rl(u)||Rl(p);return n[h][f]}),l=r&&Object.entries(r).reduce((h,u)=>{let[p,f]=u;return f===void 0||(h[p]=f),h},{}),c=e==null||(a=e.compoundVariants)===null||a===void 0?void 0:a.reduce((h,u)=>{let{class:p,className:f,...g}=u;return Object.entries(g).every(j=>{let[x,m]=j;return Array.isArray(m)?m.includes({...i,...l}[x]):{...i,...l}[x]===m})?[...h,p,f]:h},[]);return Ml(t,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Cf=(...t)=>t.filter((e,r,a)=>!!e&&a.indexOf(e)===r).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var vb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=d.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:i,iconNode:o,...l},c)=>d.createElement("svg",{ref:c,...vb,width:e,height:e,stroke:t,strokeWidth:a?Number(r)*24/Number(e):r,className:Cf("lucide",n),...l},[...o.map(([h,u])=>d.createElement(h,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=(t,e)=>{const r=d.forwardRef(({className:a,...n},i)=>d.createElement(bb,{ref:i,iconNode:e,className:Cf(`lucide-${yb(t)}`,a),...n}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=X("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=X("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=X("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=X("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=X("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=X("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=X("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=X("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=X("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=X("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=X("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=X("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=X("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=X("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=X("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=X("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=X("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=X("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _b=X("Dot",[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=X("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=X("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=X("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=X("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=X("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=X("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=X("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=X("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=X("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=X("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=X("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=X("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=X("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ab=X("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=X("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=X("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eb=X("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ib=X("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=X("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mb=X("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=X("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=X("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=X("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=X("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=X("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=X("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=X("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=X("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=X("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=X("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=X("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=X("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=X("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=X("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rf=X("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=X("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=X("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=X("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=X("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=X("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=X("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=X("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=X("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vb=X("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=X("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=X("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mf=X("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=X("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Of=X("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=X("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=X("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=X("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qb=X("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ub=X("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=X("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=X("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ko="-",Kb=t=>{const e=Hb(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:a}=t;return{getClassGroupId:o=>{const l=o.split(Ko);return l[0]===""&&l.length!==1&&l.shift(),Df(l,e)||Qb(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&a[o]?[...c,...a[o]]:c}}},Df=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],a=e.nextPart.get(r),n=a?Df(t.slice(1),a):void 0;if(n)return n;if(e.validators.length===0)return;const i=t.join(Ko);return(o=e.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},Ll=/^\[(.+)\]$/,Qb=t=>{if(Ll.test(t)){const e=Ll.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},Hb=t=>{const{theme:e,prefix:r}=t,a={nextPart:new Map,validators:[]};return Wb(Object.entries(t.classGroups),r).forEach(([i,o])=>{co(o,a,i,e)}),a},co=(t,e,r,a)=>{t.forEach(n=>{if(typeof n=="string"){const i=n===""?e:Vl(e,n);i.classGroupId=r;return}if(typeof n=="function"){if(Zb(n)){co(n(a),e,r,a);return}e.validators.push({validator:n,classGroupId:r});return}Object.entries(n).forEach(([i,o])=>{co(o,Vl(e,i),r,a)})})},Vl=(t,e)=>{let r=t;return e.split(Ko).forEach(a=>{r.nextPart.has(a)||r.nextPart.set(a,{nextPart:new Map,validators:[]}),r=r.nextPart.get(a)}),r},Zb=t=>t.isThemeGetter,Wb=(t,e)=>e?t.map(([r,a])=>{const n=a.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[e+o,l])):i);return[r,n]}):t,Gb=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,a=new Map;const n=(i,o)=>{r.set(i,o),e++,e>t&&(e=0,a=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=a.get(i))!==void 0)return n(i,o),o},set(i,o){r.has(i)?r.set(i,o):n(i,o)}}},Ff="!",Xb=t=>{const{separator:e,experimentalParseClassName:r}=t,a=e.length===1,n=e[0],i=e.length,o=l=>{const c=[];let h=0,u=0,p;for(let m=0;m<l.length;m++){let S=l[m];if(h===0){if(S===n&&(a||l.slice(m,m+i)===e)){c.push(l.slice(u,m)),u=m+i;continue}if(S==="/"){p=m;continue}}S==="["?h++:S==="]"&&h--}const f=c.length===0?l:l.substring(u),g=f.startsWith(Ff),j=g?f.substring(1):f,x=p&&p>u?p-u:void 0;return{modifiers:c,hasImportantModifier:g,baseClassName:j,maybePostfixModifierPosition:x}};return r?l=>r({className:l,parseClassName:o}):o},Jb=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(a=>{a[0]==="["?(e.push(...r.sort(),a),r=[]):r.push(a)}),e.push(...r.sort()),e},Yb=t=>({cache:Gb(t.cacheSize),parseClassName:Xb(t),...Kb(t)}),ew=/\s+/,tw=(t,e)=>{const{parseClassName:r,getClassGroupId:a,getConflictingClassGroupIds:n}=e,i=[],o=t.trim().split(ew);let l="";for(let c=o.length-1;c>=0;c-=1){const h=o[c],{modifiers:u,hasImportantModifier:p,baseClassName:f,maybePostfixModifierPosition:g}=r(h);let j=!!g,x=a(j?f.substring(0,g):f);if(!x){if(!j){l=h+(l.length>0?" "+l:l);continue}if(x=a(f),!x){l=h+(l.length>0?" "+l:l);continue}j=!1}const m=Jb(u).join(":"),S=p?m+Ff:m,v=S+x;if(i.includes(v))continue;i.push(v);const y=n(x,j);for(let C=0;C<y.length;++C){const k=y[C];i.push(S+k)}l=h+(l.length>0?" "+l:l)}return l};function sw(){let t=0,e,r,a="";for(;t<arguments.length;)(e=arguments[t++])&&(r=Lf(e))&&(a&&(a+=" "),a+=r);return a}const Lf=t=>{if(typeof t=="string")return t;let e,r="";for(let a=0;a<t.length;a++)t[a]&&(e=Lf(t[a]))&&(r&&(r+=" "),r+=e);return r};function rw(t,...e){let r,a,n,i=o;function o(c){const h=e.reduce((u,p)=>p(u),t());return r=Yb(h),a=r.cache.get,n=r.cache.set,i=l,l(c)}function l(c){const h=a(c);if(h)return h;const u=tw(c,r);return n(c,u),u}return function(){return i(sw.apply(null,arguments))}}const Ze=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},Vf=/^\[(?:([a-z-]+):)?(.+)\]$/i,aw=/^\d+\/\d+$/,nw=new Set(["px","full","screen"]),iw=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ow=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,lw=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,cw=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,dw=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ms=t=>Wr(t)||nw.has(t)||aw.test(t),Hs=t=>ka(t,"length",yw),Wr=t=>!!t&&!Number.isNaN(Number(t)),Oi=t=>ka(t,"number",Wr),Ta=t=>!!t&&Number.isInteger(Number(t)),uw=t=>t.endsWith("%")&&Wr(t.slice(0,-1)),we=t=>Vf.test(t),Zs=t=>iw.test(t),hw=new Set(["length","size","percentage"]),mw=t=>ka(t,hw,zf),fw=t=>ka(t,"position",zf),pw=new Set(["image","url"]),gw=t=>ka(t,pw,bw),xw=t=>ka(t,"",vw),Pa=()=>!0,ka=(t,e,r)=>{const a=Vf.exec(t);return a?a[1]?typeof e=="string"?a[1]===e:e.has(a[1]):r(a[2]):!1},yw=t=>ow.test(t)&&!lw.test(t),zf=()=>!1,vw=t=>cw.test(t),bw=t=>dw.test(t),ww=()=>{const t=Ze("colors"),e=Ze("spacing"),r=Ze("blur"),a=Ze("brightness"),n=Ze("borderColor"),i=Ze("borderRadius"),o=Ze("borderSpacing"),l=Ze("borderWidth"),c=Ze("contrast"),h=Ze("grayscale"),u=Ze("hueRotate"),p=Ze("invert"),f=Ze("gap"),g=Ze("gradientColorStops"),j=Ze("gradientColorStopPositions"),x=Ze("inset"),m=Ze("margin"),S=Ze("opacity"),v=Ze("padding"),y=Ze("saturate"),C=Ze("scale"),k=Ze("sepia"),D=Ze("skew"),Q=Ze("space"),H=Ze("translate"),M=()=>["auto","contain","none"],L=()=>["auto","hidden","clip","visible","scroll"],$=()=>["auto",we,e],w=()=>[we,e],A=()=>["",Ms,Hs],I=()=>["auto",Wr,we],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],E=()=>["solid","dashed","dotted","double","none"],U=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],te=()=>["start","end","center","between","around","evenly","stretch"],q=()=>["","0",we],ge=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Me=()=>[Wr,we];return{cacheSize:500,separator:":",theme:{colors:[Pa],spacing:[Ms,Hs],blur:["none","",Zs,we],brightness:Me(),borderColor:[t],borderRadius:["none","","full",Zs,we],borderSpacing:w(),borderWidth:A(),contrast:Me(),grayscale:q(),hueRotate:Me(),invert:q(),gap:w(),gradientColorStops:[t],gradientColorStopPositions:[uw,Hs],inset:$(),margin:$(),opacity:Me(),padding:w(),saturate:Me(),scale:Me(),sepia:q(),skew:Me(),space:w(),translate:w()},classGroups:{aspect:[{aspect:["auto","square","video",we]}],container:["container"],columns:[{columns:[Zs]}],"break-after":[{"break-after":ge()}],"break-before":[{"break-before":ge()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),we]}],overflow:[{overflow:L()}],"overflow-x":[{"overflow-x":L()}],"overflow-y":[{"overflow-y":L()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ta,we]}],basis:[{basis:$()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",we]}],grow:[{grow:q()}],shrink:[{shrink:q()}],order:[{order:["first","last","none",Ta,we]}],"grid-cols":[{"grid-cols":[Pa]}],"col-start-end":[{col:["auto",{span:["full",Ta,we]},we]}],"col-start":[{"col-start":I()}],"col-end":[{"col-end":I()}],"grid-rows":[{"grid-rows":[Pa]}],"row-start-end":[{row:["auto",{span:[Ta,we]},we]}],"row-start":[{"row-start":I()}],"row-end":[{"row-end":I()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",we]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",we]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...te()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...te(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...te(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[Q]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Q]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",we,e]}],"min-w":[{"min-w":[we,e,"min","max","fit"]}],"max-w":[{"max-w":[we,e,"none","full","min","max","fit","prose",{screen:[Zs]},Zs]}],h:[{h:[we,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[we,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[we,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[we,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Zs,Hs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Oi]}],"font-family":[{font:[Pa]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",we]}],"line-clamp":[{"line-clamp":["none",Wr,Oi]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ms,we]}],"list-image":[{"list-image":["none",we]}],"list-style-type":[{list:["none","disc","decimal",we]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...E(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ms,Hs]}],"underline-offset":[{"underline-offset":["auto",Ms,we]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:w()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",we]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",we]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),fw]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",mw]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},gw]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[j]}],"gradient-via-pos":[{via:[j]}],"gradient-to-pos":[{to:[j]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[...E(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:E()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...E()]}],"outline-offset":[{"outline-offset":[Ms,we]}],"outline-w":[{outline:[Ms,Hs]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:A()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[Ms,Hs]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Zs,xw]}],"shadow-color":[{shadow:[Pa]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":[...U(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":U()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[a]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Zs,we]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[p]}],saturate:[{saturate:[y]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",we]}],duration:[{duration:Me()}],ease:[{ease:["linear","in","out","in-out",we]}],delay:[{delay:Me()}],animate:[{animate:["none","spin","ping","pulse","bounce",we]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[Ta,we]}],"translate-x":[{"translate-x":[H]}],"translate-y":[{"translate-y":[H]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",we]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",we]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":w()}],"scroll-mx":[{"scroll-mx":w()}],"scroll-my":[{"scroll-my":w()}],"scroll-ms":[{"scroll-ms":w()}],"scroll-me":[{"scroll-me":w()}],"scroll-mt":[{"scroll-mt":w()}],"scroll-mr":[{"scroll-mr":w()}],"scroll-mb":[{"scroll-mb":w()}],"scroll-ml":[{"scroll-ml":w()}],"scroll-p":[{"scroll-p":w()}],"scroll-px":[{"scroll-px":w()}],"scroll-py":[{"scroll-py":w()}],"scroll-ps":[{"scroll-ps":w()}],"scroll-pe":[{"scroll-pe":w()}],"scroll-pt":[{"scroll-pt":w()}],"scroll-pr":[{"scroll-pr":w()}],"scroll-pb":[{"scroll-pb":w()}],"scroll-pl":[{"scroll-pl":w()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",we]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ms,Hs,Oi]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},jw=rw(ww);function se(...t){return jw(kf(t))}const Nw=xb,$f=d.forwardRef(({className:t,...e},r)=>s.jsx(yf,{ref:r,className:se("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));$f.displayName=yf.displayName;const Sw=hi("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),qf=d.forwardRef(({className:t,variant:e,...r},a)=>s.jsx(vf,{ref:a,className:se(Sw({variant:e}),t),...r}));qf.displayName=vf.displayName;const kw=d.forwardRef(({className:t,...e},r)=>s.jsx(jf,{ref:r,className:se("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));kw.displayName=jf.displayName;const Uf=d.forwardRef(({className:t,...e},r)=>s.jsx(Nf,{ref:r,className:se("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:s.jsx(dr,{className:"h-4 w-4"})}));Uf.displayName=Nf.displayName;const Bf=d.forwardRef(({className:t,...e},r)=>s.jsx(bf,{ref:r,className:se("text-sm font-semibold",t),...e}));Bf.displayName=bf.displayName;const Kf=d.forwardRef(({className:t,...e},r)=>s.jsx(wf,{ref:r,className:se("text-sm opacity-90",t),...e}));Kf.displayName=wf.displayName;function Cw(){const{toasts:t}=lt();return s.jsxs(Nw,{children:[t.map(function({id:e,title:r,description:a,action:n,...i}){return s.jsxs(qf,{...i,children:[s.jsxs("div",{className:"grid gap-1",children:[r&&s.jsx(Bf,{children:r}),a&&s.jsx(Kf,{children:a})]}),n,s.jsx(Uf,{})]},e)}),s.jsx($f,{})]})}var[fi,xk]=$r("Tooltip",[ii]),Qo=ii(),Qf="TooltipProvider",_w=700,zl="tooltip.open",[Tw,Hf]=fi(Qf),Zf=t=>{const{__scopeTooltip:e,delayDuration:r=_w,skipDelayDuration:a=300,disableHoverableContent:n=!1,children:i}=t,o=d.useRef(!0),l=d.useRef(!1),c=d.useRef(0);return d.useEffect(()=>{const h=c.current;return()=>window.clearTimeout(h)},[]),s.jsx(Tw,{scope:e,isOpenDelayedRef:o,delayDuration:r,onOpen:d.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:d.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,a)},[a]),isPointerInTransitRef:l,onPointerInTransitChange:d.useCallback(h=>{l.current=h},[]),disableHoverableContent:n,children:i})};Zf.displayName=Qf;var Wf="Tooltip",[yk,pi]=fi(Wf),uo="TooltipTrigger",Pw=d.forwardRef((t,e)=>{const{__scopeTooltip:r,...a}=t,n=pi(uo,r),i=Hf(uo,r),o=Qo(r),l=d.useRef(null),c=ot(e,l,n.onTriggerChange),h=d.useRef(!1),u=d.useRef(!1),p=d.useCallback(()=>h.current=!1,[]);return d.useEffect(()=>()=>document.removeEventListener("pointerup",p),[p]),s.jsx(mm,{asChild:!0,...o,children:s.jsx(Ae.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...a,ref:c,onPointerMove:xe(t.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),u.current=!0)}),onPointerLeave:xe(t.onPointerLeave,()=>{n.onTriggerLeave(),u.current=!1}),onPointerDown:xe(t.onPointerDown,()=>{n.open&&n.onClose(),h.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:xe(t.onFocus,()=>{h.current||n.onOpen()}),onBlur:xe(t.onBlur,n.onClose),onClick:xe(t.onClick,n.onClose)})})});Pw.displayName=uo;var Aw="TooltipPortal",[vk,Ew]=fi(Aw,{forceMount:void 0}),pa="TooltipContent",Gf=d.forwardRef((t,e)=>{const r=Ew(pa,t.__scopeTooltip),{forceMount:a=r.forceMount,side:n="top",...i}=t,o=pi(pa,t.__scopeTooltip);return s.jsx(qr,{present:a||o.open,children:o.disableHoverableContent?s.jsx(Xf,{side:n,...i,ref:e}):s.jsx(Iw,{side:n,...i,ref:e})})}),Iw=d.forwardRef((t,e)=>{const r=pi(pa,t.__scopeTooltip),a=Hf(pa,t.__scopeTooltip),n=d.useRef(null),i=ot(e,n),[o,l]=d.useState(null),{trigger:c,onClose:h}=r,u=n.current,{onPointerInTransitChange:p}=a,f=d.useCallback(()=>{l(null),p(!1)},[p]),g=d.useCallback((j,x)=>{const m=j.currentTarget,S={x:j.clientX,y:j.clientY},v=Fw(S,m.getBoundingClientRect()),y=Lw(S,v),C=Vw(x.getBoundingClientRect()),k=$w([...y,...C]);l(k),p(!0)},[p]);return d.useEffect(()=>()=>f(),[f]),d.useEffect(()=>{if(c&&u){const j=m=>g(m,u),x=m=>g(m,c);return c.addEventListener("pointerleave",j),u.addEventListener("pointerleave",x),()=>{c.removeEventListener("pointerleave",j),u.removeEventListener("pointerleave",x)}}},[c,u,g,f]),d.useEffect(()=>{if(o){const j=x=>{const m=x.target,S={x:x.clientX,y:x.clientY},v=(c==null?void 0:c.contains(m))||(u==null?void 0:u.contains(m)),y=!zw(S,o);v?f():y&&(f(),h())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[c,u,o,h,f]),s.jsx(Xf,{...t,ref:i})}),[Rw,Mw]=fi(Wf,{isInside:!1}),Ow=wv("TooltipContent"),Xf=d.forwardRef((t,e)=>{const{__scopeTooltip:r,children:a,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=t,c=pi(pa,r),h=Qo(r),{onClose:u}=c;return d.useEffect(()=>(document.addEventListener(zl,u),()=>document.removeEventListener(zl,u)),[u]),d.useEffect(()=>{if(c.trigger){const p=f=>{const g=f.target;g!=null&&g.contains(c.trigger)&&u()};return window.addEventListener("scroll",p,{capture:!0}),()=>window.removeEventListener("scroll",p,{capture:!0})}},[c.trigger,u]),s.jsx(fm,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:p=>p.preventDefault(),onDismiss:u,children:s.jsxs(pm,{"data-state":c.stateAttribute,...h,...l,ref:e,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[s.jsx(Ow,{children:a}),s.jsx(Rw,{scope:r,isInside:!0,children:s.jsx(Y0,{id:c.contentId,role:"tooltip",children:n||a})})]})})});Gf.displayName=pa;var Jf="TooltipArrow",Dw=d.forwardRef((t,e)=>{const{__scopeTooltip:r,...a}=t,n=Qo(r);return Mw(Jf,r).isInside?null:s.jsx(gm,{...n,...a,ref:e})});Dw.displayName=Jf;function Fw(t,e){const r=Math.abs(e.top-t.y),a=Math.abs(e.bottom-t.y),n=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,a,n,i)){case i:return"left";case n:return"right";case r:return"top";case a:return"bottom";default:throw new Error("unreachable")}}function Lw(t,e,r=5){const a=[];switch(e){case"top":a.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":a.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":a.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":a.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return a}function Vw(t){const{top:e,right:r,bottom:a,left:n}=t;return[{x:n,y:e},{x:r,y:e},{x:r,y:a},{x:n,y:a}]}function zw(t,e){const{x:r,y:a}=t;let n=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const l=e[i].x,c=e[i].y,h=e[o].x,u=e[o].y;c>a!=u>a&&r<(h-l)*(a-c)/(u-c)+l&&(n=!n)}return n}function $w(t){const e=t.slice();return e.sort((r,a)=>r.x<a.x?-1:r.x>a.x?1:r.y<a.y?-1:r.y>a.y?1:0),qw(e)}function qw(t){if(t.length<=1)return t.slice();const e=[];for(let a=0;a<t.length;a++){const n=t[a];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))e.pop();else break}e.push(n)}e.pop();const r=[];for(let a=t.length-1;a>=0;a--){const n=t[a];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))r.pop();else break}r.push(n)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var Uw=Zf,Yf=Gf;const Bw=Uw,Kw=d.forwardRef(({className:t,sideOffset:e=4,...r},a)=>s.jsx(Yf,{ref:a,sideOffset:e,className:se("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...r}));Kw.displayName=Yf.displayName;const Qw={theme:"system",setTheme:()=>null},ep=d.createContext(Qw);function Hw({children:t,defaultTheme:e="dark",storageKey:r="whatsapp-ui-theme",...a}){d.useState("dark"),d.useEffect(()=>{const i=window.document.documentElement;i.classList.remove("light","dark"),i.classList.add("dark")},[]);const n={theme:"dark",setTheme:i=>{console.log("Dark mode is permanently enabled")}};return s.jsx(ep.Provider,{...a,value:n,children:t})}const Zw=()=>{const t=d.useContext(ep);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},Ww=hi("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Te({className:t,variant:e,...r}){return s.jsx("div",{className:se(Ww({variant:e}),t),...r})}const tp=d.createContext(void 0);function Gw({children:t}){const{data:e=[],isLoading:r}=ye({queryKey:["/api/features"],staleTime:3e5,refetchOnWindowFocus:!0,refetchInterval:3e4}),a=o=>{const l=e.find(c=>c.id===o);return(l==null?void 0:l.isEnabled)??!1},n=o=>e.find(l=>l.id===o),i=o=>e.filter(l=>l.category===o);return s.jsx(tp.Provider,{value:{features:e,isLoading:r,isFeatureEnabled:a,getFeature:n,getFeaturesByCategory:i},children:t})}function Xw(){const t=d.useContext(tp);if(t===void 0)throw new Error("useFeatures must be used within a FeaturesProvider");return t}function Jw(){const[t]=ys(),{isFeatureEnabled:e}=Xw(),{data:r=[]}=ye({queryKey:["/api/cart"]}),n=[{label:"المحدثات",icon:fn,href:"/",isActive:t==="/",featureId:"messaging"},{label:"الحالات",icon:pr,href:"/status",isActive:t==="/status",featureId:"stories"},{label:"المتاجر",icon:Bt,href:"/stores",isActive:t==="/stores"||t==="/my-store",featureId:"stores"},{label:"السلة",icon:Dr,href:"/cart",isActive:t==="/cart"||t==="/orders",badge:r.length>0?r.length:void 0,featureId:"cart"},{label:"التسويق",icon:or,href:"/affiliate",isActive:t==="/affiliate",featureId:"affiliate"}].filter(i=>e(i.featureId));return s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 z-50",children:s.jsx("div",{className:"px-1",children:s.jsx("nav",{className:"flex justify-around items-center h-18 min-h-[72px] py-1",children:n.map(i=>{const o=i.icon;return s.jsxs(jt,{href:i.href,className:se("flex flex-col items-center justify-center py-2 px-4 rounded-xl transition-all duration-200 min-h-[56px] min-w-[56px] active:scale-95 touch-none relative",i.isActive?"text-whatsapp-green bg-green-50 dark:bg-green-950/30 scale-105":"text-gray-600 dark:text-gray-400 hover:text-whatsapp-green hover:bg-gray-50 dark:hover:bg-gray-700"),"data-testid":`nav-${i.label}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx(o,{className:"w-7 h-7 mb-1"}),i.badge&&s.jsx(Te,{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center p-0",children:i.badge})]}),s.jsx("span",{className:"text-sm font-semibold tracking-tight",children:i.label})]},i.href)})})})})}const sp=d.createContext(void 0);function Yw({children:t}){const[e,r]=d.useState(null),[a,n]=d.useState(!0),i=(c,h)=>{localStorage.setItem("auth_token",h),r(c)},o=async()=>{if(localStorage.getItem("auth_token"))try{await ce("/api/auth/logout",{method:"POST"})}catch(h){console.error("Logout error:",h)}localStorage.removeItem("auth_token"),r(null)},l=async()=>{if(!localStorage.getItem("auth_token")){n(!1);return}try{const h=await ce("/api/user/current");r(h)}catch(h){console.error("Auth check failed:",h),localStorage.removeItem("auth_token")}finally{n(!1)}};return d.useEffect(()=>{l()},[]),s.jsx(sp.Provider,{value:{user:e,isLoading:a,isAuthenticated:!!e,login:i,logout:o},children:t})}function rp(){const t=d.useContext(sp);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const ej=hi("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),T=d.forwardRef(({className:t,variant:e,size:r,asChild:a=!1,...n},i)=>{const o=a?xm:"button";return s.jsx(o,{className:se(ej({variant:e,size:r,className:t})),ref:i,...n})});T.displayName="Button";const Ce=d.forwardRef(({className:t,type:e,...r},a)=>s.jsx("input",{type:e,className:se("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...r}));Ce.displayName="Input";var Ho="Avatar",[tj,bk]=$r(Ho),[sj,ap]=tj(Ho),np=d.forwardRef((t,e)=>{const{__scopeAvatar:r,...a}=t,[n,i]=d.useState("idle");return s.jsx(sj,{scope:r,imageLoadingStatus:n,onImageLoadingStatusChange:i,children:s.jsx(Ae.span,{...a,ref:e})})});np.displayName=Ho;var ip="AvatarImage",op=d.forwardRef((t,e)=>{const{__scopeAvatar:r,src:a,onLoadingStatusChange:n=()=>{},...i}=t,o=ap(ip,r),l=rj(a,i),c=Jt(h=>{n(h),o.onImageLoadingStatusChange(h)});return ts(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?s.jsx(Ae.img,{...i,ref:e,src:a}):null});op.displayName=ip;var lp="AvatarFallback",cp=d.forwardRef((t,e)=>{const{__scopeAvatar:r,delayMs:a,...n}=t,i=ap(lp,r),[o,l]=d.useState(a===void 0);return d.useEffect(()=>{if(a!==void 0){const c=window.setTimeout(()=>l(!0),a);return()=>window.clearTimeout(c)}},[a]),o&&i.imageLoadingStatus!=="loaded"?s.jsx(Ae.span,{...n,ref:e}):null});cp.displayName=lp;function $l(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function rj(t,{referrerPolicy:e,crossOrigin:r}){const a=nj(),n=d.useRef(null),i=a?(n.current||(n.current=new window.Image),n.current):null,[o,l]=d.useState(()=>$l(i,t));return ts(()=>{l($l(i,t))},[i,t]),ts(()=>{const c=p=>()=>{l(p)};if(!i)return;const h=c("loaded"),u=c("error");return i.addEventListener("load",h),i.addEventListener("error",u),e&&(i.referrerPolicy=e),typeof r=="string"&&(i.crossOrigin=r),()=>{i.removeEventListener("load",h),i.removeEventListener("error",u)}},[i,r,e]),o}function aj(){return()=>{}}function nj(){return d.useSyncExternalStore(aj,()=>!0,()=>!1)}var dp=np,up=op,hp=cp;const Ft=d.forwardRef(({className:t,...e},r)=>s.jsx(dp,{ref:r,className:se("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));Ft.displayName=dp.displayName;const Lt=d.forwardRef(({className:t,...e},r)=>s.jsx(up,{ref:r,className:se("aspect-square h-full w-full",t),...e}));Lt.displayName=up.displayName;const Vt=d.forwardRef(({className:t,...e},r)=>s.jsx(hp,{ref:r,className:se("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));Vt.displayName=hp.displayName;const Yt=Sv,Qa=kv,ij=Nv,mp=d.forwardRef(({className:t,...e},r)=>s.jsx(ym,{ref:r,className:se("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));mp.displayName=ym.displayName;const Kt=d.forwardRef(({className:t,children:e,...r},a)=>s.jsxs(ij,{children:[s.jsx(mp,{}),s.jsxs(vm,{ref:a,className:se("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[e,s.jsxs(jv,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(dr,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Kt.displayName=vm.displayName;const Qt=({className:t,...e})=>s.jsx("div",{className:se("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Qt.displayName="DialogHeader";const fp=({className:t,...e})=>s.jsx("div",{className:se("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});fp.displayName="DialogFooter";const Ht=d.forwardRef(({className:t,...e},r)=>s.jsx(bm,{ref:r,className:se("text-lg font-semibold leading-none tracking-tight",t),...e}));Ht.displayName=bm.displayName;const Fn=d.forwardRef(({className:t,...e},r)=>s.jsx(wm,{ref:r,className:se("text-sm text-muted-foreground",t),...e}));Fn.displayName=wm.displayName;const pp=_v,gp=Tv,oj=d.forwardRef(({className:t,inset:e,children:r,...a},n)=>s.jsxs(jm,{ref:n,className:se("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...a,children:[r,s.jsx(Vo,{className:"ml-auto"})]}));oj.displayName=jm.displayName;const lj=d.forwardRef(({className:t,...e},r)=>s.jsx(Nm,{ref:r,className:se("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...e}));lj.displayName=Nm.displayName;const Zo=d.forwardRef(({className:t,sideOffset:e=4,...r},a)=>s.jsx(Cv,{children:s.jsx(Sm,{ref:a,sideOffset:e,className:se("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...r})}));Zo.displayName=Sm.displayName;const Va=d.forwardRef(({className:t,inset:e,...r},a)=>s.jsx(km,{ref:a,className:se("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...r}));Va.displayName=km.displayName;const cj=d.forwardRef(({className:t,children:e,checked:r,...a},n)=>s.jsxs(Cm,{ref:n,className:se("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...a,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(_m,{children:s.jsx(Gs,{className:"h-4 w-4"})})}),e]}));cj.displayName=Cm.displayName;const dj=d.forwardRef(({className:t,children:e,...r},a)=>s.jsxs(Tm,{ref:a,className:se("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(_m,{children:s.jsx(Sb,{className:"h-2 w-2 fill-current"})})}),e]}));dj.displayName=Tm.displayName;const uj=d.forwardRef(({className:t,inset:e,...r},a)=>s.jsx(Pm,{ref:a,className:se("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...r}));uj.displayName=Pm.displayName;const hj=d.forwardRef(({className:t,...e},r)=>s.jsx(Am,{ref:r,className:se("-mx-1 my-1 h-px bg-muted",t),...e}));hj.displayName=Am.displayName;function ga({className:t="w-4 h-4",title:e="حساب موثق",animated:r=!0}){return s.jsxs("div",{className:`relative inline-flex items-center justify-center ${t}`,title:e,"data-testid":"badge-verified",children:[s.jsx("div",{className:`absolute inset-0 rounded-full bg-gradient-to-r from-blue-500 via-purple-500 to-emerald-500 ${r?"animate-spin":""}`,style:{animation:r?"spin 3s linear infinite":"none"}}),s.jsxs("div",{className:"relative flex items-center justify-center w-full h-full rounded-full bg-white dark:bg-gray-900 border-2 border-transparent",children:[s.jsx("div",{className:"absolute inset-[1px] rounded-full bg-gradient-to-r from-blue-500 via-purple-500 to-emerald-500"}),s.jsx("div",{className:"relative flex items-center justify-center w-full h-full rounded-full bg-white dark:bg-gray-900 m-[1px]",children:s.jsx(gt,{className:"w-[60%] h-[60%] text-blue-500",fill:"currentColor"})})]}),r&&s.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-500 opacity-30 animate-ping"})]})}function mj({onStoryClick:t,onCreateStory:e}){var l;const{data:r=[],isLoading:a}=ye({queryKey:["/api/stories"]}),{data:n}=ye({queryKey:["/api/user/current"]}),i=r.reduce((c,h)=>{const u=h.userId;return c[u]||(c[u]=[]),c[u].push(h),c},{});if(a)return s.jsx("div",{className:"p-4",children:s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"جاري تحميل الحالات..."})});const o=Object.entries(i);return s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"p-3 sm:p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"الحالة"}),s.jsx("span",{className:"text-xs text-[var(--whatsapp-primary)] bg-[var(--whatsapp-light)] px-2 py-1 rounded-full",children:"انشر منتجك"})]}),s.jsxs("div",{className:"flex space-x-3 sm:space-x-4 overflow-x-auto pb-2 scrolling-touch rtl-scroll story-container",children:[s.jsx("div",{className:"flex-shrink-0 story-item",children:s.jsxs(T,{onClick:e,variant:"ghost",className:"flex flex-col items-center p-1 sm:p-2 space-y-1 sm:space-y-2 mobile-touch-target","data-testid":"button-create-story",children:[s.jsxs("div",{className:"relative",children:[s.jsxs(Ft,{className:"w-12 h-12 sm:w-14 sm:h-14 border-2 border-gray-300 dark:border-gray-600",children:[s.jsx(Lt,{src:(n==null?void 0:n.avatar)||void 0,alt:(n==null?void 0:n.name)||"المستخدم"}),s.jsx(Vt,{children:((l=n==null?void 0:n.name)==null?void 0:l[0])||"أ"})]}),s.jsx("div",{className:"absolute -bottom-1 -left-1 w-4 h-4 sm:w-5 sm:h-5 bg-[var(--whatsapp-primary)] rounded-full flex items-center justify-center border-2 border-white dark:border-gray-800",children:s.jsx(Bs,{className:"w-2 h-2 sm:w-3 sm:h-3 text-white"})})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300 hidden sm:block",children:"حالتي"}),s.jsx("div",{className:"text-xs text-[var(--whatsapp-primary)] font-medium",children:"انشر منتجك"})]})]})}),o.map(([c,h])=>{const u=h[0],p=h.some(f=>{var g;return!((g=f.viewers)!=null&&g.includes("current-user"))});return s.jsx("div",{className:"flex-shrink-0 story-item",children:s.jsxs(T,{onClick:()=>t(u.id),variant:"ghost",className:"flex flex-col items-center p-1 sm:p-2 space-y-1 sm:space-y-2 mobile-touch-target","data-testid":`story-ring-${c}`,children:[s.jsxs("div",{className:"relative",children:[s.jsxs(Ft,{className:`w-12 h-12 sm:w-14 sm:h-14 border-2 ${p?"border-[var(--whatsapp-primary)]":"border-gray-300 dark:border-gray-600"}`,children:[s.jsx(Lt,{src:u.user.avatar||void 0,alt:u.user.name}),s.jsx(Vt,{children:u.user.name[0]})]}),s.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 sm:w-5 sm:h-5 bg-[var(--whatsapp-primary)] text-white rounded-full text-xs flex items-center justify-center",children:h.length})]}),s.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-300 truncate max-w-12 sm:max-w-16 hidden sm:flex items-center gap-1",children:[s.jsx("span",{children:u.user.name}),u.user.isVerified&&s.jsx(ga,{className:"w-2.5 h-2.5 flex-shrink-0"})]})]})},c)})]})]})})}function ho(t,[e,r]){return Math.min(r,Math.max(e,t))}function fj(t,e){return d.useReducer((r,a)=>e[r][a]??r,t)}var Wo="ScrollArea",[xp,wk]=$r(Wo),[pj,os]=xp(Wo),yp=d.forwardRef((t,e)=>{const{__scopeScrollArea:r,type:a="hover",dir:n,scrollHideDelay:i=600,...o}=t,[l,c]=d.useState(null),[h,u]=d.useState(null),[p,f]=d.useState(null),[g,j]=d.useState(null),[x,m]=d.useState(null),[S,v]=d.useState(0),[y,C]=d.useState(0),[k,D]=d.useState(!1),[Q,H]=d.useState(!1),M=ot(e,$=>c($)),L=To(n);return s.jsx(pj,{scope:r,type:a,dir:L,scrollHideDelay:i,scrollArea:l,viewport:h,onViewportChange:u,content:p,onContentChange:f,scrollbarX:g,onScrollbarXChange:j,scrollbarXEnabled:k,onScrollbarXEnabledChange:D,scrollbarY:x,onScrollbarYChange:m,scrollbarYEnabled:Q,onScrollbarYEnabledChange:H,onCornerWidthChange:v,onCornerHeightChange:C,children:s.jsx(Ae.div,{dir:L,...o,ref:M,style:{position:"relative","--radix-scroll-area-corner-width":S+"px","--radix-scroll-area-corner-height":y+"px",...t.style}})})});yp.displayName=Wo;var vp="ScrollAreaViewport",bp=d.forwardRef((t,e)=>{const{__scopeScrollArea:r,children:a,nonce:n,...i}=t,o=os(vp,r),l=d.useRef(null),c=ot(e,l,o.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),s.jsx(Ae.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:s.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});bp.displayName=vp;var Is="ScrollAreaScrollbar",Go=d.forwardRef((t,e)=>{const{forceMount:r,...a}=t,n=os(Is,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=n,l=t.orientation==="horizontal";return d.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),n.type==="hover"?s.jsx(gj,{...a,ref:e,forceMount:r}):n.type==="scroll"?s.jsx(xj,{...a,ref:e,forceMount:r}):n.type==="auto"?s.jsx(wp,{...a,ref:e,forceMount:r}):n.type==="always"?s.jsx(Xo,{...a,ref:e}):null});Go.displayName=Is;var gj=d.forwardRef((t,e)=>{const{forceMount:r,...a}=t,n=os(Is,t.__scopeScrollArea),[i,o]=d.useState(!1);return d.useEffect(()=>{const l=n.scrollArea;let c=0;if(l){const h=()=>{window.clearTimeout(c),o(!0)},u=()=>{c=window.setTimeout(()=>o(!1),n.scrollHideDelay)};return l.addEventListener("pointerenter",h),l.addEventListener("pointerleave",u),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",h),l.removeEventListener("pointerleave",u)}}},[n.scrollArea,n.scrollHideDelay]),s.jsx(qr,{present:r||i,children:s.jsx(wp,{"data-state":i?"visible":"hidden",...a,ref:e})})}),xj=d.forwardRef((t,e)=>{const{forceMount:r,...a}=t,n=os(Is,t.__scopeScrollArea),i=t.orientation==="horizontal",o=xi(()=>c("SCROLL_END"),100),[l,c]=fj("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return d.useEffect(()=>{if(l==="idle"){const h=window.setTimeout(()=>c("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(h)}},[l,n.scrollHideDelay,c]),d.useEffect(()=>{const h=n.viewport,u=i?"scrollLeft":"scrollTop";if(h){let p=h[u];const f=()=>{const g=h[u];p!==g&&(c("SCROLL"),o()),p=g};return h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[n.viewport,i,c,o]),s.jsx(qr,{present:r||l!=="hidden",children:s.jsx(Xo,{"data-state":l==="hidden"?"hidden":"visible",...a,ref:e,onPointerEnter:xe(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:xe(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),wp=d.forwardRef((t,e)=>{const r=os(Is,t.__scopeScrollArea),{forceMount:a,...n}=t,[i,o]=d.useState(!1),l=t.orientation==="horizontal",c=xi(()=>{if(r.viewport){const h=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?h:u)}},10);return xa(r.viewport,c),xa(r.content,c),s.jsx(qr,{present:a||i,children:s.jsx(Xo,{"data-state":i?"visible":"hidden",...n,ref:e})})}),Xo=d.forwardRef((t,e)=>{const{orientation:r="vertical",...a}=t,n=os(Is,t.__scopeScrollArea),i=d.useRef(null),o=d.useRef(0),[l,c]=d.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=Cp(l.viewport,l.content),u={...a,sizes:l,onSizesChange:c,hasThumb:h>0&&h<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function p(f,g){return Nj(f,o.current,l,g)}return r==="horizontal"?s.jsx(yj,{...u,ref:e,onThumbPositionChange:()=>{if(n.viewport&&i.current){const f=n.viewport.scrollLeft,g=ql(f,l,n.dir);i.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:f=>{n.viewport&&(n.viewport.scrollLeft=f)},onDragScroll:f=>{n.viewport&&(n.viewport.scrollLeft=p(f,n.dir))}}):r==="vertical"?s.jsx(vj,{...u,ref:e,onThumbPositionChange:()=>{if(n.viewport&&i.current){const f=n.viewport.scrollTop,g=ql(f,l);i.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:f=>{n.viewport&&(n.viewport.scrollTop=f)},onDragScroll:f=>{n.viewport&&(n.viewport.scrollTop=p(f))}}):null}),yj=d.forwardRef((t,e)=>{const{sizes:r,onSizesChange:a,...n}=t,i=os(Is,t.__scopeScrollArea),[o,l]=d.useState(),c=d.useRef(null),h=ot(e,c,i.onScrollbarXChange);return d.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(Np,{"data-orientation":"horizontal",...n,ref:h,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":gi(r)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.x),onDragScroll:u=>t.onDragScroll(u.x),onWheelScroll:(u,p)=>{if(i.viewport){const f=i.viewport.scrollLeft+u.deltaX;t.onWheelScroll(f),Tp(f,p)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&a({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Vn(o.paddingLeft),paddingEnd:Vn(o.paddingRight)}})}})}),vj=d.forwardRef((t,e)=>{const{sizes:r,onSizesChange:a,...n}=t,i=os(Is,t.__scopeScrollArea),[o,l]=d.useState(),c=d.useRef(null),h=ot(e,c,i.onScrollbarYChange);return d.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),s.jsx(Np,{"data-orientation":"vertical",...n,ref:h,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":gi(r)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.y),onDragScroll:u=>t.onDragScroll(u.y),onWheelScroll:(u,p)=>{if(i.viewport){const f=i.viewport.scrollTop+u.deltaY;t.onWheelScroll(f),Tp(f,p)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&a({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Vn(o.paddingTop),paddingEnd:Vn(o.paddingBottom)}})}})}),[bj,jp]=xp(Is),Np=d.forwardRef((t,e)=>{const{__scopeScrollArea:r,sizes:a,hasThumb:n,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:h,onWheelScroll:u,onResize:p,...f}=t,g=os(Is,r),[j,x]=d.useState(null),m=ot(e,M=>x(M)),S=d.useRef(null),v=d.useRef(""),y=g.viewport,C=a.content-a.viewport,k=Jt(u),D=Jt(c),Q=xi(p,10);function H(M){if(S.current){const L=M.clientX-S.current.left,$=M.clientY-S.current.top;h({x:L,y:$})}}return d.useEffect(()=>{const M=L=>{const $=L.target;(j==null?void 0:j.contains($))&&k(L,C)};return document.addEventListener("wheel",M,{passive:!1}),()=>document.removeEventListener("wheel",M,{passive:!1})},[y,j,C,k]),d.useEffect(D,[a,D]),xa(j,Q),xa(g.content,Q),s.jsx(bj,{scope:r,scrollbar:j,hasThumb:n,onThumbChange:Jt(i),onThumbPointerUp:Jt(o),onThumbPositionChange:D,onThumbPointerDown:Jt(l),children:s.jsx(Ae.div,{...f,ref:m,style:{position:"absolute",...f.style},onPointerDown:xe(t.onPointerDown,M=>{M.button===0&&(M.target.setPointerCapture(M.pointerId),S.current=j.getBoundingClientRect(),v.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),H(M))}),onPointerMove:xe(t.onPointerMove,H),onPointerUp:xe(t.onPointerUp,M=>{const L=M.target;L.hasPointerCapture(M.pointerId)&&L.releasePointerCapture(M.pointerId),document.body.style.webkitUserSelect=v.current,g.viewport&&(g.viewport.style.scrollBehavior=""),S.current=null})})})}),Ln="ScrollAreaThumb",Sp=d.forwardRef((t,e)=>{const{forceMount:r,...a}=t,n=jp(Ln,t.__scopeScrollArea);return s.jsx(qr,{present:r||n.hasThumb,children:s.jsx(wj,{ref:e,...a})})}),wj=d.forwardRef((t,e)=>{const{__scopeScrollArea:r,style:a,...n}=t,i=os(Ln,r),o=jp(Ln,r),{onThumbPositionChange:l}=o,c=ot(e,p=>o.onThumbChange(p)),h=d.useRef(void 0),u=xi(()=>{h.current&&(h.current(),h.current=void 0)},100);return d.useEffect(()=>{const p=i.viewport;if(p){const f=()=>{if(u(),!h.current){const g=Sj(p,l);h.current=g,l()}};return l(),p.addEventListener("scroll",f),()=>p.removeEventListener("scroll",f)}},[i.viewport,u,l]),s.jsx(Ae.div,{"data-state":o.hasThumb?"visible":"hidden",...n,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:xe(t.onPointerDownCapture,p=>{const g=p.target.getBoundingClientRect(),j=p.clientX-g.left,x=p.clientY-g.top;o.onThumbPointerDown({x:j,y:x})}),onPointerUp:xe(t.onPointerUp,o.onThumbPointerUp)})});Sp.displayName=Ln;var Jo="ScrollAreaCorner",kp=d.forwardRef((t,e)=>{const r=os(Jo,t.__scopeScrollArea),a=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&a?s.jsx(jj,{...t,ref:e}):null});kp.displayName=Jo;var jj=d.forwardRef((t,e)=>{const{__scopeScrollArea:r,...a}=t,n=os(Jo,r),[i,o]=d.useState(0),[l,c]=d.useState(0),h=!!(i&&l);return xa(n.scrollbarX,()=>{var p;const u=((p=n.scrollbarX)==null?void 0:p.offsetHeight)||0;n.onCornerHeightChange(u),c(u)}),xa(n.scrollbarY,()=>{var p;const u=((p=n.scrollbarY)==null?void 0:p.offsetWidth)||0;n.onCornerWidthChange(u),o(u)}),h?s.jsx(Ae.div,{...a,ref:e,style:{width:i,height:l,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Vn(t){return t?parseInt(t,10):0}function Cp(t,e){const r=t/e;return isNaN(r)?0:r}function gi(t){const e=Cp(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=(t.scrollbar.size-r)*e;return Math.max(a,18)}function Nj(t,e,r,a="ltr"){const n=gi(r),i=n/2,o=e||i,l=n-o,c=r.scrollbar.paddingStart+o,h=r.scrollbar.size-r.scrollbar.paddingEnd-l,u=r.content-r.viewport,p=a==="ltr"?[0,u]:[u*-1,0];return _p([c,h],p)(t)}function ql(t,e,r="ltr"){const a=gi(e),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-n,o=e.content-e.viewport,l=i-a,c=r==="ltr"?[0,o]:[o*-1,0],h=ho(t,c);return _p([0,o],[0,l])(h)}function _p(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const a=(e[1]-e[0])/(t[1]-t[0]);return e[0]+a*(r-t[0])}}function Tp(t,e){return t>0&&t<e}var Sj=(t,e=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},a=0;return function n(){const i={left:t.scrollLeft,top:t.scrollTop},o=r.left!==i.left,l=r.top!==i.top;(o||l)&&e(),r=i,a=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(a)};function xi(t,e){const r=Jt(t),a=d.useRef(0);return d.useEffect(()=>()=>window.clearTimeout(a.current),[]),d.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(r,e)},[r,e])}function xa(t,e){const r=Jt(e);ts(()=>{let a=0;if(t){const n=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(r)});return n.observe(t),()=>{window.cancelAnimationFrame(a),n.unobserve(t)}}},[t,r])}var Pp=yp,kj=bp,Cj=kp;const Yo=d.forwardRef(({className:t,children:e,...r},a)=>s.jsxs(Pp,{ref:a,className:se("relative overflow-hidden",t),...r,children:[s.jsx(kj,{className:"h-full w-full rounded-[inherit]",children:e}),s.jsx(Ap,{}),s.jsx(Cj,{})]}));Yo.displayName=Pp.displayName;const Ap=d.forwardRef(({className:t,orientation:e="vertical",...r},a)=>s.jsx(Go,{ref:a,orientation:e,className:se("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:s.jsx(Sp,{className:"relative flex-1 rounded-full bg-border"})}));Ap.displayName=Go.displayName;const ms=(t,...e)=>{try{if(typeof t=="function")return t(...e)}catch(r){console.debug("Safe execution warning:",r)}},Ye=(t,e="DOM operation warning")=>{try{t()}catch(r){console.debug(e,r)}},_j=(t,e,r,a)=>{Ye(()=>t.removeEventListener(e,r,a),"Event listener removal warning")},Nn=(t,e,r,a)=>{try{return t.addEventListener(e,r,a),()=>_j(t,e,r,a)}catch(n){return console.debug("Event listener addition warning:",n),()=>{}}},Tj=(t,e)=>{const r=setInterval(()=>{Ye(t,"Interval callback warning")},e);return()=>{Ye(()=>clearInterval(r),"Interval cleanup warning")}},Ul=t=>()=>{t.forEach((e,r)=>{Ye(e,`Cleanup operation ${r} warning`)})},Pj=(t,e,r=5e3)=>{const n=100/r*50;let i=0,o=!1,l=null;const c=()=>{o||(o=!0,i=0,l=Tj(()=>{o&&(i+=n,i>=100?(i=100,ms(t,i),h(),ms(e)):ms(t,i))},50))},h=()=>{o=!1,l&&(l(),l=null)};return{start:c,stop:h,pause:()=>{o=!1},resume:()=>{i<100&&(o=!0)},reset:()=>{h(),i=0,ms(t,0)},getProgress:()=>i,isActive:()=>o}},Aj=(t,e,r)=>({next:()=>{ms(t)},previous:()=>{ms(e)},close:()=>{ms(r)}});function Ej({storyId:t,onClose:e,onNext:r,onPrevious:a}){var $,w;const[n,i]=d.useState(!0),[o,l]=d.useState(0),[c,h]=d.useState(!1),[u,p]=d.useState(""),f=vs(),[,g]=ys(),{data:j,isLoading:x}=ye({queryKey:["/api/stories",t],enabled:!!t}),{data:m}=ye({queryKey:["/api/user/current"]}),S=Se({mutationFn:async()=>ce(`/api/stories/${t}/view`,{method:"PATCH",headers:{"Content-Type":"application/json"}}),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/stories"]})}}),v=Se({mutationFn:async A=>ce("/api/chats/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otherUserId:A})}),onSuccess:A=>{g(`/chat/${A.chatId}`)}}),{data:y}=ye({queryKey:["/api/stories",t,"likes"],enabled:!!t}),{data:C}=ye({queryKey:["/api/stories",t,"comments"],enabled:!!t}),k=Se({mutationFn:async()=>ce(`/api/stories/${t}/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reactionType:"like"})}),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/stories",t,"likes"]})}}),D=Se({mutationFn:async()=>ce(`/api/stories/${t}/like`,{method:"DELETE"}),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/stories",t,"likes"]})}}),Q=Se({mutationFn:async A=>ce(`/api/stories/${t}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:A})}),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/stories",t,"comments"]}),p("")}}),H=()=>{y!=null&&y.hasUserLiked?D.mutate():k.mutate()},M=()=>{u.trim()&&Q.mutate(u.trim())};d.useEffect(()=>{t&&j&&S.mutate()},[t,j]),d.useEffect(()=>{if(!n)return;const A=Aj(r,void 0,e),I=Pj(l,A.close,5e3);return I.start(),()=>{I.stop()}},[n,r,e]),d.useEffect(()=>{l(0),i(!0)},[t]);const L=A=>{if(!A)return"";const K=Math.abs(new Date().getTime()-new Date(A).getTime())/(1e3*60*60);return K<1?`منذ ${Math.floor(K*60)} دقيقة`:K<24?`منذ ${Math.floor(K)} ساعة`:`منذ ${Math.floor(K/24)} يوم`};return x||!j?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center",children:s.jsx("div",{className:"text-white",children:"جاري التحميل..."})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center",onClick:A=>{A.target===A.currentTarget&&e()},"data-testid":"story-viewer",children:s.jsxs("div",{className:"relative w-full max-w-md h-full md:h-auto md:max-h-[80vh] bg-black md:rounded-lg overflow-hidden",children:[s.jsx("div",{className:"absolute top-4 left-4 right-4 z-10",children:s.jsx("div",{className:"w-full bg-white bg-opacity-30 rounded-full h-1",children:s.jsx("div",{className:"bg-white rounded-full h-1 transition-all duration-100",style:{width:`${o}%`}})})}),s.jsxs("div",{className:"absolute top-8 left-4 right-4 z-10 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[s.jsxs(Ft,{className:"w-10 h-10 border-2 border-white",children:[s.jsx(Lt,{src:j.user.avatar||void 0,alt:j.user.name}),s.jsx(Vt,{className:"text-black",children:j.user.name[0]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("h3",{className:"text-white font-medium text-sm",children:j.user.name}),j.user.isVerified&&s.jsx(ga,{className:"w-3.5 h-3.5"})]}),s.jsx("p",{className:"text-white text-opacity-80 text-xs",children:L(j.timestamp||new Date)})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[(m==null?void 0:m.id)!==j.userId&&s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>v.mutate(j.userId),disabled:v.isPending,className:"text-white hover:bg-white hover:bg-opacity-20","data-testid":"button-message-story-owner",children:s.jsx(Cs,{className:"h-4 w-4"})}),s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>i(!n),className:"text-white hover:bg-white hover:bg-opacity-20","data-testid":"button-play-pause",children:n?s.jsx($o,{className:"h-4 w-4"}):s.jsx(qo,{className:"h-4 w-4"})}),s.jsx(T,{variant:"ghost",size:"icon",onClick:e,className:"text-white hover:bg-white hover:bg-opacity-20","data-testid":"button-close-story",children:s.jsx(dr,{className:"h-4 w-4"})})]})]}),s.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{backgroundColor:j.backgroundColor||"#075e54"},onClick:()=>i(!n),children:j.imageUrl?s.jsx("img",{src:j.imageUrl,alt:"Story",className:"w-full h-full object-cover","data-testid":"story-image"}):s.jsx("div",{className:"p-8 text-center",children:s.jsx("p",{className:"text-2xl font-medium leading-relaxed break-words",style:{color:j.textColor||"#ffffff"},"data-testid":"story-text",children:j.content})})}),a&&s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>a(),className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:bg-white hover:bg-opacity-20","data-testid":"button-previous-story",children:s.jsx(Tf,{className:"h-6 w-6"})}),r&&s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>r(),className:"absolute right-4 top-16 text-white hover:bg-white hover:bg-opacity-20","data-testid":"button-next-story",children:s.jsx(Vo,{className:"h-6 w-6"})}),s.jsxs("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 flex flex-col space-y-4",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(T,{variant:"ghost",size:"icon",onClick:H,disabled:k.isPending||D.isPending,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-full w-12 h-12","data-testid":"button-like-story",children:s.jsx(Mn,{className:`h-6 w-6 ${y!=null&&y.hasUserLiked?"fill-red-500 text-red-500":""}`})}),((y==null?void 0:y.count)||0)>0&&s.jsx("span",{className:"text-white text-sm mt-1",children:y==null?void 0:y.count})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>h(!c),className:"text-white hover:bg-white hover:bg-opacity-20 rounded-full w-12 h-12","data-testid":"button-comments-story",children:s.jsx(fn,{className:"h-6 w-6"})}),((C==null?void 0:C.count)||0)>0&&s.jsx("span",{className:"text-white text-sm mt-1",children:C==null?void 0:C.count})]}),s.jsx("div",{className:"flex flex-col items-center",children:s.jsx(T,{variant:"ghost",size:"icon",className:"text-white hover:bg-white hover:bg-opacity-20 rounded-full w-12 h-12","data-testid":"button-share-story",children:s.jsx(Rf,{className:"h-6 w-6"})})})]}),s.jsx("div",{className:"absolute bottom-4 right-4",children:s.jsx("div",{className:"bg-black bg-opacity-50 rounded-full px-3 py-1",children:s.jsxs("span",{className:"text-white text-sm",children:["👁 ",j.viewCount]})})}),c&&s.jsxs("div",{className:"absolute bottom-20 left-4 right-4 bg-black bg-opacity-80 rounded-lg p-4 max-h-60",children:[s.jsxs(Yo,{className:"h-32 mb-3",children:[($=C==null?void 0:C.comments)==null?void 0:$.map(A=>s.jsx("div",{className:"mb-3 pb-2 border-b border-white border-opacity-20 last:border-b-0",children:s.jsxs("div",{className:"flex items-start space-x-2 space-x-reverse",children:[s.jsxs(Ft,{className:"w-8 h-8 ring-2 ring-white ring-opacity-30",children:[s.jsx(Lt,{src:A.user.avatar||void 0,alt:A.user.name}),s.jsx(Vt,{className:"text-xs bg-gradient-to-br from-blue-500 to-purple-600 text-white font-semibold",children:A.user.name[0]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-1",children:[s.jsx("span",{className:"text-white text-sm font-bold",children:A.user.name}),A.user.isVerified&&s.jsx(ga,{className:"w-4 h-4",title:"حساب موثق",animated:!1}),s.jsx("span",{className:"text-white text-opacity-70 text-xs",children:L(A.createdAt)})]}),s.jsx("p",{className:"text-white text-sm leading-relaxed",children:A.content})]})]})},A.id)),(!(C!=null&&C.comments)||C.comments.length===0)&&s.jsx("p",{className:"text-white text-opacity-60 text-sm text-center py-4",children:"لا توجد تعليقات بعد"})]}),s.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[s.jsxs(Ft,{className:"w-8 h-8 ring-2 ring-white ring-opacity-30",children:[s.jsx(Lt,{src:(m==null?void 0:m.avatar)||void 0,alt:m==null?void 0:m.name}),s.jsx(Vt,{className:"text-xs bg-gradient-to-br from-green-500 to-emerald-600 text-white font-semibold",children:(w=m==null?void 0:m.name)==null?void 0:w[0]})]}),s.jsx(Ce,{value:u,onChange:A=>p(A.target.value),placeholder:"أضف تعليق...",className:"flex-1 bg-white bg-opacity-20 border-white border-opacity-30 text-white placeholder-white placeholder-opacity-60",onKeyPress:A=>A.key==="Enter"&&M(),"data-testid":"input-add-comment"}),s.jsx(T,{variant:"ghost",size:"icon",onClick:M,disabled:!u.trim()||Q.isPending,className:"text-white hover:bg-white hover:bg-opacity-20","data-testid":"button-send-comment",children:s.jsx(Uo,{className:"h-4 w-4"})})]})]})]})})}const qs=d.forwardRef(({className:t,...e},r)=>s.jsx("textarea",{className:se("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...e}));qs.displayName="Textarea";var Ij="Label",Ep=d.forwardRef((t,e)=>s.jsx(Ae.label,{...t,ref:e,onMouseDown:r=>{var n;r.target.closest("button, input, select, textarea")||((n=t.onMouseDown)==null||n.call(t,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Ep.displayName=Ij;var Ip=Ep;const Rj=hi("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Pe=d.forwardRef(({className:t,...e},r)=>s.jsx(Ip,{ref:r,className:se(Rj(),t),...e}));Pe.displayName=Ip.displayName;const Mj=["#075e54","#25D366","#128C7E","#34B7F1","#DCF8C6","#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57"],Oj=["#ffffff","#000000","#333333","#666666","#999999"];function Rp({isOpen:t,onClose:e}){const[r,a]=d.useState(""),[n,i]=d.useState(""),[o,l]=d.useState(""),[c,h]=d.useState("#075e54"),[u,p]=d.useState("#ffffff"),[f,g]=d.useState("text"),[j,x]=d.useState(null),[m,S]=d.useState(!1),v=d.useRef(null),y=vs(),{toast:C}=lt(),k=Se({mutationFn:async w=>{const A=new FormData;A.append("media",w);const I=await fetch("/api/upload/media",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:A});if(!I.ok)throw new Error("فشل في رفع الملف");return I.json()},onSuccess:w=>{w.fileType==="video"?(l(w.mediaUrl),i("")):(i(w.mediaUrl),l("")),x(null),S(!1),C({title:"تم رفع الملف",description:`تم رفع ${w.fileType==="video"?"الفيديو":"الصورة"} بنجاح`})},onError:w=>{S(!1),C({title:"خطأ",description:w.message||"فشل في رفع الملف",variant:"destructive"})}}),D=Se({mutationFn:async()=>ce("/api/stories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:r.trim()||null,imageUrl:n.trim()||null,videoUrl:o.trim()||null,backgroundColor:c,textColor:u})}),onSuccess:()=>{y.invalidateQueries({queryKey:["/api/stories"]}),C({title:"تم النشر",description:"تم نشر حالتك بنجاح"}),e(),M()},onError:w=>{C({title:"خطأ",description:w.message||"فشل في نشر الحالة",variant:"destructive"})}}),Q=w=>{var I;const A=(I=w.target.files)==null?void 0:I[0];A&&(x(A),S(!0),k.mutate(A))},H=()=>{v.current&&v.current.click()},M=()=>{a(""),i(""),l(""),x(null),S(!1),h("#075e54"),p("#ffffff"),g("text"),v.current&&(v.current.value="")},L=()=>{!r.trim()&&!n.trim()&&!o.trim()||D.mutate()},$=()=>{e(),M()};return s.jsx(Yt,{open:t,onOpenChange:$,children:s.jsxs(Kt,{className:"max-w-md","data-testid":"create-story-modal",children:[s.jsxs(Qt,{children:[s.jsx(Ht,{children:"إنشاء حالة جديدة"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"انشر منتجك واعرضه لجميع متابعيك"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[s.jsxs(T,{variant:f==="text"?"default":"ghost",onClick:()=>g("text"),className:"flex-1 rounded-none border-b-2 border-transparent data-[state=active]:border-[var(--whatsapp-primary)]","data-testid":"tab-text",children:[s.jsx(zb,{className:"w-4 h-4 ml-2"}),"نص"]}),s.jsxs(T,{variant:f==="image"?"default":"ghost",onClick:()=>g("image"),className:"flex-1 rounded-none border-b-2 border-transparent data-[state=active]:border-[var(--whatsapp-primary)]","data-testid":"tab-image",children:[s.jsx(Of,{className:"w-4 h-4 ml-2"}),"صورة"]})]}),f==="text"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"content",children:"المحتوى"}),s.jsx(qs,{id:"content",placeholder:"انشر منتجك هنا... اكتب وصف منتجك أو خدمتك",value:r,onChange:w=>a(w.target.value),className:"min-h-[100px]","data-testid":"input-story-content"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{children:"لون الخلفية"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Mj.map(w=>s.jsx("button",{onClick:()=>h(w),className:`w-8 h-8 rounded-full border-2 ${c===w?"border-gray-800 dark:border-white":"border-gray-300"}`,style:{backgroundColor:w},"data-testid":`color-bg-${w}`},w))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{children:"لون النص"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Oj.map(w=>s.jsx("button",{onClick:()=>p(w),className:`w-8 h-8 rounded-full border-2 ${u===w?"border-gray-800 dark:border-white":"border-gray-300"}`,style:{backgroundColor:w},"data-testid":`color-text-${w}`},w))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{children:"معاينة"}),s.jsx("div",{className:"w-full h-40 rounded-lg flex items-center justify-center p-4",style:{backgroundColor:c},children:s.jsx("p",{className:"text-center break-words",style:{color:u},children:r||"معاينة الحالة"})})]})]}):s.jsx(s.Fragment,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{children:"إضافة صورة أو فيديو"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs(T,{type:"button",variant:"outline",onClick:H,className:"h-24 flex-col space-y-2",disabled:m,"data-testid":"button-camera-upload",children:[s.jsx(jb,{className:"w-8 h-8"}),s.jsx("span",{className:"text-sm",children:"كاميرا"})]}),s.jsxs(T,{type:"button",variant:"outline",onClick:H,className:"h-24 flex-col space-y-2",disabled:m,"data-testid":"button-gallery-upload",children:[s.jsx(Pf,{className:"w-8 h-8"}),s.jsx("span",{className:"text-sm",children:"معرض الصور"})]})]}),s.jsx("input",{ref:v,type:"file",accept:"image/*,video/*",capture:"environment",onChange:Q,className:"hidden","data-testid":"input-file-upload"}),m&&s.jsx("div",{className:"text-center text-sm text-gray-600 dark:text-gray-400",children:"جاري رفع الملف..."})]}),s.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[s.jsx("div",{className:"flex-1 border-t border-gray-300 dark:border-gray-600"}),s.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 px-2",children:"أو"}),s.jsx("div",{className:"flex-1 border-t border-gray-300 dark:border-gray-600"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"mediaUrl",children:"رابط الصورة أو الفيديو"}),s.jsx(Ce,{id:"mediaUrl",placeholder:"https://example.com/media.jpg",value:n||o,onChange:w=>{const A=w.target.value;A.includes(".mp4")||A.includes(".mov")||A.includes(".webm")||A.includes("video")?(l(A),i("")):(i(A),l(""))},disabled:m,"data-testid":"input-media-url"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"caption",children:"تعليق (اختياري)"}),s.jsx(Ce,{id:"caption",placeholder:"انشر منتجك... اكتب وصف المنتج",value:r,onChange:w=>a(w.target.value),"data-testid":"input-image-caption"})]}),(n||o)&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{children:o?"معاينة الفيديو":"معاينة الصورة"}),s.jsx("div",{className:"w-full h-40 bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden",children:o?s.jsx("video",{src:o,className:"w-full h-full object-cover",controls:!0,muted:!0,playsInline:!0,onError:w=>{w.currentTarget.style.display="none"}}):s.jsx("img",{src:n,alt:"Preview",className:"w-full h-full object-cover",onError:w=>{w.currentTarget.style.display="none"}})})]})]})}),s.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[s.jsx(T,{variant:"outline",onClick:$,"data-testid":"button-cancel",children:"إلغاء"}),s.jsx(T,{onClick:L,disabled:!r.trim()&&!n.trim()&&!o.trim()||D.isPending||m,className:"bg-[var(--whatsapp-primary)] hover:bg-[var(--whatsapp-secondary)]","data-testid":"button-create",children:D.isPending?"جاري الإنشاء...":m?"جاري رفع الملف...":"إنشاء"})]})]})]})})}function Mp({isOpen:t,onClose:e,onStartChat:r}){const{toast:a}=lt(),[n,i]=d.useState(""),[o,l]=d.useState(!1),[c,h]=d.useState(""),[u,p]=d.useState(""),{data:f=[],isLoading:g}=ye({queryKey:["/api/contacts"],enabled:t}),j=Se({mutationFn:async y=>ce("/api/contacts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)}),onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/contacts"]}),h(""),p(""),l(!1),a({title:"تم إضافة جهة الاتصال",description:"تم إضافة جهة الاتصال بنجاح"})},onError:()=>{a({title:"خطأ",description:"فشل في إضافة جهة الاتصال",variant:"destructive"})}}),x=Se({mutationFn:async y=>ce("/api/chats/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otherUserId:y})}),onSuccess:y=>{ft.invalidateQueries({queryKey:["/api/chats"]}),r(y.chatId),e()},onError:()=>{a({title:"خطأ",description:"فشل في بدء المحادثة",variant:"destructive"})}}),m=f.filter(y=>y.name.toLowerCase().includes(n.toLowerCase())||y.phoneNumber.includes(n)),S=()=>{if(!c.trim()||!u.trim()){a({title:"خطأ",description:"يرجى ملء جميع الحقول",variant:"destructive"});return}j.mutate({name:c.trim(),phoneNumber:u.trim()})},v=y=>{var C;(C=y.user)!=null&&C.id&&x.mutate(y.user.id)};return s.jsx(Yt,{open:t,onOpenChange:e,children:s.jsxs(Kt,{className:"max-w-md max-h-[80vh] flex flex-col",children:[s.jsx(Qt,{children:s.jsxs(Ht,{className:"flex items-center justify-between",children:[s.jsx("span",{children:"جهات الاتصال"}),s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>l(!o),"data-testid":"button-add-contact",children:s.jsx(Bs,{className:"h-4 w-4"})})]})}),o&&s.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[s.jsx(Ce,{placeholder:"اسم جهة الاتصال",value:c,onChange:y=>h(y.target.value),"data-testid":"input-contact-name"}),s.jsx(Ce,{placeholder:"رقم الهاتف",value:u,onChange:y=>p(y.target.value),"data-testid":"input-contact-phone"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(T,{onClick:S,disabled:j.isPending,className:"flex-1","data-testid":"button-save-contact",children:j.isPending?"جارِ الإضافة...":"إضافة"}),s.jsx(T,{variant:"outline",onClick:()=>l(!1),"data-testid":"button-cancel-add",children:"إلغاء"})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx(Ce,{type:"text",placeholder:"البحث في جهات الاتصال",className:"pr-10",value:n,onChange:y=>i(y.target.value),"data-testid":"input-search-contacts"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:g?s.jsx("div",{className:"text-center p-4 text-gray-500 dark:text-gray-400",children:"جاري التحميل..."}):m.length===0?s.jsx("div",{className:"text-center p-4 text-gray-500 dark:text-gray-400",children:n?"لا توجد جهات اتصال مطابقة":"لا توجد جهات اتصال"}):s.jsx("div",{className:"space-y-2",children:m.map(y=>{var C,k,D;return s.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg","data-testid":`contact-item-${y.id}`,children:[s.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse flex-1",children:[s.jsxs(Ft,{className:"w-10 h-10",children:[s.jsx(Lt,{src:((C=y.user)==null?void 0:C.avatar)||void 0,alt:y.name}),s.jsx(Vt,{children:y.name[0]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:y.name}),y.isAppUser&&s.jsx(Te,{className:"bg-[var(--whatsapp-primary)] text-white text-xs",children:"في التطبيق"}),((k=y.user)==null?void 0:k.isOnline)&&y.isAppUser&&s.jsx("span",{className:"w-2 h-2 bg-[var(--whatsapp-online)] rounded-full"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:y.phoneNumber}),((D=y.user)==null?void 0:D.location)&&s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:y.user.location})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>window.open(`tel:${y.phoneNumber}`,"_self"),"data-testid":"button-call-contact",children:s.jsx(Es,{className:"h-4 w-4"})}),y.isAppUser&&y.user&&s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>v(y),disabled:x.isPending,"data-testid":"button-message-contact",children:s.jsx(fn,{className:"h-4 w-4"})})]})]},y.id)})})})]})})}function Dj({selectedChatId:t,onChatSelect:e,isVisible:r,onToggle:a}){var te;const{theme:n,setTheme:i}=Zw(),{toast:o}=lt(),[l,c]=d.useState(""),[h,u]=d.useState(null),[p,f]=d.useState(!1),[g,j]=d.useState(!1),[x,m]=d.useState(!1),[S,v]=d.useState(null),y=d.useRef(null),{data:C}=ye({queryKey:["/api/user/current"]}),{data:k=[],isLoading:D}=ye({queryKey:["/api/chats"],refetchInterval:5e3,refetchIntervalInBackground:!1,refetchOnWindowFocus:!0}),Q=Se({mutationFn:async q=>ce(`/api/chats/${q}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/chats"]}),m(!1),v(null),t===(S==null?void 0:S.id)&&e(""),o({title:"تم حذف المحادثة",description:"تم حذف المحادثة وجميع رسائلها بنجاح"})},onError:()=>{o({title:"خطأ",description:"فشل في حذف المحادثة",variant:"destructive"})}}),H=()=>{i(n==="dark"?"light":"dark")},M=q=>{const ge=new Date(q),Ke=Math.abs(new Date().getTime()-ge.getTime())/(1e3*60*60);return Ke<24?ge.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}):Ke<168?ge.toLocaleDateString("ar-SA",{weekday:"long"}):ge.toLocaleDateString("ar-SA")},L=q=>q.lastMessage?q.lastMessage.messageType==="image"?"📷 صورة":q.lastMessage.content:"لا توجد رسائل",$=q=>{var ge;return q.isGroup?q.name||"مجموعة":((ge=q.otherParticipant)==null?void 0:ge.name)||"مستخدم"},w=q=>{var ge;return q.isGroup?q.avatar:(ge=q.otherParticipant)==null?void 0:ge.avatar},A=q=>{var ge;return q.isGroup?!1:((ge=q.otherParticipant)==null?void 0:ge.isOnline)||!1},I=k.filter(q=>$(q).toLowerCase().includes(l.toLowerCase())),K=q=>{y.current=setTimeout(()=>{v(q),m(!0)},800)},E=()=>{y.current&&(clearTimeout(y.current),y.current=null)},U=()=>{S&&Q.mutate(S.id)};return r?s.jsxs("div",{className:"w-full sm:w-96 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col h-full",children:[s.jsxs("div",{className:"bg-[var(--whatsapp-secondary)] dark:bg-gray-700 p-4 flex items-center justify-between",children:[s.jsxs(Ft,{className:"w-10 h-10 border-2 border-white","data-testid":"user-avatar",children:[s.jsx(Lt,{src:C==null?void 0:C.avatar,alt:(C==null?void 0:C.name)||"المستخدم"}),s.jsx(Vt,{children:((te=C==null?void 0:C.name)==null?void 0:te[0])||"أ"})]}),s.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[s.jsx(T,{variant:"ghost",size:"icon",onClick:H,className:"text-white hover:text-gray-200 hover:bg-white/10","data-testid":"button-theme-toggle",children:n==="dark"?s.jsx(Vb,{className:"h-5 w-5"}):s.jsx(Rb,{className:"h-5 w-5"})}),s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>j(!0),className:"text-white hover:text-gray-200 hover:bg-white/10","data-testid":"button-contacts",children:s.jsx(pr,{className:"h-5 w-5"})}),s.jsx(T,{variant:"ghost",size:"icon",className:"text-white hover:text-gray-200 hover:bg-white/10","data-testid":"button-new-chat",children:s.jsx(Cs,{className:"h-5 w-5"})}),s.jsxs(pp,{children:[s.jsx(gp,{asChild:!0,children:s.jsx(T,{variant:"ghost",size:"icon",className:"text-white hover:text-gray-200 hover:bg-white/10","data-testid":"button-menu",children:s.jsx(zo,{className:"h-5 w-5"})})}),s.jsx(Zo,{align:"end",className:"w-48",children:s.jsx(jt,{href:"/profile",children:s.jsxs(Va,{className:"flex items-center gap-2 cursor-pointer","data-testid":"menu-profile",children:[s.jsx(_s,{className:"h-4 w-4"}),s.jsx("span",{children:"الملف الشخصي"})]})})})]})]})]}),s.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:s.jsxs("div",{className:"relative",children:[s.jsx(cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx(Ce,{type:"text",placeholder:"البحث أو بدء محادثة جديدة",className:"w-full bg-white dark:bg-gray-600 border border-gray-200 dark:border-gray-500 rounded-lg py-2 pr-10 pl-4 focus:border-[var(--whatsapp-primary)]",value:l,onChange:q=>c(q.target.value),"data-testid":"input-search"})]})}),s.jsx(mj,{onStoryClick:q=>u(q),onCreateStory:()=>f(!0)}),s.jsx("div",{className:"flex-1 overflow-y-auto chat-scroll",children:D?s.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"جاري التحميل..."}):I.length===0?s.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:l?"لا توجد محادثات مطابقة":"لا توجد محادثات"}):I.map(q=>{var ge;return s.jsxs("div",{className:`p-4 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors flex items-center border-b border-gray-100 dark:border-gray-700 ${t===q.id?"bg-[var(--whatsapp-light)] dark:bg-gray-600 border-r-4 border-[var(--whatsapp-primary)]":""}`,onClick:()=>{e(q.id),window.innerWidth<640&&a()},onMouseDown:()=>K(q),onMouseUp:E,onMouseLeave:E,onTouchStart:()=>K(q),onTouchEnd:E,onTouchCancel:E,"data-testid":`chat-item-${q.id}`,children:[s.jsxs("div",{className:"relative ml-3",children:[s.jsxs(Ft,{className:"w-12 h-12",children:[s.jsx(Lt,{src:w(q)||void 0,alt:$(q)}),s.jsx(Vt,{children:$(q)[0]})]}),A(q)&&s.jsx("span",{className:"absolute -bottom-1 -left-1 w-4 h-4 bg-[var(--whatsapp-online)] rounded-full border-2 border-white dark:border-gray-800","data-testid":"status-online"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100","data-testid":"chat-name",children:$(q)}),!q.isGroup&&((ge=q.otherParticipant)==null?void 0:ge.isVerified)&&s.jsx(ga,{className:"w-3.5 h-3.5"})]}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400","data-testid":"chat-time",children:q.lastMessage?M(q.lastMessage.timestamp):""})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 truncate","data-testid":"chat-preview",children:L(q)}),s.jsx("div",{className:"flex items-center",children:q.unreadCount>0&&s.jsx(Te,{className:"bg-[var(--whatsapp-primary)] text-white rounded-full min-w-[20px] h-5 flex items-center justify-center text-xs mr-1","data-testid":"unread-count",children:q.unreadCount})})]})]})]},q.id)})}),h&&s.jsx(Ej,{storyId:h,onClose:()=>u(null)}),s.jsx(Rp,{isOpen:p,onClose:()=>f(!1)}),s.jsx(Mp,{isOpen:g,onClose:()=>j(!1),onStartChat:q=>{e(q),j(!1)}}),s.jsx(Yt,{open:x,onOpenChange:m,children:s.jsxs(Kt,{children:[s.jsxs(Qt,{children:[s.jsxs(Ht,{className:"flex items-center gap-2",children:[s.jsx(Bo,{className:"w-5 h-5 text-red-500"}),"حذف المحادثة"]}),s.jsxs(Fn,{children:["هل أنت متأكد من رغبتك في حذف المحادثة مع"," ",s.jsx("span",{className:"font-semibold",children:S?$(S):""}),"؟",s.jsx("br",{}),s.jsx("span",{className:"text-red-600",children:"سيتم حذف جميع الرسائل ولا يمكن التراجع عن هذا الإجراء."})]})]}),s.jsxs(fp,{children:[s.jsx(T,{variant:"outline",onClick:()=>m(!1),disabled:Q.isPending,children:"إلغاء"}),s.jsx(T,{variant:"destructive",onClick:U,disabled:Q.isPending,className:"bg-red-500 hover:bg-red-600",children:Q.isPending?"جارِ الحذف...":"حذف المحادثة"})]})]})})]}):null}function Fj({message:t,isOwn:e,onReply:r,onEdit:a,onDelete:n}){var m,S;const[i,o]=d.useState(!1),[l,c]=d.useState(0),[h,u]=d.useState(0),p=d.useRef(null),f=v=>v?new Date(v).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",hour12:!1}):"",g=v=>{const y=Math.floor(v/60),C=Math.floor(v%60);return`${y}:${C.toString().padStart(2,"0")}`},j=()=>{p.current&&(i?p.current.pause():p.current.play(),o(!i))};d.useEffect(()=>{const v=p.current;if(!v)return;const y=()=>c(v.currentTime),C=()=>u(v.duration),k=()=>o(!1);return v.addEventListener("timeupdate",y),v.addEventListener("loadedmetadata",C),v.addEventListener("ended",k),()=>{v.removeEventListener("timeupdate",y),v.removeEventListener("loadedmetadata",C),v.removeEventListener("ended",k)}},[]);const x=()=>e?t.isRead?s.jsx(Ol,{className:"w-3 h-3 text-blue-500","data-testid":"status-read"}):t.isDelivered?s.jsx(Ol,{className:"w-3 h-3 text-gray-400","data-testid":"status-delivered"}):s.jsx(Gs,{className:"w-3 h-3 text-gray-400","data-testid":"status-sent"}):null;return s.jsx("div",{className:`mb-4 flex message-bubble group ${e?"justify-end":""}`,children:s.jsxs("div",{className:"max-w-xs lg:max-w-md relative",children:[s.jsxs("div",{className:`rounded-lg p-3 shadow-md ${e?"bg-[var(--whatsapp-light)] dark:bg-[var(--whatsapp-secondary)] rounded-tl-none":"bg-white dark:bg-gray-700 rounded-tr-none"}`,"data-testid":`message-${t.id}`,children:[t.replyTo&&s.jsxs("div",{className:"mb-2 p-2 bg-gray-100 dark:bg-gray-600 rounded border-l-4 border-[var(--whatsapp-primary)]",children:[s.jsxs("div",{className:"text-xs font-medium text-[var(--whatsapp-primary)] mb-1 flex items-center gap-1",children:[s.jsx("span",{children:((m=t.replyTo.sender)==null?void 0:m.name)||"رسالة محذوفة"}),((S=t.replyTo.sender)==null?void 0:S.isVerified)&&s.jsx(ga,{className:"w-3 h-3"})]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",children:t.replyTo.content})]}),t.messageType==="image"&&t.imageUrl&&s.jsx("img",{src:t.imageUrl,alt:"Message image",className:"w-full rounded-lg object-cover mb-2","data-testid":"message-image"}),t.messageType==="audio"&&t.audioUrl&&s.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse p-2 bg-gray-50 dark:bg-gray-600 rounded-lg",children:[s.jsx(T,{onClick:j,size:"sm",variant:"ghost",className:"p-2 rounded-full bg-[var(--whatsapp-primary)] text-white hover:bg-[var(--whatsapp-secondary)]","data-testid":"button-audio-play",children:i?s.jsx($o,{className:"h-4 w-4"}):s.jsx(qo,{className:"h-4 w-4"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 dark:text-gray-300",children:[s.jsx("span",{children:"رسالة صوتية"}),s.jsx("span",{children:g(h||0)})]}),s.jsx("div",{className:"w-full bg-gray-300 dark:bg-gray-400 rounded-full h-1 mt-1",children:s.jsx("div",{className:"bg-[var(--whatsapp-primary)] h-1 rounded-full transition-all duration-100",style:{width:`${h>0?l/h*100:0}%`}})})]}),s.jsx("audio",{ref:p,src:t.audioUrl,onEnded:()=>o(!1),"data-testid":"audio-player"})]}),t.messageType==="sticker"&&t.stickerUrl&&s.jsx("div",{className:"flex justify-center items-center p-2","data-testid":"message-sticker",children:s.jsx("span",{className:"text-6xl select-none",style:{fontSize:"4rem",lineHeight:"1"},children:t.stickerUrl})}),t.messageType==="text"&&t.content&&s.jsx("p",{className:"text-gray-800 dark:text-gray-200 break-words","data-testid":"message-content",children:t.content}),s.jsx("div",{className:"flex items-center justify-between mt-1",children:s.jsxs("div",{className:"flex items-center gap-1",children:[x(),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400","data-testid":"message-time",children:f(t.timestamp)})]})})]}),s.jsx("div",{className:"absolute top-0 left-0 -ml-10 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsxs(pp,{children:[s.jsx(gp,{asChild:!0,children:s.jsx(T,{variant:"ghost",size:"sm",className:"p-1 h-6 w-6",children:s.jsx(zo,{className:"h-3 w-3"})})}),s.jsxs(Zo,{align:"start",children:[r&&s.jsxs(Va,{onClick:()=>r(t),children:[s.jsx(Db,{className:"h-4 w-4 ml-2"}),"رد"]}),e&&a&&s.jsx(Va,{onClick:()=>a(t),children:"تحرير"}),e&&n&&s.jsx(Va,{onClick:()=>n(t.id),className:"text-red-600",children:"حذف"})]})]})})]})})}const Lj=t=>{t&&Ye(()=>{t.getTracks().forEach(e=>{Ye(()=>e.stop(),"Media track stop warning")})},"Media stream cleanup warning")};function Vj({chatId:t,onToggleSidebar:e}){var B,V,ee,_e,He;const[r,a]=d.useState(""),[n,i]=d.useState(!1),[o,l]=d.useState(""),[c,h]=d.useState([]),[u,p]=d.useState(!1),[f,g]=d.useState(null),[j,x]=d.useState(!1),[m,S]=d.useState(0),[v,y]=d.useState(!1),[C,k]=d.useState(!1),[D,Q]=d.useState(!1),H=d.useRef(null),M=d.useRef(null),L=d.useRef([]),$=d.useRef(null),w=d.useRef(null),A=d.useRef(null),I=d.useRef(null),K=d.useRef(null),E=vs(),{data:U}=ye({queryKey:["/api/user/current"]}),{data:te=[],isLoading:q,isSuccess:ge}=ye({queryKey:["/api/chats",t,"messages"],enabled:!!t,refetchInterval:3e3,refetchIntervalInBackground:!1,refetchOnWindowFocus:!0}),{data:Me=[]}=ye({queryKey:["/api/chats"]}),{data:Ke=[]}=ye({queryKey:["/api/stickers"]}),Qe=Se({mutationFn:async O=>{if(!t)throw console.error("لا يوجد محادثة محددة لإرسال الرسالة"),new Error("No chat selected");console.log("إرسال رسالة إلى:",t,"المحتوى:",O);const he=await ce(`/api/chats/${t}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:O.trim(),messageType:"text",replyToId:(f==null?void 0:f.id)||null})});return console.log("تم إرسال الرسالة بنجاح:",he),he},onSuccess:O=>{console.log("تحديث قائمة الرسائل..."),E.invalidateQueries({queryKey:["/api/chats",t,"messages"]}),E.invalidateQueries({queryKey:["/api/chats"]}),a(""),g(null)},onError:O=>{console.error("خطأ في إرسال الرسالة:",O)}}),ut=Se({mutationFn:async({messageId:O,content:he})=>ce(`/api/messages/${O}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:he})}),onSuccess:()=>{E.invalidateQueries({queryKey:["/api/chats",t,"messages"]})}}),St=Se({mutationFn:async O=>ce(`/api/messages/${O}`,{method:"DELETE"}),onSuccess:()=>{E.invalidateQueries({queryKey:["/api/chats",t,"messages"]})}});d.useEffect(()=>{w.current=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjibzvPfiTcIG2m98OScTQwNUarm7blsGws5n9P1vmocBjiAyfTakTsIGGm98OScTQwNUarm7bhkHA="),w.current.volume=.5},[]),d.useEffect(()=>{var O;ge&&te.length>0&&te.filter(Ee=>!Ee.isRead&&Ee.senderId!==(U==null?void 0:U.id)).length>0&&((O=w.current)==null||O.play().catch(Ee=>console.log("Cannot play notification sound:",Ee)))},[te,ge,U]),d.useEffect(()=>{t&&te.length>0&&U&&te.filter(he=>!he.isRead&&he.senderId!==(U==null?void 0:U.id)).forEach(he=>{fetch(`/api/messages/${he.id}/read`,{method:"PATCH",headers:{"Content-Type":"application/json"}}).catch(Ee=>console.log("Failed to mark message as read:",Ee))})},[t,te,U]);const ss=async()=>{if(I.current)return I.current;if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("MediaRecorder not supported");k(!0);try{const O=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:16e3,channelCount:1}});return I.current=O,O}finally{k(!1)}},ue=async O=>{if(K.current&&clearTimeout(K.current),!(j||C)){console.log("Starting recording...");try{const he="touches"in O?O.touches[0].clientX:O.clientX,Ee="touches"in O?O.touches[0].clientY:O.clientY;A.current={x:he,y:Ee},console.log("Initializing microphone...");const Wt=await ss();console.log("Microphone ready, creating MediaRecorder...");let $t="";const Ur=["audio/webm;codecs=opus","audio/webm","audio/mp4","audio/wav"];for(const _t of Ur)if(MediaRecorder.isTypeSupported(_t)){$t=_t;break}console.log("Using MIME type:",$t||"default"),M.current=new MediaRecorder(Wt,$t?{mimeType:$t}:void 0),L.current=[],M.current.ondataavailable=_t=>{_t.data.size>0&&L.current.push(_t.data)},M.current.onstop=()=>{if(console.log("Recording stopped. Chunks:",L.current.length),!v&&L.current.length>0){const _t=new Blob(L.current,{type:$t||"audio/webm"});console.log("Audio blob created:",_t.size,"bytes"),$e(_t)}y(!1)},M.current.onerror=_t=>{console.error("MediaRecorder error:",_t),x(!1)},M.current.start(500),x(!0),S(0),y(!1),$.current=setInterval(()=>{S(_t=>_t+1)},1e3),console.log("Recording started successfully")}catch(he){console.error("Error starting recording:",he),x(!1),k(!1);const Ee=he;Ee.name==="NotAllowedError"?alert("يرجى السماح بالوصول للميكروفون في إعدادات المتصفح."):Ee.name==="NotFoundError"?alert("لم يتم العثور على ميكروفون. تأكد من توصيل ميكروفون بالجهاز."):alert("خطأ في بدء التسجيل: "+(Ee.message||"خطأ غير معروف"))}}},ze=()=>{M.current&&j&&(M.current.stop(),x(!1),S(0),$.current&&(clearInterval($.current),$.current=null))},Ge=O=>{if(!j||!A.current)return;const he="touches"in O?O.touches[0].clientX:O.clientX,$t=A.current.x-he>80;$t!==v&&y($t)},$e=async O=>{if(t){console.log("Sending audio message...",O.size,"bytes");try{const he=new FormData;let Ee="voice-message.webm";O.type.includes("mp4")?Ee="voice-message.mp4":O.type.includes("wav")&&(Ee="voice-message.wav"),he.append("audio",O,Ee),he.append("messageType","audio"),he.append("chatId",t),f!=null&&f.id&&he.append("replyToId",f.id),console.log("Sending FormData with file:",Ee);const Wt=await ce(`/api/chats/${t}/messages/audio`,{method:"POST",body:he});console.log("Audio message sent successfully"),E.invalidateQueries({queryKey:["/api/chats",t,"messages"]}),E.invalidateQueries({queryKey:["/api/chats"]}),g(null)}catch(he){console.error("Error sending audio message:",he),alert("فشل في إرسال الرسالة الصوتية: "+(he.message||"خطأ غير معروف"))}}},Ve=O=>{const he=Math.floor(O/60),Ee=O%60;return`${he}:${Ee.toString().padStart(2,"0")}`},Oe=async O=>{if(t)try{console.log("إرسال ملصق:",O.name);const he=await ce(`/api/chats/${t}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:O.name,messageType:"sticker",stickerUrl:O.imageUrl,replyToId:(f==null?void 0:f.id)||null})});console.log("تم إرسال الملصق بنجاح:",he),E.invalidateQueries({queryKey:["/api/chats",t,"messages"]}),E.invalidateQueries({queryKey:["/api/chats"]}),g(null),Q(!1)}catch(he){console.error("خطأ في إرسال الملصق:",he)}},Zt=()=>{var O;(O=H.current)==null||O.scrollIntoView({behavior:"smooth"})};d.useEffect(()=>{Zt()},[te]),d.useEffect(()=>{if(!j)return;const O=Ti=>{ms(Ge,Ti)},he=Ti=>{ms(Ge,Ti)},Ee=()=>{ms(ze)},Wt=()=>{ms(ze)},$t=Nn(window,"mousemove",O,{passive:!0}),Ur=Nn(window,"touchmove",he,{passive:!0}),_t=Nn(window,"mouseup",Ee),vn=Nn(window,"touchend",Wt);return Ul([$t,Ur,_t,vn])},[j,Ge,ze]),d.useEffect(()=>Ul([()=>Lj(I.current),()=>{K.current&&(clearTimeout(K.current),K.current=null)},()=>{$.current&&(clearInterval($.current),$.current=null)}]),[]);const ie=()=>{const O=r.trim();if(!O){console.log("الرسالة فارغة، لا يمكن الإرسال");return}if(!t){console.error("لا يوجد معرف محادثة");return}console.log("بدء إرسال الرسالة:",O),Qe.mutate(O)},pe=O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),ie())},We=async O=>{if(!t||!O.trim()){h([]);return}p(!0);try{const he=await ce(`/api/chats/${t}/messages/search?q=${encodeURIComponent(O.trim())}`);h(he)}catch(he){console.error("فشل في البحث:",he),h([])}finally{p(!1)}},st=()=>{i(!0),l(""),h([])},kt=O=>{g(O)},Be=O=>{const he=prompt("تحرير الرسالة:",O.content||"");he&&he.trim()!==O.content&&ut.mutate({messageId:O.id,content:he.trim()})},Ct=O=>{confirm("هل أنت متأكد من حذف هذه الرسالة؟")&&St.mutate(O)},Rs=()=>{g(null)};if(!t)return s.jsx("div",{className:"flex-1 flex-col items-center justify-center bg-gray-50 dark:bg-gray-900 text-center hidden lg:flex",children:s.jsxs("div",{className:"max-w-md",children:[s.jsx("h2",{className:"text-2xl font-light text-gray-800 dark:text-gray-200 mb-4",children:"BizChat"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"منصة التواصل التجاري الذكية - تواصل مع عملائك وأنجز صفقاتك."}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md",children:s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"اختر محادثة من القائمة الجانبية للبدء في المراسلة"})})]})});const b=Me.find(O=>O.id===t),P=b!=null&&b.isGroup?b.name||"مجموعة":((B=b==null?void 0:b.otherParticipant)==null?void 0:B.name)||"مستخدم",R=b!=null&&b.isGroup?b.avatar:(V=b==null?void 0:b.otherParticipant)==null?void 0:V.avatar,Z=b!=null&&b.isGroup?!1:(ee=b==null?void 0:b.otherParticipant)==null?void 0:ee.isOnline;return s.jsxs("div",{className:"flex-1 flex flex-col bg-gray-50 dark:bg-gray-900",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between shadow-sm",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(T,{variant:"ghost",size:"icon",onClick:e,className:"sm:hidden ml-3 text-gray-600 dark:text-gray-300 mobile-touch-target","data-testid":"button-toggle-sidebar",children:s.jsx(wb,{className:"h-5 w-5"})}),s.jsxs("div",{className:"relative ml-3",children:[s.jsxs(Ft,{className:"w-10 h-10",children:[s.jsx(Lt,{src:R||void 0,alt:P}),s.jsx(Vt,{children:P[0]})]}),Z&&s.jsx("span",{className:"absolute -bottom-1 -left-1 w-3 h-3 bg-[var(--whatsapp-online)] rounded-full border-2 border-white dark:border-gray-800","data-testid":"status-online"})]}),s.jsxs("div",{className:"mr-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h2",{className:"font-medium text-gray-900 dark:text-gray-100","data-testid":"chat-header-name",children:P}),!(b!=null&&b.isGroup)&&((_e=b==null?void 0:b.otherParticipant)==null?void 0:_e.isVerified)&&s.jsx(ga,{className:"w-4 h-4"})]}),s.jsx("p",{className:"text-sm text-[var(--whatsapp-online)]","data-testid":"chat-status",children:Z?"متصل":"آخر ظهور مؤخراً"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 space-x-reverse",children:[s.jsx(T,{variant:"ghost",size:"icon",onClick:st,className:"text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100 mobile-touch-target hidden sm:flex","data-testid":"button-search",children:s.jsx(cr,{className:"h-5 w-5"})}),s.jsx(T,{variant:"ghost",size:"icon",className:"text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100 mobile-touch-target","data-testid":"button-call",children:s.jsx(Es,{className:"h-5 w-5"})}),s.jsx(T,{variant:"ghost",size:"icon",className:"text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100 mobile-touch-target hidden sm:flex","data-testid":"button-video-call",children:s.jsx(qb,{className:"h-5 w-5"})}),s.jsx(T,{variant:"ghost",size:"icon",className:"text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100 mobile-touch-target","data-testid":"button-menu",children:s.jsx(zo,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto chat-scroll p-3 sm:p-4 bg-gradient-to-b from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",style:{backgroundImage:`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'><defs><pattern id='grain' width='100' height='100' patternUnits='userSpaceOnUse'><circle cx='25' cy='25' r='1' fill='%23f3f4f6' opacity='0.1'/><circle cx='75' cy='75' r='1' fill='%23f3f4f6' opacity='0.1'/><circle cx='50' cy='10' r='0.5' fill='%23f3f4f6' opacity='0.05'/></pattern></defs><rect width='100' height='100' fill='url(%23grain)'/></svg>")`},"data-testid":"messages-container",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("div",{className:"bg-white dark:bg-gray-600 px-3 py-1 rounded-lg shadow-sm",children:s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-300",children:"اليوم"})})}),q?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"جاري تحميل الرسائل..."})}):te.length===0?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"لا توجد رسائل بعد"})}):te.map(O=>s.jsx(Fj,{message:O,isOwn:O.senderId===(U==null?void 0:U.id),onReply:kt,onEdit:Be,onDelete:Ct},O.id)),s.jsx("div",{ref:H})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-3 sm:p-4",children:[f&&s.jsx("div",{className:"mb-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg border-l-4 border-[var(--whatsapp-primary)]",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"text-sm font-medium text-[var(--whatsapp-primary)] mb-1",children:["رد على ",((He=f.sender)==null?void 0:He.name)||"غير معروف"]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",children:f.content})]}),s.jsx(T,{variant:"ghost",size:"sm",onClick:Rs,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:s.jsx(dr,{className:"h-4 w-4"})})]})}),s.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 space-x-reverse",children:[s.jsx(T,{variant:"ghost",size:"icon",className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 mobile-touch-target","data-testid":"button-emoji",children:s.jsx(Fb,{className:"h-5 w-5"})}),s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>Q(!D),className:`mobile-touch-target ${D?"text-[var(--whatsapp-primary)] bg-[var(--whatsapp-primary)]/10":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,"data-testid":"button-stickers",children:s.jsx("span",{className:"text-lg",children:"😊"})}),s.jsx(T,{variant:"ghost",size:"icon",className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 mobile-touch-target","data-testid":"button-attach",children:s.jsx(Ob,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex-1 relative",children:[j&&s.jsx("div",{className:`absolute -top-12 left-0 right-0 p-2 rounded-lg text-center transition-colors duration-200 ${v?"bg-gray-500":"bg-red-500"} text-white`,children:s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),s.jsx("span",{className:"text-sm",children:v?"اسحب لليمين للإلغاء":`تسجيل... ${Ve(m)}`})]})}),s.jsx(Ce,{type:"text",placeholder:C?"جاري تجهيز الميكروفون...":j?"جاري التسجيل...":"اكتب رسالة...",className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-full py-2 sm:py-3 px-4 sm:px-5 focus:border-[var(--whatsapp-primary)] focus:bg-white dark:focus:bg-gray-600 text-base",value:r,onChange:O=>a(O.target.value),onKeyPress:pe,disabled:Qe.isPending||j||C,"data-testid":"input-message"})]}),r.trim()?s.jsx(T,{onClick:ie,disabled:Qe.isPending,className:"bg-[var(--whatsapp-primary)] hover:bg-[var(--whatsapp-secondary)] text-white p-2 sm:p-3 rounded-full shadow-lg mobile-touch-target transition-all duration-200",size:"icon","data-testid":"button-send",children:s.jsx(Uo,{className:"h-5 w-5"})}):s.jsx(T,{variant:"ghost",size:"icon",onMouseDown:O=>{O.preventDefault(),K.current=setTimeout(()=>{ue(O)},50)},onTouchStart:O=>{O.preventDefault(),K.current=setTimeout(()=>{ue(O)},50)},disabled:C,className:`mobile-touch-target rounded-full transition-all duration-150 ${j?v?"bg-gray-500 text-white hover:bg-gray-600":"bg-red-500 text-white hover:bg-red-600 animate-pulse":C?"bg-blue-500 text-white opacity-75":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 bg-gray-100 dark:bg-gray-600 hover:scale-105"}`,"data-testid":"button-voice",children:C?s.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"}):j?v?s.jsx(dr,{className:"h-5 w-5"}):s.jsx(Lb,{className:"h-5 w-5"}):s.jsx(Eb,{className:"h-5 w-5"})})]}),D&&s.jsx("div",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-4 max-h-64 overflow-y-auto",children:s.jsxs("div",{className:"mb-3",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"الملصقات"}),s.jsx("div",{className:"grid grid-cols-6 gap-2",children:Ke.map(O=>s.jsx("button",{onClick:()=>Oe(O),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 text-3xl flex items-center justify-center",title:O.name,"data-testid":`sticker-${O.id}`,children:O.imageUrl},O.id))}),Ke.length===0&&s.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"لا توجد ملصقات متاحة"})]})})]}),s.jsx(Yt,{open:n,onOpenChange:i,children:s.jsxs(Kt,{className:"max-w-md",children:[s.jsx(Qt,{children:s.jsx(Ht,{className:"text-right",children:"البحث في الرسائل"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Ce,{type:"text",placeholder:"ابحث في المحادثة...",value:o,onChange:O=>{l(O.target.value),We(O.target.value)},className:"w-full text-right","data-testid":"input-search"}),s.jsx(cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:u?s.jsx("div",{className:"text-center py-4 text-gray-500",children:"جار البحث..."}):c.length>0?s.jsx("div",{className:"space-y-3",children:c.map(O=>{var he;return s.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700","data-testid":`search-result-${O.id}`,children:[s.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:((he=O.sender)==null?void 0:he.name)||"غير معروف"}),s.jsx("div",{className:"text-gray-700 dark:text-gray-300 text-right",children:O.content}),s.jsx("div",{className:"text-xs text-gray-500 mt-1 text-right",children:O.timestamp?new Date(O.timestamp).toLocaleString("ar-SA"):""})]},O.id)})}):o?s.jsx("div",{className:"text-center py-4 text-gray-500",children:"لم يتم العثور على نتائج"}):s.jsx("div",{className:"text-center py-4 text-gray-500",children:"اكتب للبحث في الرسائل"})})]})]})})]})}function zj({onNewChat:t,onShowContacts:e,onNewMessage:r}){const[a,n]=d.useState(!1),i=()=>{n(!a)};return s.jsxs("div",{className:"fixed bottom-20 left-4 z-50 flex flex-col-reverse items-center space-y-reverse space-y-4",children:[s.jsxs("div",{className:se("flex flex-col-reverse space-y-reverse space-y-4 transition-all duration-300 transform",a?"translate-y-0 opacity-100 scale-100":"translate-y-8 opacity-0 scale-95 pointer-events-none"),children:[s.jsx(T,{onClick:()=>{r(),n(!1)},className:"w-14 h-14 rounded-full bg-blue-500 hover:bg-blue-600 active:bg-blue-700 shadow-xl transition-transform active:scale-95 touch-none","data-testid":"fab-new-message",children:s.jsx(Ef,{className:"h-5 w-5 text-white"})}),s.jsx(T,{onClick:()=>{e(),n(!1)},className:"w-14 h-14 rounded-full bg-orange-500 hover:bg-orange-600 active:bg-orange-700 shadow-xl transition-transform active:scale-95 touch-none","data-testid":"fab-contacts",children:s.jsx(pr,{className:"h-5 w-5 text-white"})}),s.jsx(T,{onClick:()=>{t(),n(!1)},className:"w-14 h-14 rounded-full bg-purple-500 hover:bg-purple-600 active:bg-purple-700 shadow-xl transition-transform active:scale-95 touch-none","data-testid":"fab-new-chat",children:s.jsx(Cs,{className:"h-5 w-5 text-white"})})]}),s.jsx(T,{onClick:i,className:se("w-16 h-16 rounded-full bg-[var(--whatsapp-primary)] hover:bg-[var(--whatsapp-primary)]/90 active:bg-[var(--whatsapp-primary)]/80 shadow-xl transition-all duration-300 active:scale-95 touch-none",a&&"rotate-45"),"data-testid":"main-fab",children:s.jsx(Bs,{className:"h-6 w-6 text-white"})}),a&&s.jsx("div",{className:"fixed inset-0 bg-black/30 -z-10",onClick:()=>n(!1),"data-testid":"fab-backdrop"})]})}const Di=640;function $j(){const[t,e]=d.useState(void 0);return d.useEffect(()=>{const r=window.matchMedia(`(max-width: ${Di-1}px)`),a=()=>{e(window.innerWidth<Di)};return r.addEventListener("change",a),e(window.innerWidth<Di),()=>r.removeEventListener("change",a)},[]),!!t}function Bl(){const[,t]=Um("/chat/:chatId"),[e,r]=d.useState((t==null?void 0:t.chatId)||"chat-sarah"),[a,n]=d.useState(!0),[i,o]=d.useState(!1),l=$j();d.useEffect(()=>{t!=null&&t.chatId&&(r(t.chatId),l&&n(!1))},[t==null?void 0:t.chatId,l]);const c=()=>{n(!a)},h=g=>{r(g),l&&n(!1)},u=()=>{o(!0)},p=()=>{n(!0)},f=()=>{n(!0)};return s.jsxs("div",{className:"flex h-[100dvh] w-full bg-white dark:bg-gray-800 pb-20",children:[l&&a&&e&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:c}),s.jsx("div",{className:`${l?a?"fixed inset-y-0 right-0 z-50 w-full h-[100dvh]":"hidden":a?"block":"hidden"}`,children:s.jsx(Dj,{selectedChatId:e,onChatSelect:h,isVisible:!0,onToggle:c})}),s.jsx("div",{className:`flex-1 ${l&&a?"hidden":"flex"}`,children:s.jsx(Vj,{chatId:e,onToggleSidebar:c})}),a&&s.jsx(zj,{onNewChat:p,onShowContacts:u,onNewMessage:f}),s.jsx(Mp,{isOpen:i,onClose:()=>o(!1),onStartChat:g=>{h(g),o(!1)}})]})}function qj(){var I,K;const[t,e]=d.useState(0),[r,a]=d.useState(!1),[n,i]=d.useState(!0),[o,l]=d.useState(!0),[c,h]=d.useState(!1),[u,p]=d.useState(""),[f,g]=d.useState({});d.useRef([]);const j=d.useRef(null),{data:x=[],isLoading:m}=ye({queryKey:["/api/stories"]});ye({queryKey:["/api/user/current"]});const S=[{id:"1",userId:"user1",content:"أحدث منتجاتنا من الملابس الشتوية",imageUrl:"https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=400&h=700&fit=crop",videoUrl:"",backgroundColor:"#075e54",textColor:"#ffffff",location:"الرياض",timestamp:new Date,expiresAt:new Date(Date.now()+24*60*60*1e3),viewCount:"156",viewers:[],user:{id:"user1",name:"متجر الأناقة",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face",phoneNumber:"+966501234567",location:"الرياض",isOnline:!0,isVerified:!0,verifiedAt:new Date,isAdmin:!1,lastSeen:new Date,createdAt:new Date,updatedAt:new Date}},{id:"1.5",userId:"user1.5",content:"فيديو تعريفي بمنتجاتنا الجديدة",imageUrl:"",videoUrl:"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",backgroundColor:"#25D366",textColor:"#ffffff",location:"الرياض",timestamp:new Date,expiresAt:new Date(Date.now()+24*60*60*1e3),viewCount:"89",viewers:[],user:{id:"user1.5",name:"استديو الإبداع",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop&crop=face",phoneNumber:"+966507654321",location:"الرياض",isOnline:!0,isVerified:!0,verifiedAt:new Date,isAdmin:!1,lastSeen:new Date,createdAt:new Date,updatedAt:new Date}},{id:"2",userId:"user2",content:"طعام طازج وصحي - جربوا أطباقنا الجديدة",imageUrl:"https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=400&h=700&fit=crop",videoUrl:"",backgroundColor:"#25D366",textColor:"#ffffff",location:"جدة",timestamp:new Date,expiresAt:new Date(Date.now()+24*60*60*1e3),viewCount:"89",viewers:[],user:{id:"user2",name:"مطعم البركة",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop&crop=face",phoneNumber:"+966507654321",location:"جدة",isOnline:!1,isVerified:!0,verifiedAt:new Date,isAdmin:!1,lastSeen:new Date(Date.now()-5*60*1e3),createdAt:new Date,updatedAt:new Date}},{id:"3",userId:"user3",content:"عروض خاصة على الإلكترونيات - خصم 50%",imageUrl:"https://images.unsplash.com/photo-1468495244123-6c6c332eeece?w=400&h=700&fit=crop",videoUrl:"",backgroundColor:"#34B7F1",textColor:"#ffffff",location:"الدمام",timestamp:new Date,expiresAt:new Date(Date.now()+24*60*60*1e3),viewCount:"234",viewers:[],user:{id:"user3",name:"متجر التقنية",avatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=100&h=100&fit=crop&crop=face",phoneNumber:"+966502345678",location:"الدمام",isOnline:!0,isVerified:!1,verifiedAt:null,isAdmin:!1,lastSeen:new Date,createdAt:new Date,updatedAt:new Date}},{id:"4",userId:"user4",content:"منتجات طبيعية للعناية بالبشرة",imageUrl:"https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=700&fit=crop",videoUrl:"",backgroundColor:"#FF6B6B",textColor:"#ffffff",location:"مكة",timestamp:new Date,expiresAt:new Date(Date.now()+24*60*60*1e3),viewCount:"67",viewers:[],user:{id:"user4",name:"منتجات طبيعية",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=100&h=100&fit=crop&crop=face",phoneNumber:"+966509876543",location:"مكة",isOnline:!0,isVerified:!0,verifiedAt:new Date,isAdmin:!1,lastSeen:new Date,createdAt:new Date,updatedAt:new Date}}],v=[{id:"c1",userId:"u1",userName:"سارة أحمد",userAvatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=50&h=50&fit=crop&crop=face",content:"منتجات رائعة! أين يمكنني الشراء؟",timestamp:new Date(Date.now()-2*60*1e3),likes:5},{id:"c2",userId:"u2",userName:"محمد علي",userAvatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=50&h=50&fit=crop&crop=face",content:"جودة ممتازة والأسعار مناسبة 👍",timestamp:new Date(Date.now()-5*60*1e3),likes:3},{id:"c3",userId:"u3",userName:"فاطمة خالد",userAvatar:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=50&h=50&fit=crop&crop=face",content:"هل يوجد توصيل للمنطقة الشرقية؟",timestamp:new Date(Date.now()-10*60*1e3),likes:1},{id:"c4",userId:"u4",userName:"أحمد محمد",userAvatar:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=50&h=50&fit=crop&crop=face",content:"شكرًا لكم على الخدمة المميزة",timestamp:new Date(Date.now()-15*60*1e3),likes:7},{id:"c5",userId:"u5",userName:"نور العين",userAvatar:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=50&h=50&fit=crop&crop=face",content:"متى سيكون العرض متاحًا؟",timestamp:new Date(Date.now()-20*60*1e3),likes:2}],y=()=>{const E={};return S.forEach(U=>{E[U.id]={storyId:U.id,likes:Math.floor(Math.random()*100)+20,isLiked:!1,comments:v.slice(0,Math.floor(Math.random()*3)+1),shares:Math.floor(Math.random()*50)+10}}),E};d.useEffect(()=>{Object.keys(f).length===0&&g(y())},[]);const C=x.length>0?x:S,k=C[t],D=f[k==null?void 0:k.id]||{storyId:(k==null?void 0:k.id)||"",likes:0,isLiked:!1,comments:[],shares:0},Q=()=>{if(!j.current)return;const U=j.current.scrollTop,te=window.innerHeight,q=Math.round(U/te);q!==t&&q>=0&&q<C.length&&e(q)},H=()=>{i(!n)},M=()=>{l(!o)},L=E=>{g(U=>{var te,q,ge;return{...U,[E]:{...U[E],likes:(te=U[E])!=null&&te.isLiked?U[E].likes-1:(((q=U[E])==null?void 0:q.likes)||0)+1,isLiked:!((ge=U[E])!=null&&ge.isLiked)}}})},$=E=>{g(U=>{var te;return{...U,[E]:{...U[E],shares:(((te=U[E])==null?void 0:te.shares)||0)+1}}}),navigator.share?navigator.share({title:"شاهد هذه الحالة",text:(k==null?void 0:k.content)||"",url:window.location.href}):navigator.clipboard.writeText(window.location.href)},w=()=>{if(!u.trim()||!k)return;const E={id:`c${Date.now()}`,userId:"current_user",userName:"أنت",userAvatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=50&h=50&fit=crop&crop=face",content:u,timestamp:new Date,likes:0};g(U=>{var te;return{...U,[k.id]:{...U[k.id],comments:[...((te=U[k.id])==null?void 0:te.comments)||[],E]}}}),p("")},A=E=>{const te=Math.floor((new Date().getTime()-E.getTime())/(1e3*60));return te<1?"الآن":te<60?`${te} دقيقة`:te<1440?`${Math.floor(te/60)} ساعة`:`${Math.floor(te/1440)} يوم`};return d.useEffect(()=>{const E=j.current;if(E)return E.addEventListener("scroll",Q),()=>E.removeEventListener("scroll",Q)},[t]),m?s.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:s.jsx("div",{className:"text-white text-lg",children:"جاري التحميل..."})}):s.jsxs("div",{className:"relative w-full h-screen bg-black overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 right-0 z-20 bg-gradient-to-b from-black/50 to-transparent",children:s.jsxs("div",{className:"flex items-center justify-between p-4 pt-12",children:[s.jsx(jt,{href:"/",children:s.jsx(T,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 w-10 h-10 rounded-full","data-testid":"button-back",children:s.jsx(Sa,{className:"w-5 h-5"})})}),s.jsx("h1",{className:"text-white text-lg font-semibold",children:"الحالات"}),s.jsx(T,{onClick:()=>a(!0),variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 w-10 h-10 rounded-full","data-testid":"button-add-status",children:s.jsx(Bs,{className:"w-5 h-5"})})]})}),s.jsxs("div",{ref:j,className:"h-full overflow-y-scroll snap-y snap-mandatory scroll-smooth",style:{scrollbarWidth:"none",msOverflowStyle:"none"},"data-testid":"video-feed",children:[s.jsx("style",{children:`
          div::-webkit-scrollbar {
            display: none;
          }
        `}),C.map((E,U)=>{var te,q,ge,Me,Ke,Qe;return s.jsxs("div",{className:"relative w-full h-screen snap-start snap-always flex items-center justify-center",style:{backgroundColor:E.backgroundColor||"#075e54"},children:[E.videoUrl?s.jsx("video",{src:E.videoUrl,className:"absolute inset-0 w-full h-full object-cover",autoPlay:U===t&&n,loop:!0,muted:o,playsInline:!0,controls:!1,"data-testid":`video-story-${U}`}):E.imageUrl?s.jsx("img",{src:E.imageUrl,alt:E.content||"",className:"absolute inset-0 w-full h-full object-cover","data-testid":`img-story-${U}`}):s.jsx("div",{className:"absolute inset-0 w-full h-full flex items-center justify-center",style:{backgroundColor:E.backgroundColor||"#075e54"},children:s.jsx("div",{className:"text-center p-8 max-w-sm",style:{color:E.textColor||"#ffffff"},children:s.jsx("p",{className:"text-2xl font-bold leading-relaxed",children:E.content})})}),s.jsx("div",{className:"absolute inset-0 bg-black/20"}),(E.imageUrl||E.videoUrl)&&E.content&&s.jsx("div",{className:"absolute inset-0 flex items-end",children:s.jsx("div",{className:"w-full p-6 bg-gradient-to-t from-black/70 to-transparent",children:s.jsx("p",{className:"text-white text-lg font-medium leading-relaxed",children:E.content})})}),s.jsxs("div",{className:"absolute bottom-20 left-4 flex items-center gap-3 z-10",children:[s.jsxs(Ft,{className:"w-12 h-12 border-2 border-white",children:[s.jsx(Lt,{src:E.user.avatar||void 0}),s.jsx(Vt,{className:"bg-gray-600 text-white",children:E.user.name[0]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-white font-semibold","data-testid":`text-username-${U}`,children:E.user.name}),E.user.isVerified&&s.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white text-xs",children:"✓"})})]}),s.jsx("p",{className:"text-white/80 text-sm",children:E.location})]})]}),s.jsxs("div",{className:"absolute bottom-32 right-4 flex flex-col gap-4 z-10",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(T,{onClick:()=>L(E.id),variant:"ghost",size:"icon",className:`w-12 h-12 rounded-full transition-all duration-200 ${(te=f[E.id])!=null&&te.isLiked?"bg-red-500/80 text-white hover:bg-red-500":"bg-white/20 text-white hover:bg-white/30"}`,"data-testid":`button-like-${U}`,children:s.jsx(Mn,{className:`w-6 h-6 ${(q=f[E.id])!=null&&q.isLiked?"fill-current":""}`})}),s.jsx("span",{className:"text-white text-xs mt-1 font-medium",children:((ge=f[E.id])==null?void 0:ge.likes)||0})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(T,{onClick:()=>{e(U),h(!0)},variant:"ghost",size:"icon",className:"w-12 h-12 rounded-full bg-white/20 text-white hover:bg-white/30","data-testid":`button-comment-${U}`,children:s.jsx(Cs,{className:"w-6 h-6"})}),s.jsx("span",{className:"text-white text-xs mt-1 font-medium",children:((Ke=(Me=f[E.id])==null?void 0:Me.comments)==null?void 0:Ke.length)||0})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(T,{onClick:()=>$(E.id),variant:"ghost",size:"icon",className:"w-12 h-12 rounded-full bg-white/20 text-white hover:bg-white/30","data-testid":`button-share-${U}`,children:s.jsx(Rf,{className:"w-6 h-6"})}),s.jsx("span",{className:"text-white text-xs mt-1 font-medium",children:((Qe=f[E.id])==null?void 0:Qe.shares)||0})]}),E.videoUrl&&s.jsx(T,{onClick:M,variant:"ghost",size:"icon",className:"w-12 h-12 rounded-full bg-white/20 text-white hover:bg-white/30","data-testid":`button-sound-${U}`,children:o?s.jsx(Bb,{className:"w-6 h-6"}):s.jsx(Ub,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10",children:U===t&&s.jsx(T,{onClick:H,variant:"ghost",size:"icon",className:"w-16 h-16 rounded-full bg-black/20 text-white hover:bg-black/40 opacity-0 hover:opacity-100 transition-opacity","data-testid":`button-play-pause-${U}`,children:n?s.jsx($o,{className:"w-8 h-8"}):s.jsx(qo,{className:"w-8 h-8"})})}),s.jsx("div",{className:"absolute top-20 right-4 bg-black/40 rounded-full px-3 py-1",children:s.jsxs("p",{className:"text-white text-sm","data-testid":`text-views-${U}`,children:[E.viewCount," مشاهدة"]})})]},E.id)})]}),s.jsx("div",{className:"absolute top-20 left-1/2 transform -translate-x-1/2 flex gap-1 z-20",children:C.map((E,U)=>s.jsx("div",{className:`w-8 h-1 rounded-full transition-all duration-300 ${U===t?"bg-white":"bg-white/40"}`,"data-testid":`progress-indicator-${U}`},U))}),s.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white/60 text-sm text-center",children:s.jsx("p",{children:"اسحب لأعلى أو لأسفل للتنقل"})}),s.jsx(Rp,{isOpen:r,onClose:()=>a(!1)}),s.jsx(Yt,{open:c,onOpenChange:h,children:s.jsxs(Kt,{className:"max-w-md mx-auto h-[80vh] flex flex-col p-0 gap-0",children:[s.jsx(Qt,{className:"p-4 border-b",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ht,{className:"text-lg font-semibold",children:"التعليقات"}),s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>h(!1),className:"w-8 h-8","data-testid":"button-close-comments",children:s.jsx(dr,{className:"w-4 h-4"})})]})}),s.jsx(Yo,{className:"flex-1 p-4",children:s.jsxs("div",{className:"space-y-4",children:[(I=D.comments)==null?void 0:I.map(E=>s.jsxs("div",{className:"flex gap-3","data-testid":`comment-${E.id}`,children:[s.jsxs(Ft,{className:"w-8 h-8 flex-shrink-0",children:[s.jsx(Lt,{src:E.userAvatar}),s.jsx(Vt,{className:"text-xs",children:E.userName[0]})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-2xl px-3 py-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-semibold text-sm",children:E.userName}),s.jsx("span",{className:"text-xs text-gray-500",children:A(E.timestamp)})]}),s.jsx("p",{className:"text-sm leading-relaxed",children:E.content})]}),s.jsxs("div",{className:"flex items-center gap-4 mt-2 px-2",children:[s.jsxs(T,{variant:"ghost",size:"sm",className:"h-6 px-0 text-xs text-gray-500 hover:text-blue-600","data-testid":`button-like-comment-${E.id}`,children:[s.jsx(Mn,{className:"w-3 h-3 ml-1"}),E.likes>0&&E.likes]}),s.jsx(T,{variant:"ghost",size:"sm",className:"h-6 px-0 text-xs text-gray-500 hover:text-blue-600","data-testid":`button-reply-comment-${E.id}`,children:"رد"})]})]})]},E.id)),((K=D.comments)==null?void 0:K.length)===0&&s.jsxs("div",{className:"text-center text-gray-500 py-8","data-testid":"no-comments",children:[s.jsx(Cs,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"لا توجد تعليقات بعد"}),s.jsx("p",{className:"text-sm",children:"كن أول من يعلق!"})]})]})}),s.jsx("div",{className:"border-t p-4",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(Ft,{className:"w-8 h-8 flex-shrink-0",children:[s.jsx(Lt,{src:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=50&h=50&fit=crop&crop=face"}),s.jsx(Vt,{className:"text-xs",children:"أ"})]}),s.jsxs("div",{className:"flex-1 flex gap-2",children:[s.jsx(Ce,{value:u,onChange:E=>p(E.target.value),placeholder:"اكتب تعليقاً...",className:"flex-1",onKeyPress:E=>{E.key==="Enter"&&w()},"data-testid":"input-new-comment"}),s.jsx(T,{onClick:w,size:"icon",disabled:!u.trim(),className:"w-10 h-10 flex-shrink-0","data-testid":"button-send-comment",children:s.jsx(Uo,{className:"w-4 h-4"})})]})]})})]})})]})}const oe=d.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:se("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));oe.displayName="Card";const xt=d.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:se("flex flex-col space-y-1.5 p-6",t),...e}));xt.displayName="CardHeader";const Nt=d.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:se("text-2xl font-semibold leading-none tracking-tight",t),...e}));Nt.displayName="CardTitle";const lr=d.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:se("text-sm text-muted-foreground",t),...e}));lr.displayName="CardDescription";const le=d.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:se("p-6 pt-0",t),...e}));le.displayName="CardContent";const Uj=d.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:se("flex items-center p-6 pt-0",t),...e}));Uj.displayName="CardFooter";function Bj(){const[t,e]=d.useState(""),[r,a]=d.useState(null),[,n]=ys(),{toast:i}=lt(),{data:o}=ye({queryKey:["/api/user/current"]}),{data:l=[],isLoading:c}=ye({queryKey:["/api/stores",o==null?void 0:o.location],queryFn:()=>ce(`/api/stores?location=${encodeURIComponent((o==null?void 0:o.location)||"")}`),enabled:!!o}),{data:h=[],isLoading:u}=ye({queryKey:["/api/products",r==null?void 0:r.id],queryFn:()=>ce(`/api/products/store/${r==null?void 0:r.id}`),enabled:!!r}),{data:p=[]}=ye({queryKey:["/api/cart"]}),f=Se({mutationFn:async x=>ce("/api/chats/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otherUserId:x})}),onSuccess:x=>{n(`/chat/${x.chatId}`)}}),g=Se({mutationFn:async({productId:x,quantity:m=1})=>ce("/api/cart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:x,quantity:m.toString()})}),onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/cart"]}),i({title:"تم الإضافة للسلة",description:"تم إضافة المنتج إلى السلة بنجاح"})},onError:()=>{i({title:"خطأ",description:"فشل في إضافة المنتج للسلة",variant:"destructive"})}});Se({mutationFn:async({product:x,sellerId:m})=>{const S=await ce("/api/chats/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otherUserId:m})}),v=`مرحباً، أريد شراء هذا المنتج:

📦 ${x.name}
💰 السعر: ${parseInt(x.price).toLocaleString()} دج
📝 ${x.description}

هل هذا المنتج متوفر؟`;return await ce(`/api/chats/${S.chatId}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:v,messageType:"text",replyToId:null})}),S},onSuccess:x=>{n(`/chat/${x.chatId}`)},onError:()=>{i({title:"خطأ",description:"فشل في بدء المحادثة مع البائع",variant:"destructive"})}});const j=l.filter(x=>x.name.toLowerCase().includes(t.toLowerCase())||x.category.toLowerCase().includes(t.toLowerCase()));return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20",children:[s.jsx("div",{className:"bg-whatsapp-green text-white p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(jt,{href:"/",children:s.jsx(T,{variant:"ghost",size:"icon",className:"text-white hover:bg-green-600 w-12 h-12 rounded-full","data-testid":"button-back",children:s.jsx(Sa,{className:"w-6 h-6"})})}),s.jsx("h1",{className:"text-2xl font-bold",children:"المتاجر"})]}),s.jsx(jt,{href:"/cart",children:s.jsxs(T,{variant:"ghost",size:"icon",className:"text-white hover:bg-green-600 w-12 h-12 rounded-full relative","data-testid":"button-cart",children:[s.jsx(Dr,{className:"w-6 h-6"}),p.length>0&&s.jsx(Te,{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center",children:p.length})]})})]})}),s.jsxs("div",{className:"px-4 py-3",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-5 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400 mb-3",children:[s.jsx(gs,{className:"w-6 h-6"}),s.jsxs("span",{className:"text-base font-semibold",children:["المتاجر في منطقة ",o==null?void 0:o.location]})]}),s.jsx("p",{className:"text-base text-gray-500",children:"اكتشف المتاجر والخدمات المحلية في منطقتك"})]}),s.jsxs("div",{className:"relative mb-6",children:[s.jsx(cr,{className:"absolute right-4 top-4 w-6 h-6 text-gray-400"}),s.jsx(Ce,{type:"text",placeholder:"ابحث عن متجر أو فئة...",value:t,onChange:x=>e(x.target.value),className:"pr-12 text-lg h-14 rounded-2xl border-2 border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-sm","data-testid":"input-search-stores"})]}),s.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Bt,{className:"w-8 h-8 mx-auto mb-2"}),s.jsx("h2",{className:"text-lg font-bold mb-2",children:"أضف متجرك"}),s.jsx("p",{className:"text-sm opacity-90",children:"انضم إلى شبكة المتاجر المحلية واعرض منتجاتك للجميع"}),s.jsx(jt,{href:"/my-store",children:s.jsx(T,{className:"mt-3 bg-white text-blue-600 hover:bg-gray-100",size:"sm","data-testid":"button-add-store",children:"سجل متجرك مجاناً"})})]})}),c&&s.jsx("div",{className:"space-y-4",children:[1,2,3].map(x=>s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 animate-pulse",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"w-24 h-24 bg-gray-200 dark:bg-gray-700 rounded"}),s.jsxs("div",{className:"flex-1 mr-4 space-y-2",children:[s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"}),s.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-20"}),s.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-20"})]})]})]})},x))}),!c&&s.jsx("div",{className:"space-y-4",children:j.map(x=>s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden","data-testid":`store-card-${x.id}`,children:s.jsxs("div",{className:"flex",children:[x.imageUrl&&s.jsx("img",{src:x.imageUrl,alt:x.name,className:"w-24 h-24 object-cover","data-testid":`img-store-${x.id}`}),!x.imageUrl&&s.jsx("div",{className:"w-24 h-24 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:s.jsx(Bt,{className:"w-8 h-8 text-gray-400"})}),s.jsxs("div",{className:"flex-1 p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"font-semibold text-lg",children:x.name}),x.isVerified&&s.jsx("div",{title:"متجر موثق",children:s.jsx(Ba,{className:"w-4 h-4 text-blue-500","data-testid":`badge-verified-store-${x.id}`})})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:x.description}),s.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:["بواسطة ",x.owner.name]}),x.owner.isVerified&&s.jsx("div",{title:"حساب موثق",children:s.jsx(Ba,{className:"w-3 h-3 text-blue-500","data-testid":`badge-verified-owner-${x.id}`})})]})]}),s.jsxs(Te,{variant:x.isOpen?"default":"secondary",className:x.isOpen?"bg-green-500":"bg-gray-500",children:[s.jsx(is,{className:"w-3 h-3 mr-1"}),x.isOpen?"مفتوح":"مغلق"]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(gs,{className:"w-4 h-4"}),s.jsx("span",{children:x.location})]}),x.phoneNumber&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Es,{className:"w-4 h-4"}),s.jsx("span",{children:x.phoneNumber})]})]}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:s.jsx(Te,{variant:"outline",className:"text-xs",children:x.category})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(T,{size:"sm",className:"bg-whatsapp-green hover:bg-green-600 flex items-center gap-1",onClick:()=>f.mutate(x.userId),disabled:f.isPending,"data-testid":`button-contact-${x.id}`,children:[s.jsx(Cs,{className:"w-3 h-3"}),"تواصل"]}),s.jsxs(Yt,{children:[s.jsx(Qa,{asChild:!0,children:s.jsxs(T,{size:"sm",variant:"outline",onClick:()=>a(x),"data-testid":`button-view-${x.id}`,children:[s.jsx(Dt,{className:"w-3 h-3 mr-1"}),"عرض المنتجات"]})}),s.jsxs(Kt,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[s.jsx(Qt,{children:s.jsxs(Ht,{className:"text-xl",children:["منتجات ",r==null?void 0:r.name]})}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:u?s.jsx("div",{className:"text-center py-8",children:"جاري التحميل..."}):h.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Dt,{className:"w-12 h-12 mx-auto text-gray-300 mb-4"}),s.jsx("p",{className:"text-gray-500",children:"لا توجد منتجات في هذا المتجر حالياً"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.map(m=>s.jsxs(oe,{className:"overflow-hidden hover:shadow-lg transition-shadow","data-testid":`product-card-${m.id}`,children:[s.jsxs(xt,{className:"p-0",children:[m.imageUrl&&s.jsx("img",{src:m.imageUrl,alt:m.name,className:"w-full h-32 object-cover"}),!m.imageUrl&&s.jsx("div",{className:"w-full h-32 bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:s.jsx(Dt,{className:"w-8 h-8 text-gray-400"})})]}),s.jsx(le,{className:"p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:m.name}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:m.description})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx(Te,{variant:"outline",className:"text-xs",children:m.category}),s.jsxs("div",{className:"text-lg font-bold text-whatsapp-green",children:[parseInt(m.price).toLocaleString()," دج"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(T,{size:"sm",variant:"outline",className:"flex-1",onClick:S=>{S.stopPropagation(),g.mutate({productId:m.id})},disabled:g.isPending,"data-testid":`button-add-to-cart-${m.id}`,children:[s.jsx(Dr,{className:"w-3 h-3 mr-1"}),g.isPending?"جاري...":"أضف للسلة"]}),s.jsx(jt,{href:`/product/${m.id}`,children:s.jsx(T,{size:"sm",variant:"ghost",className:"flex-1 min-w-fit","data-testid":`button-view-details-${m.id}`,children:"عرض التفاصيل"})})]})]})})]},m.id))})})]})]})]})]})]})},x.id))}),!c&&j.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Bt,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t?"لا توجد متاجر تطابق البحث":"لا توجد متاجر في هذه المنطقة حالياً"}),!t&&s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"كن أول من ينشئ متجراً في منطقتك!"})]})]}),s.jsx("div",{className:"fixed bottom-20 left-4 z-50",children:s.jsx(jt,{href:"/my-store",children:s.jsx(T,{className:"w-16 h-16 rounded-full bg-[var(--whatsapp-primary)] hover:bg-[var(--whatsapp-primary)]/90 active:bg-[var(--whatsapp-primary)]/80 shadow-xl transition-transform active:scale-95 touch-none","data-testid":"fab-my-store",children:s.jsx(Bt,{className:"h-6 w-6 text-white"})})})})]})}var Kj="Separator",Kl="horizontal",Qj=["horizontal","vertical"],Op=d.forwardRef((t,e)=>{const{decorative:r,orientation:a=Kl,...n}=t,i=Hj(a)?a:Kl,l=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return s.jsx(Ae.div,{"data-orientation":i,...l,...n,ref:e})});Op.displayName=Kj;function Hj(t){return Qj.includes(t)}var Dp=Op;const mo=d.forwardRef(({className:t,orientation:e="horizontal",decorative:r=!0,...a},n)=>s.jsx(Dp,{ref:n,decorative:r,orientation:e,className:se("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...a}));mo.displayName=Dp.displayName;function Zj(){const{productId:t}=qm(),[,e]=ys(),{toast:r}=lt(),a=vs(),[n,i]=d.useState(0),[o,l]=d.useState(!1),[c,h]=d.useState(null),[u,p]=d.useState(null),f=d.useRef(null),{data:g,isLoading:j}=ye({queryKey:["/api/products",t],retry:!1,refetchOnMount:!0}),x=Se({mutationFn:async L=>{console.log("Sending request with sellerId:",L);const $=await ce("/api/chats/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otherUserId:L})}),w=`مرحباً 👋

أنا مهتم بهذا المنتج:
🛍️ ${g==null?void 0:g.name}
💰 ${S((g==null?void 0:g.price)||"0")}
📍 ${g==null?void 0:g.location}

هل يمكنك تزويدي بمزيد من التفاصيل؟
شكراً لك 🙏`;return await ce(`/api/chats/${$.chatId}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:w,messageType:"text",replyToId:null})}),$},onSuccess:L=>{e(`/chat/${L.chatId}`)},onError:()=>{r({title:"خطأ",description:"فشل في بدء المحادثة مع البائع",variant:"destructive"})}}),m=Se({mutationFn:async()=>(await ce("/api/cart",{method:"POST",body:JSON.stringify({productId:g==null?void 0:g.id,quantity:1})})).json(),onSuccess:()=>{r({title:"تم بنجاح",description:"تم إضافة المنتج إلى السلة"}),a.invalidateQueries({queryKey:["/api/cart"]})},onError:()=>{r({title:"خطأ",description:"فشل في إضافة المنتج إلى السلة",variant:"destructive"})}}),S=L=>`${parseFloat(L.toString()).toLocaleString()} دج`,v=async()=>{if(navigator.share)try{await navigator.share({title:(g==null?void 0:g.name)||"منتج",text:`شاهد هذا المنتج الرائع: ${g==null?void 0:g.name}`,url:window.location.href})}catch{}else try{await navigator.clipboard.writeText(window.location.href),r({title:"تم النسخ",description:"تم نسخ رابط المنتج"})}catch{r({title:"خطأ",description:"فشل في نسخ الرابط",variant:"destructive"})}},y=()=>{var L,$;if(g){console.log("Product data:",g),console.log("Owner ID:",(L=g.owner)==null?void 0:L.id),console.log("Owner data:",g.owner);const w=(($=g.owner)==null?void 0:$.id)||"user-store-3";console.log("Using seller ID:",w),x.mutate(w)}},C=[g==null?void 0:g.imageUrl,"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=500&h=500&fit=crop","https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=500&h=500&fit=crop","https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=500&h=500&fit=crop"].filter(L=>!!L),k=()=>{i(L=>(L+1)%C.length)},D=()=>{i(L=>(L-1+C.length)%C.length)},Q=L=>{p(null),h(L.targetTouches[0].clientX)},H=L=>{p(L.targetTouches[0].clientX)},M=()=>{if(!c||!u)return;const L=c-u,$=L>50,w=L<-50;$&&C.length>1&&k(),w&&C.length>1&&D()};return j?s.jsx("div",{className:"min-h-screen bg-background",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded-md w-32 mb-6"}),s.jsx("div",{className:"aspect-square bg-gray-200 rounded-lg mb-6"}),s.jsx("div",{className:"h-8 bg-gray-200 rounded-md w-3/4 mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded-md w-1/2 mb-8"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded-md"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded-md w-5/6"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded-md w-4/6"})]})]})})}):g?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("div",{className:"sticky top-0 z-40 bg-background border-b",children:s.jsx("div",{className:"container mx-auto px-4",children:s.jsxs("div",{className:"flex items-center justify-between h-16",children:[s.jsx(jt,{href:"/stores",children:s.jsx(T,{variant:"ghost",size:"icon","data-testid":"button-back",children:s.jsx(Sa,{className:"w-5 h-5"})})}),s.jsx("h1",{className:"font-semibold text-lg truncate mx-4",children:g.name}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(T,{variant:"ghost",size:"icon",onClick:()=>l(!o),"data-testid":"button-like",children:s.jsx(Mn,{className:`w-5 h-5 ${o?"fill-current text-red-500":""}`})}),s.jsx(T,{variant:"ghost",size:"icon",onClick:v,"data-testid":"button-share",children:s.jsx(Pn,{className:"w-5 h-5"})})]})]})})}),s.jsx("div",{ref:f,className:"relative aspect-square max-h-[400px] overflow-hidden",onTouchStart:Q,onTouchMove:H,onTouchEnd:M,children:C.length>0?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:C[n],alt:g.name,className:"w-full h-full object-cover transition-transform duration-300","data-testid":"product-main-image"}),C.length>1&&s.jsxs(s.Fragment,{children:[s.jsx(T,{variant:"ghost",size:"icon",className:"absolute left-4 top-1/2 transform -translate-y-1/2 bg-black/20 hover:bg-black/40 text-white rounded-full",onClick:D,"data-testid":"button-prev-image",children:s.jsx(Tf,{className:"w-6 h-6"})}),s.jsx(T,{variant:"ghost",size:"icon",className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-black/20 hover:bg-black/40 text-white rounded-full",onClick:k,"data-testid":"button-next-image",children:s.jsx(Vo,{className:"w-6 h-6"})}),s.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-black/50 text-white px-3 py-1 rounded-full text-xs",children:"اسحب يميناً أو يساراً"}),s.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2",children:C.map((L,$)=>s.jsx("button",{onClick:()=>i($),className:`w-2 h-2 rounded-full transition-all ${$===n?"bg-white":"bg-white/50"}`,"data-testid":`image-indicator-${$}`},$))})]})]}):s.jsx("div",{className:"w-full h-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:s.jsx(Dt,{className:"w-16 h-16 text-gray-400"})})}),s.jsx("div",{className:"container mx-auto px-4 py-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:g.name}),s.jsx(Te,{variant:"outline",className:"ml-4 shrink-0",children:g.category})]}),s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("span",{className:"text-3xl font-bold text-whatsapp-green","data-testid":"product-price",children:S(g.price)}),g.commissionRate&&parseFloat(g.commissionRate)>0&&s.jsxs(Te,{variant:"secondary",className:"text-sm",children:["عمولة ",(parseFloat(g.commissionRate)*100).toFixed(0),"%"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsx(gs,{className:"w-4 h-4"}),s.jsx("span",{children:g.location}),s.jsx("span",{className:"mx-2",children:"•"}),s.jsx(is,{className:"w-4 h-4"}),s.jsxs("span",{children:["منشور منذ ",new Date(g.createdAt).toLocaleDateString("ar")]})]})]}),s.jsx(mo,{}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"وصف المنتج"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 leading-relaxed whitespace-pre-wrap",children:g.description})]}),s.jsx(mo,{}),s.jsx(oe,{children:s.jsxs(le,{className:"p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"معلومات البائع"}),s.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[s.jsxs(Ft,{className:"w-12 h-12",children:[s.jsx(Lt,{src:g.owner.avatar||void 0}),s.jsx(Vt,{children:s.jsx(_s,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:g.owner.name}),g.owner.isVerified&&s.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white text-xs",children:"✓"})}),g.owner.isOnline&&s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(gs,{className:"w-3 h-3"}),s.jsx("span",{children:g.owner.location})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Es,{className:"w-3 h-3"}),s.jsx("span",{children:g.owner.phoneNumber})]})]}),s.jsxs(T,{onClick:y,disabled:x.isPending,className:"w-full mt-3 bg-whatsapp-green hover:bg-green-600","data-testid":"button-quick-chat",children:[s.jsx(Cs,{className:"w-4 h-4 ml-2"}),"💬 دردشة سريعة"]})]})]}),g.store&&s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Bt,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:g.store.name})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:g.store.description})]})]})})]})}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background border-t p-4 safe-area-pb",children:s.jsx("div",{className:"container mx-auto",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(T,{variant:"outline",className:"flex-1",onClick:()=>m.mutate(),disabled:m.isPending,"data-testid":"button-add-to-cart",children:[s.jsx(Dr,{className:"w-4 h-4 ml-2"}),m.isPending?"جاري الإضافة...":"أضف للسلة"]}),s.jsxs(T,{className:"flex-1 bg-whatsapp-green hover:bg-green-600 relative",onClick:y,disabled:x.isPending,"data-testid":"button-contact-seller",children:[s.jsx(Cs,{className:"w-5 h-5 ml-2"}),x.isPending?"جاري الاتصال...":"💬 دردشة مع البائع",s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"})]})]})})}),s.jsx("div",{className:"h-20"})]}):s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Dt,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"المنتج غير موجود"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"لم يتم العثور على المنتج المطلوب"}),s.jsx(jt,{href:"/stores",children:s.jsx(T,{children:"العودة إلى المتاجر"})})]})})}var pn=t=>t.type==="checkbox",wr=t=>t instanceof Date,Mt=t=>t==null;const Fp=t=>typeof t=="object";var it=t=>!Mt(t)&&!Array.isArray(t)&&Fp(t)&&!wr(t),Lp=t=>it(t)&&t.target?pn(t.target)?t.target.checked:t.target.value:t,Wj=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,Vp=(t,e)=>t.has(Wj(e)),Gj=t=>{const e=t.constructor&&t.constructor.prototype;return it(e)&&e.hasOwnProperty("isPrototypeOf")},el=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function bt(t){let e;const r=Array.isArray(t),a=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(el&&(t instanceof Blob||a))&&(r||it(t)))if(e=r?[]:{},!r&&!Gj(t))e=t;else for(const n in t)t.hasOwnProperty(n)&&(e[n]=bt(t[n]));else return t;return e}var yi=t=>Array.isArray(t)?t.filter(Boolean):[],nt=t=>t===void 0,W=(t,e,r)=>{if(!e||!it(t))return r;const a=yi(e.split(/[,[\].]+?/)).reduce((n,i)=>Mt(n)?n:n[i],t);return nt(a)||a===t?nt(t[e])?r:t[e]:a},Xt=t=>typeof t=="boolean",tl=t=>/^\w*$/.test(t),zp=t=>yi(t.replace(/["|']|\]/g,"").split(/\.|\[/)),qe=(t,e,r)=>{let a=-1;const n=tl(e)?[e]:zp(e),i=n.length,o=i-1;for(;++a<i;){const l=n[a];let c=r;if(a!==o){const h=t[l];c=it(h)||Array.isArray(h)?h:isNaN(+n[a+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;t[l]=c,t=t[l]}};const zn={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},us={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Os={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},$p=De.createContext(null),vi=()=>De.useContext($p),Xj=t=>{const{children:e,...r}=t;return De.createElement($p.Provider,{value:r},e)};var qp=(t,e,r,a=!0)=>{const n={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(n,i,{get:()=>{const o=i;return e._proxyFormState[o]!==us.all&&(e._proxyFormState[o]=!a||us.all),r&&(r[o]=!0),t[o]}});return n};function Jj(t){const e=vi(),{control:r=e.control,disabled:a,name:n,exact:i}=t||{},[o,l]=De.useState(r._formState),c=De.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),h=De.useRef(n);return h.current=n,De.useEffect(()=>r._subscribe({name:h.current,formState:c.current,exact:i,callback:u=>{!a&&l({...r._formState,...u})}}),[r,a,i]),De.useEffect(()=>{c.current.isValid&&r._setValid(!0)},[r]),De.useMemo(()=>qp(o,r,c.current,!1),[o,r])}var Ss=t=>typeof t=="string",Up=(t,e,r,a,n)=>Ss(t)?(a&&e.watch.add(t),W(r,t,n)):Array.isArray(t)?t.map(i=>(a&&e.watch.add(i),W(r,i))):(a&&(e.watchAll=!0),r);function Yj(t){const e=vi(),{control:r=e.control,name:a,defaultValue:n,disabled:i,exact:o}=t||{},l=De.useRef(a),c=De.useRef(n);l.current=a,De.useEffect(()=>r._subscribe({name:l.current,formState:{values:!0},exact:o,callback:p=>!i&&u(Up(l.current,r._names,p.values||r._formValues,!1,c.current))}),[r,i,o]);const[h,u]=De.useState(r._getWatch(a,n));return De.useEffect(()=>r._removeUnmounted()),h}function eN(t){const e=vi(),{name:r,disabled:a,control:n=e.control,shouldUnregister:i}=t,o=Vp(n._names.array,r),l=Yj({control:n,name:r,defaultValue:W(n._formValues,r,W(n._defaultValues,r,t.defaultValue)),exact:!0}),c=Jj({control:n,name:r,exact:!0}),h=De.useRef(t),u=De.useRef(n.register(r,{...t.rules,value:l,...Xt(t.disabled)?{disabled:t.disabled}:{}})),p=De.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!W(c.errors,r)},isDirty:{enumerable:!0,get:()=>!!W(c.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!W(c.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!W(c.validatingFields,r)},error:{enumerable:!0,get:()=>W(c.errors,r)}}),[c,r]),f=De.useCallback(m=>u.current.onChange({target:{value:Lp(m),name:r},type:zn.CHANGE}),[r]),g=De.useCallback(()=>u.current.onBlur({target:{value:W(n._formValues,r),name:r},type:zn.BLUR}),[r,n._formValues]),j=De.useCallback(m=>{const S=W(n._fields,r);S&&m&&(S._f.ref={focus:()=>m.focus(),select:()=>m.select(),setCustomValidity:v=>m.setCustomValidity(v),reportValidity:()=>m.reportValidity()})},[n._fields,r]),x=De.useMemo(()=>({name:r,value:l,...Xt(a)||c.disabled?{disabled:c.disabled||a}:{},onChange:f,onBlur:g,ref:j}),[r,a,c.disabled,f,g,j,l]);return De.useEffect(()=>{const m=n._options.shouldUnregister||i;n.register(r,{...h.current.rules,...Xt(h.current.disabled)?{disabled:h.current.disabled}:{}});const S=(v,y)=>{const C=W(n._fields,v);C&&C._f&&(C._f.mount=y)};if(S(r,!0),m){const v=bt(W(n._options.defaultValues,r));qe(n._defaultValues,r,v),nt(W(n._formValues,r))&&qe(n._formValues,r,v)}return!o&&n.register(r),()=>{(o?m&&!n._state.action:m)?n.unregister(r):S(r,!1)}},[r,n,o,i]),De.useEffect(()=>{n._setDisabledField({disabled:a,name:r})},[a,r,n]),De.useMemo(()=>({field:x,formState:c,fieldState:p}),[x,c,p])}const tN=t=>t.render(eN(t));var Bp=(t,e,r,a,n)=>e?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[a]:n||!0}}:{},za=t=>Array.isArray(t)?t:[t],Ql=()=>{let t=[];return{get observers(){return t},next:n=>{for(const i of t)i.next&&i.next(n)},subscribe:n=>(t.push(n),{unsubscribe:()=>{t=t.filter(i=>i!==n)}}),unsubscribe:()=>{t=[]}}},fo=t=>Mt(t)||!Fp(t);function Xs(t,e){if(fo(t)||fo(e))return t===e;if(wr(t)&&wr(e))return t.getTime()===e.getTime();const r=Object.keys(t),a=Object.keys(e);if(r.length!==a.length)return!1;for(const n of r){const i=t[n];if(!a.includes(n))return!1;if(n!=="ref"){const o=e[n];if(wr(i)&&wr(o)||it(i)&&it(o)||Array.isArray(i)&&Array.isArray(o)?!Xs(i,o):i!==o)return!1}}return!0}var Rt=t=>it(t)&&!Object.keys(t).length,sl=t=>t.type==="file",hs=t=>typeof t=="function",$n=t=>{if(!el)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},Kp=t=>t.type==="select-multiple",rl=t=>t.type==="radio",sN=t=>rl(t)||pn(t),Fi=t=>$n(t)&&t.isConnected;function rN(t,e){const r=e.slice(0,-1).length;let a=0;for(;a<r;)t=nt(t)?a++:t[e[a++]];return t}function aN(t){for(const e in t)if(t.hasOwnProperty(e)&&!nt(t[e]))return!1;return!0}function ht(t,e){const r=Array.isArray(e)?e:tl(e)?[e]:zp(e),a=r.length===1?t:rN(t,r),n=r.length-1,i=r[n];return a&&delete a[i],n!==0&&(it(a)&&Rt(a)||Array.isArray(a)&&aN(a))&&ht(t,r.slice(0,-1)),t}var Qp=t=>{for(const e in t)if(hs(t[e]))return!0;return!1};function qn(t,e={}){const r=Array.isArray(t);if(it(t)||r)for(const a in t)Array.isArray(t[a])||it(t[a])&&!Qp(t[a])?(e[a]=Array.isArray(t[a])?[]:{},qn(t[a],e[a])):Mt(t[a])||(e[a]=!0);return e}function Hp(t,e,r){const a=Array.isArray(t);if(it(t)||a)for(const n in t)Array.isArray(t[n])||it(t[n])&&!Qp(t[n])?nt(e)||fo(r[n])?r[n]=Array.isArray(t[n])?qn(t[n],[]):{...qn(t[n])}:Hp(t[n],Mt(e)?{}:e[n],r[n]):r[n]=!Xs(t[n],e[n]);return r}var Aa=(t,e)=>Hp(t,e,qn(e));const Hl={value:!1,isValid:!1},Zl={value:!0,isValid:!0};var Zp=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!nt(t[0].attributes.value)?nt(t[0].value)||t[0].value===""?Zl:{value:t[0].value,isValid:!0}:Zl:Hl}return Hl},Wp=(t,{valueAsNumber:e,valueAsDate:r,setValueAs:a})=>nt(t)?t:e?t===""?NaN:t&&+t:r&&Ss(t)?new Date(t):a?a(t):t;const Wl={isValid:!1,value:null};var Gp=t=>Array.isArray(t)?t.reduce((e,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:e,Wl):Wl;function Gl(t){const e=t.ref;return sl(e)?e.files:rl(e)?Gp(t.refs).value:Kp(e)?[...e.selectedOptions].map(({value:r})=>r):pn(e)?Zp(t.refs).value:Wp(nt(e.value)?t.ref.value:e.value,t)}var nN=(t,e,r,a)=>{const n={};for(const i of t){const o=W(e,i);o&&qe(n,i,o._f)}return{criteriaMode:r,names:[...t],fields:n,shouldUseNativeValidation:a}},Un=t=>t instanceof RegExp,Ea=t=>nt(t)?t:Un(t)?t.source:it(t)?Un(t.value)?t.value.source:t.value:t,Xl=t=>({isOnSubmit:!t||t===us.onSubmit,isOnBlur:t===us.onBlur,isOnChange:t===us.onChange,isOnAll:t===us.all,isOnTouch:t===us.onTouched});const Jl="AsyncFunction";var iN=t=>!!t&&!!t.validate&&!!(hs(t.validate)&&t.validate.constructor.name===Jl||it(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===Jl)),oN=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Yl=(t,e,r)=>!r&&(e.watchAll||e.watch.has(t)||[...e.watch].some(a=>t.startsWith(a)&&/^\.\w+/.test(t.slice(a.length))));const $a=(t,e,r,a)=>{for(const n of r||Object.keys(t)){const i=W(t,n);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],n)&&!a)return!0;if(o.ref&&e(o.ref,o.name)&&!a)return!0;if($a(l,e))break}else if(it(l)&&$a(l,e))break}}};function ec(t,e,r){const a=W(t,r);if(a||tl(r))return{error:a,name:r};const n=r.split(".");for(;n.length;){const i=n.join("."),o=W(e,i),l=W(t,i);if(o&&!Array.isArray(o)&&r!==i)return{name:r};if(l&&l.type)return{name:i,error:l};n.pop()}return{name:r}}var lN=(t,e,r,a)=>{r(t);const{name:n,...i}=t;return Rt(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!a||us.all))},cN=(t,e,r)=>!t||!e||t===e||za(t).some(a=>a&&(r?a===e:a.startsWith(e)||e.startsWith(a))),dN=(t,e,r,a,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(e||t):(r?a.isOnBlur:n.isOnBlur)?!t:(r?a.isOnChange:n.isOnChange)?t:!0,uN=(t,e)=>!yi(W(t,e)).length&&ht(t,e),hN=(t,e,r)=>{const a=za(W(t,r));return qe(a,"root",e[r]),qe(t,r,a),t},An=t=>Ss(t);function tc(t,e,r="validate"){if(An(t)||Array.isArray(t)&&t.every(An)||Xt(t)&&!t)return{type:r,message:An(t)?t:"",ref:e}}var Br=t=>it(t)&&!Un(t)?t:{value:t,message:""},sc=async(t,e,r,a,n,i)=>{const{ref:o,refs:l,required:c,maxLength:h,minLength:u,min:p,max:f,pattern:g,validate:j,name:x,valueAsNumber:m,mount:S}=t._f,v=W(r,x);if(!S||e.has(x))return{};const y=l?l[0]:o,C=w=>{n&&y.reportValidity&&(y.setCustomValidity(Xt(w)?"":w||""),y.reportValidity())},k={},D=rl(o),Q=pn(o),H=D||Q,M=(m||sl(o))&&nt(o.value)&&nt(v)||$n(o)&&o.value===""||v===""||Array.isArray(v)&&!v.length,L=Bp.bind(null,x,a,k),$=(w,A,I,K=Os.maxLength,E=Os.minLength)=>{const U=w?A:I;k[x]={type:w?K:E,message:U,ref:o,...L(w?K:E,U)}};if(i?!Array.isArray(v)||!v.length:c&&(!H&&(M||Mt(v))||Xt(v)&&!v||Q&&!Zp(l).isValid||D&&!Gp(l).isValid)){const{value:w,message:A}=An(c)?{value:!!c,message:c}:Br(c);if(w&&(k[x]={type:Os.required,message:A,ref:y,...L(Os.required,A)},!a))return C(A),k}if(!M&&(!Mt(p)||!Mt(f))){let w,A;const I=Br(f),K=Br(p);if(!Mt(v)&&!isNaN(v)){const E=o.valueAsNumber||v&&+v;Mt(I.value)||(w=E>I.value),Mt(K.value)||(A=E<K.value)}else{const E=o.valueAsDate||new Date(v),U=ge=>new Date(new Date().toDateString()+" "+ge),te=o.type=="time",q=o.type=="week";Ss(I.value)&&v&&(w=te?U(v)>U(I.value):q?v>I.value:E>new Date(I.value)),Ss(K.value)&&v&&(A=te?U(v)<U(K.value):q?v<K.value:E<new Date(K.value))}if((w||A)&&($(!!w,I.message,K.message,Os.max,Os.min),!a))return C(k[x].message),k}if((h||u)&&!M&&(Ss(v)||i&&Array.isArray(v))){const w=Br(h),A=Br(u),I=!Mt(w.value)&&v.length>+w.value,K=!Mt(A.value)&&v.length<+A.value;if((I||K)&&($(I,w.message,A.message),!a))return C(k[x].message),k}if(g&&!M&&Ss(v)){const{value:w,message:A}=Br(g);if(Un(w)&&!v.match(w)&&(k[x]={type:Os.pattern,message:A,ref:o,...L(Os.pattern,A)},!a))return C(A),k}if(j){if(hs(j)){const w=await j(v,r),A=tc(w,y);if(A&&(k[x]={...A,...L(Os.validate,A.message)},!a))return C(A.message),k}else if(it(j)){let w={};for(const A in j){if(!Rt(w)&&!a)break;const I=tc(await j[A](v,r),y,A);I&&(w={...I,...L(A,I.message)},C(I.message),a&&(k[x]=w))}if(!Rt(w)&&(k[x]={ref:y,...w},!a))return k}}return C(!0),k};const mN={mode:us.onSubmit,reValidateMode:us.onChange,shouldFocusError:!0};function fN(t={}){let e={...mN,...t},r={submitCount:0,isDirty:!1,isLoading:hs(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const a={};let n=it(e.defaultValues)||it(e.values)?bt(e.values||e.defaultValues)||{}:{},i=e.shouldUnregister?{}:bt(n),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,h=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...u};const f={array:Ql(),state:Ql()},g=Xl(e.mode),j=Xl(e.reValidateMode),x=e.criteriaMode===us.all,m=b=>P=>{clearTimeout(h),h=setTimeout(b,P)},S=async b=>{if(!e.disabled&&(u.isValid||p.isValid||b)){const P=e.resolver?Rt((await M()).errors):await $(a,!0);P!==r.isValid&&f.state.next({isValid:P})}},v=(b,P)=>{!e.disabled&&(u.isValidating||u.validatingFields||p.isValidating||p.validatingFields)&&((b||Array.from(l.mount)).forEach(R=>{R&&(P?qe(r.validatingFields,R,P):ht(r.validatingFields,R))}),f.state.next({validatingFields:r.validatingFields,isValidating:!Rt(r.validatingFields)}))},y=(b,P=[],R,Z,B=!0,V=!0)=>{if(Z&&R&&!e.disabled){if(o.action=!0,V&&Array.isArray(W(a,b))){const ee=R(W(a,b),Z.argA,Z.argB);B&&qe(a,b,ee)}if(V&&Array.isArray(W(r.errors,b))){const ee=R(W(r.errors,b),Z.argA,Z.argB);B&&qe(r.errors,b,ee),uN(r.errors,b)}if((u.touchedFields||p.touchedFields)&&V&&Array.isArray(W(r.touchedFields,b))){const ee=R(W(r.touchedFields,b),Z.argA,Z.argB);B&&qe(r.touchedFields,b,ee)}(u.dirtyFields||p.dirtyFields)&&(r.dirtyFields=Aa(n,i)),f.state.next({name:b,isDirty:A(b,P),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else qe(i,b,P)},C=(b,P)=>{qe(r.errors,b,P),f.state.next({errors:r.errors})},k=b=>{r.errors=b,f.state.next({errors:r.errors,isValid:!1})},D=(b,P,R,Z)=>{const B=W(a,b);if(B){const V=W(i,b,nt(R)?W(n,b):R);nt(V)||Z&&Z.defaultChecked||P?qe(i,b,P?V:Gl(B._f)):E(b,V),o.mount&&S()}},Q=(b,P,R,Z,B)=>{let V=!1,ee=!1;const _e={name:b};if(!e.disabled){if(!R||Z){(u.isDirty||p.isDirty)&&(ee=r.isDirty,r.isDirty=_e.isDirty=A(),V=ee!==_e.isDirty);const He=Xs(W(n,b),P);ee=!!W(r.dirtyFields,b),He?ht(r.dirtyFields,b):qe(r.dirtyFields,b,!0),_e.dirtyFields=r.dirtyFields,V=V||(u.dirtyFields||p.dirtyFields)&&ee!==!He}if(R){const He=W(r.touchedFields,b);He||(qe(r.touchedFields,b,R),_e.touchedFields=r.touchedFields,V=V||(u.touchedFields||p.touchedFields)&&He!==R)}V&&B&&f.state.next(_e)}return V?_e:{}},H=(b,P,R,Z)=>{const B=W(r.errors,b),V=(u.isValid||p.isValid)&&Xt(P)&&r.isValid!==P;if(e.delayError&&R?(c=m(()=>C(b,R)),c(e.delayError)):(clearTimeout(h),c=null,R?qe(r.errors,b,R):ht(r.errors,b)),(R?!Xs(B,R):B)||!Rt(Z)||V){const ee={...Z,...V&&Xt(P)?{isValid:P}:{},errors:r.errors,name:b};r={...r,...ee},f.state.next(ee)}},M=async b=>{v(b,!0);const P=await e.resolver(i,e.context,nN(b||l.mount,a,e.criteriaMode,e.shouldUseNativeValidation));return v(b),P},L=async b=>{const{errors:P}=await M(b);if(b)for(const R of b){const Z=W(P,R);Z?qe(r.errors,R,Z):ht(r.errors,R)}else r.errors=P;return P},$=async(b,P,R={valid:!0})=>{for(const Z in b){const B=b[Z];if(B){const{_f:V,...ee}=B;if(V){const _e=l.array.has(V.name),He=B._f&&iN(B._f);He&&u.validatingFields&&v([Z],!0);const O=await sc(B,l.disabled,i,x,e.shouldUseNativeValidation&&!P,_e);if(He&&u.validatingFields&&v([Z]),O[V.name]&&(R.valid=!1,P))break;!P&&(W(O,V.name)?_e?hN(r.errors,O,V.name):qe(r.errors,V.name,O[V.name]):ht(r.errors,V.name))}!Rt(ee)&&await $(ee,P,R)}}return R.valid},w=()=>{for(const b of l.unMount){const P=W(a,b);P&&(P._f.refs?P._f.refs.every(R=>!Fi(R)):!Fi(P._f.ref))&&Ge(b)}l.unMount=new Set},A=(b,P)=>!e.disabled&&(b&&P&&qe(i,b,P),!Xs(Ke(),n)),I=(b,P,R)=>Up(b,l,{...o.mount?i:nt(P)?n:Ss(b)?{[b]:P}:P},R,P),K=b=>yi(W(o.mount?i:n,b,e.shouldUnregister?W(n,b,[]):[])),E=(b,P,R={})=>{const Z=W(a,b);let B=P;if(Z){const V=Z._f;V&&(!V.disabled&&qe(i,b,Wp(P,V)),B=$n(V.ref)&&Mt(P)?"":P,Kp(V.ref)?[...V.ref.options].forEach(ee=>ee.selected=B.includes(ee.value)):V.refs?pn(V.ref)?V.refs.length>1?V.refs.forEach(ee=>(!ee.defaultChecked||!ee.disabled)&&(ee.checked=Array.isArray(B)?!!B.find(_e=>_e===ee.value):B===ee.value)):V.refs[0]&&(V.refs[0].checked=!!B):V.refs.forEach(ee=>ee.checked=ee.value===B):sl(V.ref)?V.ref.value="":(V.ref.value=B,V.ref.type||f.state.next({name:b,values:bt(i)})))}(R.shouldDirty||R.shouldTouch)&&Q(b,B,R.shouldTouch,R.shouldDirty,!0),R.shouldValidate&&Me(b)},U=(b,P,R)=>{for(const Z in P){const B=P[Z],V=`${b}.${Z}`,ee=W(a,V);(l.array.has(b)||it(B)||ee&&!ee._f)&&!wr(B)?U(V,B,R):E(V,B,R)}},te=(b,P,R={})=>{const Z=W(a,b),B=l.array.has(b),V=bt(P);qe(i,b,V),B?(f.array.next({name:b,values:bt(i)}),(u.isDirty||u.dirtyFields||p.isDirty||p.dirtyFields)&&R.shouldDirty&&f.state.next({name:b,dirtyFields:Aa(n,i),isDirty:A(b,V)})):Z&&!Z._f&&!Mt(V)?U(b,V,R):E(b,V,R),Yl(b,l)&&f.state.next({...r}),f.state.next({name:o.mount?b:void 0,values:bt(i)})},q=async b=>{o.mount=!0;const P=b.target;let R=P.name,Z=!0;const B=W(a,R),V=ee=>{Z=Number.isNaN(ee)||wr(ee)&&isNaN(ee.getTime())||Xs(ee,W(i,R,ee))};if(B){let ee,_e;const He=P.type?Gl(B._f):Lp(b),O=b.type===zn.BLUR||b.type===zn.FOCUS_OUT,he=!oN(B._f)&&!e.resolver&&!W(r.errors,R)&&!B._f.deps||dN(O,W(r.touchedFields,R),r.isSubmitted,j,g),Ee=Yl(R,l,O);qe(i,R,He),O?(B._f.onBlur&&B._f.onBlur(b),c&&c(0)):B._f.onChange&&B._f.onChange(b);const Wt=Q(R,He,O),$t=!Rt(Wt)||Ee;if(!O&&f.state.next({name:R,type:b.type,values:bt(i)}),he)return(u.isValid||p.isValid)&&(e.mode==="onBlur"?O&&S():O||S()),$t&&f.state.next({name:R,...Ee?{}:Wt});if(!O&&Ee&&f.state.next({...r}),e.resolver){const{errors:Ur}=await M([R]);if(V(He),Z){const _t=ec(r.errors,a,R),vn=ec(Ur,a,_t.name||R);ee=vn.error,R=vn.name,_e=Rt(Ur)}}else v([R],!0),ee=(await sc(B,l.disabled,i,x,e.shouldUseNativeValidation))[R],v([R]),V(He),Z&&(ee?_e=!1:(u.isValid||p.isValid)&&(_e=await $(a,!0)));Z&&(B._f.deps&&Me(B._f.deps),H(R,_e,ee,Wt))}},ge=(b,P)=>{if(W(r.errors,P)&&b.focus)return b.focus(),1},Me=async(b,P={})=>{let R,Z;const B=za(b);if(e.resolver){const V=await L(nt(b)?b:B);R=Rt(V),Z=b?!B.some(ee=>W(V,ee)):R}else b?(Z=(await Promise.all(B.map(async V=>{const ee=W(a,V);return await $(ee&&ee._f?{[V]:ee}:ee)}))).every(Boolean),!(!Z&&!r.isValid)&&S()):Z=R=await $(a);return f.state.next({...!Ss(b)||(u.isValid||p.isValid)&&R!==r.isValid?{}:{name:b},...e.resolver||!b?{isValid:R}:{},errors:r.errors}),P.shouldFocus&&!Z&&$a(a,ge,b?B:l.mount),Z},Ke=b=>{const P={...o.mount?i:n};return nt(b)?P:Ss(b)?W(P,b):b.map(R=>W(P,R))},Qe=(b,P)=>({invalid:!!W((P||r).errors,b),isDirty:!!W((P||r).dirtyFields,b),error:W((P||r).errors,b),isValidating:!!W(r.validatingFields,b),isTouched:!!W((P||r).touchedFields,b)}),ut=b=>{b&&za(b).forEach(P=>ht(r.errors,P)),f.state.next({errors:b?r.errors:{}})},St=(b,P,R)=>{const Z=(W(a,b,{_f:{}})._f||{}).ref,B=W(r.errors,b)||{},{ref:V,message:ee,type:_e,...He}=B;qe(r.errors,b,{...He,...P,ref:Z}),f.state.next({name:b,errors:r.errors,isValid:!1}),R&&R.shouldFocus&&Z&&Z.focus&&Z.focus()},ss=(b,P)=>hs(b)?f.state.subscribe({next:R=>b(I(void 0,P),R)}):I(b,P,!0),ue=b=>f.state.subscribe({next:P=>{cN(b.name,P.name,b.exact)&&lN(P,b.formState||u,Be,b.reRenderRoot)&&b.callback({values:{...i},...r,...P})}}).unsubscribe,ze=b=>(o.mount=!0,p={...p,...b.formState},ue({...b,formState:p})),Ge=(b,P={})=>{for(const R of b?za(b):l.mount)l.mount.delete(R),l.array.delete(R),P.keepValue||(ht(a,R),ht(i,R)),!P.keepError&&ht(r.errors,R),!P.keepDirty&&ht(r.dirtyFields,R),!P.keepTouched&&ht(r.touchedFields,R),!P.keepIsValidating&&ht(r.validatingFields,R),!e.shouldUnregister&&!P.keepDefaultValue&&ht(n,R);f.state.next({values:bt(i)}),f.state.next({...r,...P.keepDirty?{isDirty:A()}:{}}),!P.keepIsValid&&S()},$e=({disabled:b,name:P})=>{(Xt(b)&&o.mount||b||l.disabled.has(P))&&(b?l.disabled.add(P):l.disabled.delete(P))},Ve=(b,P={})=>{let R=W(a,b);const Z=Xt(P.disabled)||Xt(e.disabled);return qe(a,b,{...R||{},_f:{...R&&R._f?R._f:{ref:{name:b}},name:b,mount:!0,...P}}),l.mount.add(b),R?$e({disabled:Xt(P.disabled)?P.disabled:e.disabled,name:b}):D(b,!0,P.value),{...Z?{disabled:P.disabled||e.disabled}:{},...e.progressive?{required:!!P.required,min:Ea(P.min),max:Ea(P.max),minLength:Ea(P.minLength),maxLength:Ea(P.maxLength),pattern:Ea(P.pattern)}:{},name:b,onChange:q,onBlur:q,ref:B=>{if(B){Ve(b,P),R=W(a,b);const V=nt(B.value)&&B.querySelectorAll&&B.querySelectorAll("input,select,textarea")[0]||B,ee=sN(V),_e=R._f.refs||[];if(ee?_e.find(He=>He===V):V===R._f.ref)return;qe(a,b,{_f:{...R._f,...ee?{refs:[..._e.filter(Fi),V,...Array.isArray(W(n,b))?[{}]:[]],ref:{type:V.type,name:b}}:{ref:V}}}),D(b,!1,void 0,V)}else R=W(a,b,{}),R._f&&(R._f.mount=!1),(e.shouldUnregister||P.shouldUnregister)&&!(Vp(l.array,b)&&o.action)&&l.unMount.add(b)}}},Oe=()=>e.shouldFocusError&&$a(a,ge,l.mount),Zt=b=>{Xt(b)&&(f.state.next({disabled:b}),$a(a,(P,R)=>{const Z=W(a,R);Z&&(P.disabled=Z._f.disabled||b,Array.isArray(Z._f.refs)&&Z._f.refs.forEach(B=>{B.disabled=Z._f.disabled||b}))},0,!1))},ie=(b,P)=>async R=>{let Z;R&&(R.preventDefault&&R.preventDefault(),R.persist&&R.persist());let B=bt(i);if(f.state.next({isSubmitting:!0}),e.resolver){const{errors:V,values:ee}=await M();r.errors=V,B=ee}else await $(a);if(l.disabled.size)for(const V of l.disabled)qe(B,V,void 0);if(ht(r.errors,"root"),Rt(r.errors)){f.state.next({errors:{}});try{await b(B,R)}catch(V){Z=V}}else P&&await P({...r.errors},R),Oe(),setTimeout(Oe);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Rt(r.errors)&&!Z,submitCount:r.submitCount+1,errors:r.errors}),Z)throw Z},pe=(b,P={})=>{W(a,b)&&(nt(P.defaultValue)?te(b,bt(W(n,b))):(te(b,P.defaultValue),qe(n,b,bt(P.defaultValue))),P.keepTouched||ht(r.touchedFields,b),P.keepDirty||(ht(r.dirtyFields,b),r.isDirty=P.defaultValue?A(b,bt(W(n,b))):A()),P.keepError||(ht(r.errors,b),u.isValid&&S()),f.state.next({...r}))},We=(b,P={})=>{const R=b?bt(b):n,Z=bt(R),B=Rt(b),V=B?n:Z;if(P.keepDefaultValues||(n=R),!P.keepValues){if(P.keepDirtyValues){const ee=new Set([...l.mount,...Object.keys(Aa(n,i))]);for(const _e of Array.from(ee))W(r.dirtyFields,_e)?qe(V,_e,W(i,_e)):te(_e,W(V,_e))}else{if(el&&nt(b))for(const ee of l.mount){const _e=W(a,ee);if(_e&&_e._f){const He=Array.isArray(_e._f.refs)?_e._f.refs[0]:_e._f.ref;if($n(He)){const O=He.closest("form");if(O){O.reset();break}}}}for(const ee of l.mount)te(ee,W(V,ee))}i=bt(V),f.array.next({values:{...V}}),f.state.next({values:{...V}})}l={mount:P.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!P.keepIsValid||!!P.keepDirtyValues,o.watch=!!e.shouldUnregister,f.state.next({submitCount:P.keepSubmitCount?r.submitCount:0,isDirty:B?!1:P.keepDirty?r.isDirty:!!(P.keepDefaultValues&&!Xs(b,n)),isSubmitted:P.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:B?{}:P.keepDirtyValues?P.keepDefaultValues&&i?Aa(n,i):r.dirtyFields:P.keepDefaultValues&&b?Aa(n,b):P.keepDirty?r.dirtyFields:{},touchedFields:P.keepTouched?r.touchedFields:{},errors:P.keepErrors?r.errors:{},isSubmitSuccessful:P.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},st=(b,P)=>We(hs(b)?b(i):b,P),kt=(b,P={})=>{const R=W(a,b),Z=R&&R._f;if(Z){const B=Z.refs?Z.refs[0]:Z.ref;B.focus&&(B.focus(),P.shouldSelect&&hs(B.select)&&B.select())}},Be=b=>{r={...r,...b}},Rs={control:{register:Ve,unregister:Ge,getFieldState:Qe,handleSubmit:ie,setError:St,_subscribe:ue,_runSchema:M,_getWatch:I,_getDirty:A,_setValid:S,_setFieldArray:y,_setDisabledField:$e,_setErrors:k,_getFieldArray:K,_reset:We,_resetDefaultValues:()=>hs(e.defaultValues)&&e.defaultValues().then(b=>{st(b,e.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:w,_disableForm:Zt,_subjects:f,_proxyFormState:u,get _fields(){return a},get _formValues(){return i},get _state(){return o},set _state(b){o=b},get _defaultValues(){return n},get _names(){return l},set _names(b){l=b},get _formState(){return r},get _options(){return e},set _options(b){e={...e,...b}}},subscribe:ze,trigger:Me,register:Ve,handleSubmit:ie,watch:ss,setValue:te,getValues:Ke,reset:st,resetField:pe,clearErrors:ut,unregister:Ge,setError:St,setFocus:kt,getFieldState:Qe};return{...Rs,formControl:Rs}}function Ha(t={}){const e=De.useRef(void 0),r=De.useRef(void 0),[a,n]=De.useState({isDirty:!1,isValidating:!1,isLoading:hs(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,defaultValues:hs(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...t.formControl?t.formControl:fN(t),formState:a},t.formControl&&t.defaultValues&&!hs(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions));const i=e.current.control;return i._options=t,De.useLayoutEffect(()=>i._subscribe({formState:i._proxyFormState,callback:()=>n({...i._formState}),reRenderRoot:!0}),[i]),De.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),De.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==a.isDirty&&i._subjects.state.next({isDirty:o})}},[i,a.isDirty]),De.useEffect(()=>{t.values&&!Xs(t.values,r.current)?(i._reset(t.values,i._options.resetOptions),r.current=t.values,n(o=>({...o}))):i._resetDefaultValues()},[t.values,i]),De.useEffect(()=>{t.errors&&!Rt(t.errors)&&i._setErrors(t.errors)},[t.errors,i]),De.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),De.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[t.shouldUnregister,i]),e.current.formState=qp(a,i),e.current}const rc=(t,e,r)=>{if(t&&"reportValidity"in t){const a=W(r,e);t.setCustomValidity(a&&a.message||""),t.reportValidity()}},Xp=(t,e)=>{for(const r in e.fields){const a=e.fields[r];a&&a.ref&&"reportValidity"in a.ref?rc(a.ref,r,t):a.refs&&a.refs.forEach(n=>rc(n,r,t))}},pN=(t,e)=>{e.shouldUseNativeValidation&&Xp(t,e);const r={};for(const a in t){const n=W(e.fields,a),i=Object.assign(t[a]||{},{ref:n&&n.ref});if(gN(e.names||Object.keys(t),a)){const o=Object.assign({},W(r,a));qe(o,"root",i),qe(r,a,o)}else qe(r,a,i)}return r},gN=(t,e)=>t.some(r=>r.startsWith(e+"."));var xN=function(t,e){for(var r={};t.length;){var a=t[0],n=a.code,i=a.message,o=a.path.join(".");if(!r[o])if("unionErrors"in a){var l=a.unionErrors[0].errors[0];r[o]={message:l.message,type:l.code}}else r[o]={message:i,type:n};if("unionErrors"in a&&a.unionErrors.forEach(function(u){return u.errors.forEach(function(p){return t.push(p)})}),e){var c=r[o].types,h=c&&c[a.code];r[o]=Bp(o,e,r,n,h?[].concat(h,a.message):a.message)}t.shift()}return r},Za=function(t,e,r){return r===void 0&&(r={}),function(a,n,i){try{return Promise.resolve(function(o,l){try{var c=Promise.resolve(t[r.mode==="sync"?"parse":"parseAsync"](a,e)).then(function(h){return i.shouldUseNativeValidation&&Xp({},i),{errors:{},values:r.raw?a:h}})}catch(h){return l(h)}return c&&c.then?c.then(void 0,l):c}(0,function(o){if(function(l){return Array.isArray(l==null?void 0:l.errors)}(o))return{values:{},errors:pN(xN(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}};const F=Symbol.for("drizzle:entityKind");function wt(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,F))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(F in r&&r[F]===e[F])return!0;r=Object.getPrototypeOf(r)}return!1}var Pc;Pc=F;class ya{constructor(e,r){_(this,"name");_(this,"keyAsName");_(this,"primary");_(this,"notNull");_(this,"default");_(this,"defaultFn");_(this,"onUpdateFn");_(this,"hasDefault");_(this,"isUnique");_(this,"uniqueName");_(this,"uniqueType");_(this,"dataType");_(this,"columnType");_(this,"enumValues");_(this,"generated");_(this,"generatedIdentity");_(this,"config");this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}_(ya,Pc,"Column");var Ac;Ac=F;class Jp{constructor(e,r,a){_(this,"config");_(this,"$default",this.$defaultFn);_(this,"$onUpdate",this.$onUpdateFn);this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:a,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}_(Jp,Ac,"ColumnBuilder");const Gr=Symbol.for("drizzle:Name");var Ec;Ec=F;class Yp{constructor(e,r){_(this,"reference");_(this,"_onUpdate","no action");_(this,"_onDelete","no action");this.reference=()=>{const{name:a,columns:n,foreignColumns:i}=e();return{name:a,columns:n,foreignTable:i[0].table,foreignColumns:i}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new eg(e,this)}}_(Yp,Ec,"PgForeignKeyBuilder");var Ic;Ic=F;class eg{constructor(e,r){_(this,"reference");_(this,"onUpdate");_(this,"onDelete");this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}getName(){const{name:e,columns:r,foreignColumns:a}=this.reference(),n=r.map(l=>l.name),i=a.map(l=>l.name),o=[this.table[Gr],...n,a[0].table[Gr],...i];return e??`${o.join("_")}_fk`}}_(eg,Ic,"PgForeignKey");function yN(t,...e){return t(...e)}function vN(t,e){return`${t[Gr]}_${e.join("_")}_unique`}function ac(t,e,r){for(let a=e;a<t.length;a++){const n=t[a];if(n==="\\"){a++;continue}if(n==='"')return[t.slice(e,a).replace(/\\/g,""),a+1];if(!r&&(n===","||n==="}"))return[t.slice(e,a).replace(/\\/g,""),a]}return[t.slice(e).replace(/\\/g,""),t.length]}function tg(t,e=0){const r=[];let a=e,n=!1;for(;a<t.length;){const i=t[a];if(i===","){(n||a===e)&&r.push(""),n=!0,a++;continue}if(n=!1,i==="\\"){a+=2;continue}if(i==='"'){const[c,h]=ac(t,a+1,!0);r.push(c),a=h;continue}if(i==="}")return[r,a+1];if(i==="{"){const[c,h]=tg(t,a+1);r.push(c),a=h;continue}const[o,l]=ac(t,a,!1);r.push(o),a=l}return[r,a]}function bN(t){const[e]=tg(t,1);return e}function sg(t){return`{${t.map(e=>Array.isArray(e)?sg(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Rc,Mc;class Le extends(Mc=Jp,Rc=F,Mc){constructor(){super(...arguments);_(this,"foreignKeyConfigs",[])}array(r){return new ag(this.config.name,this,r)}references(r,a={}){return this.foreignKeyConfigs.push({ref:r,actions:a}),this}unique(r,a){return this.config.isUnique=!0,this.config.uniqueName=r,this.config.uniqueType=a==null?void 0:a.nulls,this}generatedAlwaysAs(r){return this.config.generated={as:r,type:"always",mode:"stored"},this}buildForeignKeys(r,a){return this.foreignKeyConfigs.map(({ref:n,actions:i})=>yN((o,l)=>{const c=new Yp(()=>{const h=o();return{columns:[r],foreignColumns:[h]}});return l.onUpdate&&c.onUpdate(l.onUpdate),l.onDelete&&c.onDelete(l.onDelete),c.build(a)},n,i))}buildExtraConfigColumn(r){return new rg(r,this.config)}}_(Le,Rc,"PgColumnBuilder");var Oc,Dc;class be extends(Dc=ya,Oc=F,Dc){constructor(e,r){r.uniqueName||(r.uniqueName=vN(e,[r.name])),super(e,r),this.table=e}}_(be,Oc,"PgColumn");var Fc,Lc;class rg extends(Lc=be,Fc=F,Lc){constructor(){super(...arguments);_(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});_(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(r){return this.indexConfig.opClass=r,this}}_(rg,Fc,"ExtraConfigColumn");var Vc,zc;class ag extends(zc=Le,Vc=F,zc){constructor(e,r,a){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=a}build(e){const r=this.config.baseBuilder.build(e);return new po(e,this.config,r)}}_(ag,Vc,"PgArrayBuilder");var $c,qc;const ni=class ni extends(qc=be,$c=F,qc){constructor(r,a,n,i){super(r,a);_(this,"size");this.baseColumn=n,this.range=i,this.size=a.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(r){return typeof r=="string"&&(r=bN(r)),r.map(a=>this.baseColumn.mapFromDriverValue(a))}mapToDriverValue(r,a=!1){const n=r.map(i=>i===null?null:wt(this.baseColumn,ni)?this.baseColumn.mapToDriverValue(i,!0):this.baseColumn.mapToDriverValue(i));return a?n:sg(n)}};_(ni,$c,"PgArray");let po=ni;const nc=Symbol.for("drizzle:isPgEnum");function wN(t){return!!t&&typeof t=="function"&&nc in t&&t[nc]===!0}var Uc;Uc=F;class al{constructor(e,r,a,n=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:a,isWith:n}}}_(al,Uc,"Subquery");const jN={startActiveSpan(t,e){return e()}},Xr=Symbol.for("drizzle:ViewBaseConfig"),Li=Symbol.for("drizzle:Schema"),ic=Symbol.for("drizzle:Columns"),oc=Symbol.for("drizzle:ExtraConfigColumns"),Vi=Symbol.for("drizzle:OriginalName"),zi=Symbol.for("drizzle:BaseName"),Bn=Symbol.for("drizzle:IsAlias"),lc=Symbol.for("drizzle:ExtraConfigBuilder"),ng=Symbol.for("drizzle:IsDrizzleTable");var Bc,Kc,Qc,Hc,Zc,Wc,Gc,Xc,Jc,Yc;Yc=F,Jc=Gr,Xc=Vi,Gc=Li,Wc=ic,Zc=oc,Hc=zi,Qc=Bn,Kc=ng,Bc=lc;class Ot{constructor(e,r,a){_(this,Jc);_(this,Xc);_(this,Gc);_(this,Wc);_(this,Zc);_(this,Hc);_(this,Qc,!1);_(this,Kc,!0);_(this,Bc);this[Gr]=this[Vi]=e,this[Li]=r,this[zi]=a}}_(Ot,Yc,"Table"),_(Ot,"Symbol",{Name:Gr,Schema:Li,OriginalName:Vi,Columns:ic,ExtraConfigColumns:oc,BaseName:zi,IsAlias:Bn,ExtraConfigBuilder:lc});function ig(t){return typeof t=="object"&&t!==null&&ng in t}function NN(t){return t!=null&&typeof t.getSQL=="function"}function SN(t){var r;const e={sql:"",params:[]};for(const a of t)e.sql+=a.sql,e.params.push(...a.params),(r=a.typings)!=null&&r.length&&(e.typings||(e.typings=[]),e.typings.push(...a.typings));return e}var ed;ed=F;class ns{constructor(e){_(this,"value");this.value=Array.isArray(e)?e:[e]}getSQL(){return new pt([this])}}_(ns,ed,"StringChunk");var td;td=F;const br=class br{constructor(e){_(this,"decoder",og);_(this,"shouldInlineParams",!1);this.queryChunks=e}append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return jN.startActiveSpan("drizzle.buildSQL",r=>{const a=this.buildQueryFromSourceParams(this.queryChunks,e);return r==null||r.setAttributes({"drizzle.query.text":a.sql,"drizzle.query.params":JSON.stringify(a.params)}),a})}buildQueryFromSourceParams(e,r){const a=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:n,escapeName:i,escapeParam:o,prepareTyping:l,inlineParams:c,paramStartIndex:h}=a;return SN(e.map(u=>{var p;if(wt(u,ns))return{sql:u.value.join(""),params:[]};if(wt(u,Kn))return{sql:i(u.value),params:[]};if(u===void 0)return{sql:"",params:[]};if(Array.isArray(u)){const f=[new ns("(")];for(const[g,j]of u.entries())f.push(j),g<u.length-1&&f.push(new ns(", "));return f.push(new ns(")")),this.buildQueryFromSourceParams(f,a)}if(wt(u,br))return this.buildQueryFromSourceParams(u.queryChunks,{...a,inlineParams:c||u.shouldInlineParams});if(wt(u,Ot)){const f=u[Ot.Symbol.Schema],g=u[Ot.Symbol.Name];return{sql:f===void 0||u[Bn]?i(g):i(f)+"."+i(g),params:[]}}if(wt(u,ya)){const f=n.getColumnCasing(u);if(r.invokeSource==="indexes")return{sql:i(f),params:[]};const g=u.table[Ot.Symbol.Schema];return{sql:u.table[Bn]||g===void 0?i(u.table[Ot.Symbol.Name])+"."+i(f):i(g)+"."+i(u.table[Ot.Symbol.Name])+"."+i(f),params:[]}}if(wt(u,dg)){const f=u[Xr].schema,g=u[Xr].name;return{sql:f===void 0||u[Xr].isAlias?i(g):i(f)+"."+i(g),params:[]}}if(wt(u,nl)){if(wt(u.value,Qn))return{sql:o(h.value++,u),params:[u],typings:["none"]};const f=u.value===null?null:u.encoder.mapToDriverValue(u.value);if(wt(f,br))return this.buildQueryFromSourceParams([f],a);if(c)return{sql:this.mapInlineParam(f,a),params:[]};let g=["none"];return l&&(g=[l(u.encoder)]),{sql:o(h.value++,f),params:[f],typings:g}}return wt(u,Qn)?{sql:o(h.value++,u),params:[u],typings:["none"]}:wt(u,br.Aliased)&&u.fieldAlias!==void 0?{sql:i(u.fieldAlias),params:[]}:wt(u,al)?u._.isWith?{sql:i(u._.alias),params:[]}:this.buildQueryFromSourceParams([new ns("("),u._.sql,new ns(") "),new Kn(u._.alias)],a):wN(u)?u.schema?{sql:i(u.schema)+"."+i(u.enumName),params:[]}:{sql:i(u.enumName),params:[]}:NN(u)?(p=u.shouldOmitSQLParens)!=null&&p.call(u)?this.buildQueryFromSourceParams([u.getSQL()],a):this.buildQueryFromSourceParams([new ns("("),u.getSQL(),new ns(")")],a):c?{sql:this.mapInlineParam(u,a),params:[]}:{sql:o(h.value++,u),params:[u],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){const a=e.toString();return r(a==="[object Object]"?JSON.stringify(e):a)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new br.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}};_(br,td,"SQL");let pt=br;var sd;sd=F;class Kn{constructor(e){_(this,"brand");this.value=e}getSQL(){return new pt([this])}}_(Kn,sd,"Name");const og={mapFromDriverValue:t=>t},lg={mapToDriverValue:t=>t};({...og,...lg});var rd;rd=F;class nl{constructor(e,r=lg){_(this,"brand");this.value=e,this.encoder=r}getSQL(){return new pt([this])}}_(nl,rd,"Param");function tt(t,...e){const r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new ns(t[0]));for(const[a,n]of e.entries())r.push(n,new ns(t[a+1]));return new pt(r)}(t=>{function e(){return new pt([])}t.empty=e;function r(c){return new pt(c)}t.fromList=r;function a(c){return new pt([new ns(c)])}t.raw=a;function n(c,h){const u=[];for(const[p,f]of c.entries())p>0&&h!==void 0&&u.push(h),u.push(f);return new pt(u)}t.join=n;function i(c){return new Kn(c)}t.identifier=i;function o(c){return new Qn(c)}t.placeholder=o;function l(c,h){return new nl(c,h)}t.param=l})(tt||(tt={}));(t=>{var r;r=F;const a=class a{constructor(i,o){_(this,"isSelectionField",!1);this.sql=i,this.fieldAlias=o}getSQL(){return this.sql}clone(){return new a(this.sql,this.fieldAlias)}};_(a,r,"SQL.Aliased");let e=a;t.Aliased=e})(pt||(pt={}));var ad;ad=F;class Qn{constructor(e){this.name=e}getSQL(){return new pt([this])}}_(Qn,ad,"Placeholder");const cg=Symbol.for("drizzle:IsDrizzleView");var nd,id,od;od=F,id=Xr,nd=cg;class dg{constructor({name:e,schema:r,selectedFields:a,query:n}){_(this,id);_(this,nd,!0);this[Xr]={name:e,originalName:e,schema:r,selectedFields:a,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new pt([this])}}_(dg,od,"View");function kN(t){return typeof t=="object"&&t!==null&&cg in t}ya.prototype.getSQL=function(){return new pt([this])};Ot.prototype.getSQL=function(){return new pt([this])};al.prototype.getSQL=function(){return new pt([this])};function CN(t){return t[Ot.Symbol.Columns]}function _N(t){return t[Xr].selectedFields}function vt(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}var ld,cd;class gn extends(cd=Le,ld=F,cd){generatedAlwaysAsIdentity(e){if(e){const{name:r,...a}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:a}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){const{name:r,...a}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:a}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}_(gn,ld,"PgIntColumnBaseBuilder");var dd,ud;class ug extends(ud=gn,dd=F,ud){constructor(e){super(e,"number","PgBigInt53")}build(e){return new hg(e,this.config)}}_(ug,dd,"PgBigInt53Builder");var hd,md;class hg extends(md=be,hd=F,md){getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}_(hg,hd,"PgBigInt53");var fd,pd;class mg extends(pd=gn,fd=F,pd){constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new fg(e,this.config)}}_(mg,fd,"PgBigInt64Builder");var gd,xd;class fg extends(xd=be,gd=F,xd){getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}_(fg,gd,"PgBigInt64");function TN(t,e){const{name:r,config:a}=vt(t,e);return a.mode==="number"?new ug(r):new mg(r)}var yd,vd;class pg extends(vd=Le,yd=F,vd){constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new gg(e,this.config)}}_(pg,yd,"PgBigSerial53Builder");var bd,wd;class gg extends(wd=be,bd=F,wd){getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}_(gg,bd,"PgBigSerial53");var jd,Nd;class xg extends(Nd=Le,jd=F,Nd){constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new yg(e,this.config)}}_(xg,jd,"PgBigSerial64Builder");var Sd,kd;class yg extends(kd=be,Sd=F,kd){getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}_(yg,Sd,"PgBigSerial64");function PN(t,e){const{name:r,config:a}=vt(t,e);return a.mode==="number"?new pg(r):new xg(r)}var Cd,_d;class vg extends(_d=Le,Cd=F,_d){constructor(e){super(e,"boolean","PgBoolean")}build(e){return new bg(e,this.config)}}_(vg,Cd,"PgBooleanBuilder");var Td,Pd;class bg extends(Pd=be,Td=F,Pd){getSQLType(){return"boolean"}}_(bg,Td,"PgBoolean");function Pt(t){return new vg(t??"")}var Ad,Ed;class wg extends(Ed=Le,Ad=F,Ed){constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new jg(e,this.config)}}_(wg,Ad,"PgCharBuilder");var Id,Rd;class jg extends(Rd=be,Id=F,Rd){constructor(){super(...arguments);_(this,"length",this.config.length);_(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}_(jg,Id,"PgChar");function AN(t,e={}){const{name:r,config:a}=vt(t,e);return new wg(r,a)}var Md,Od;class Ng extends(Od=Le,Md=F,Od){constructor(e){super(e,"string","PgCidr")}build(e){return new Sg(e,this.config)}}_(Ng,Md,"PgCidrBuilder");var Dd,Fd;class Sg extends(Fd=be,Dd=F,Fd){getSQLType(){return"cidr"}}_(Sg,Dd,"PgCidr");function EN(t){return new Ng(t??"")}var Ld,Vd;class kg extends(Vd=Le,Ld=F,Vd){constructor(e,r,a){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=a}build(e){return new Cg(e,this.config)}}_(kg,Ld,"PgCustomColumnBuilder");var zd,$d;class Cg extends($d=be,zd=F,$d){constructor(r,a){super(r,a);_(this,"sqlName");_(this,"mapTo");_(this,"mapFrom");this.sqlName=a.customTypeParams.dataType(a.fieldConfig),this.mapTo=a.customTypeParams.toDriver,this.mapFrom=a.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(r){return typeof this.mapFrom=="function"?this.mapFrom(r):r}mapToDriverValue(r){return typeof this.mapTo=="function"?this.mapTo(r):r}}_(Cg,zd,"PgCustomColumn");function IN(t){return(e,r)=>{const{name:a,config:n}=vt(e,r);return new kg(a,n,t)}}var qd,Ud;class Ca extends(Ud=Le,qd=F,Ud){defaultNow(){return this.default(tt`now()`)}}_(Ca,qd,"PgDateColumnBaseBuilder");var Bd,Kd;class _g extends(Kd=Ca,Bd=F,Kd){constructor(e){super(e,"date","PgDate")}build(e){return new Tg(e,this.config)}}_(_g,Bd,"PgDateBuilder");var Qd,Hd;class Tg extends(Hd=be,Qd=F,Hd){getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}_(Tg,Qd,"PgDate");var Zd,Wd;class Pg extends(Wd=Ca,Zd=F,Wd){constructor(e){super(e,"string","PgDateString")}build(e){return new Ag(e,this.config)}}_(Pg,Zd,"PgDateStringBuilder");var Gd,Xd;class Ag extends(Xd=be,Gd=F,Xd){getSQLType(){return"date"}}_(Ag,Gd,"PgDateString");function RN(t,e){const{name:r,config:a}=vt(t,e);return(a==null?void 0:a.mode)==="date"?new _g(r):new Pg(r)}var Jd,Yd;class Eg extends(Yd=Le,Jd=F,Yd){constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new Ig(e,this.config)}}_(Eg,Jd,"PgDoublePrecisionBuilder");var eu,tu;class Ig extends(tu=be,eu=F,tu){getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}_(Ig,eu,"PgDoublePrecision");function MN(t){return new Eg(t??"")}var su,ru;class Rg extends(ru=Le,su=F,ru){constructor(e){super(e,"string","PgInet")}build(e){return new Mg(e,this.config)}}_(Rg,su,"PgInetBuilder");var au,nu;class Mg extends(nu=be,au=F,nu){getSQLType(){return"inet"}}_(Mg,au,"PgInet");function ON(t){return new Rg(t??"")}var iu,ou;class Og extends(ou=gn,iu=F,ou){constructor(e){super(e,"number","PgInteger")}build(e){return new Dg(e,this.config)}}_(Og,iu,"PgIntegerBuilder");var lu,cu;class Dg extends(cu=be,lu=F,cu){getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}_(Dg,lu,"PgInteger");function il(t){return new Og(t??"")}var du,uu;class Fg extends(uu=Le,du=F,uu){constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new Lg(e,this.config)}}_(Fg,du,"PgIntervalBuilder");var hu,mu;class Lg extends(mu=be,hu=F,mu){constructor(){super(...arguments);_(this,"fields",this.config.intervalConfig.fields);_(this,"precision",this.config.intervalConfig.precision)}getSQLType(){const r=this.fields?` ${this.fields}`:"",a=this.precision?`(${this.precision})`:"";return`interval${r}${a}`}}_(Lg,hu,"PgInterval");function DN(t,e={}){const{name:r,config:a}=vt(t,e);return new Fg(r,a)}var fu,pu;class Vg extends(pu=Le,fu=F,pu){constructor(e){super(e,"json","PgJson")}build(e){return new zg(e,this.config)}}_(Vg,fu,"PgJsonBuilder");var gu,xu;class zg extends(xu=be,gu=F,xu){constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}_(zg,gu,"PgJson");function FN(t){return new Vg(t??"")}var yu,vu;class $g extends(vu=Le,yu=F,vu){constructor(e){super(e,"json","PgJsonb")}build(e){return new qg(e,this.config)}}_($g,yu,"PgJsonbBuilder");var bu,wu;class qg extends(wu=be,bu=F,wu){constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}_(qg,bu,"PgJsonb");function bi(t){return new $g(t??"")}var ju,Nu;class Ug extends(Nu=Le,ju=F,Nu){constructor(e){super(e,"array","PgLine")}build(e){return new Bg(e,this.config)}}_(Ug,ju,"PgLineBuilder");var Su,ku;class Bg extends(ku=be,Su=F,ku){getSQLType(){return"line"}mapFromDriverValue(e){const[r,a,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(a),Number.parseFloat(n)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}_(Bg,Su,"PgLine");var Cu,_u;class Kg extends(_u=Le,Cu=F,_u){constructor(e){super(e,"json","PgLineABC")}build(e){return new Qg(e,this.config)}}_(Kg,Cu,"PgLineABCBuilder");var Tu,Pu;class Qg extends(Pu=be,Tu=F,Pu){getSQLType(){return"line"}mapFromDriverValue(e){const[r,a,n]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(a),c:Number.parseFloat(n)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}_(Qg,Tu,"PgLineABC");function LN(t,e){const{name:r,config:a}=vt(t,e);return!(a!=null&&a.mode)||a.mode==="tuple"?new Ug(r):new Kg(r)}var Au,Eu;class Hg extends(Eu=Le,Au=F,Eu){constructor(e){super(e,"string","PgMacaddr")}build(e){return new Zg(e,this.config)}}_(Hg,Au,"PgMacaddrBuilder");var Iu,Ru;class Zg extends(Ru=be,Iu=F,Ru){getSQLType(){return"macaddr"}}_(Zg,Iu,"PgMacaddr");function VN(t){return new Hg(t??"")}var Mu,Ou;class Wg extends(Ou=Le,Mu=F,Ou){constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Gg(e,this.config)}}_(Wg,Mu,"PgMacaddr8Builder");var Du,Fu;class Gg extends(Fu=be,Du=F,Fu){getSQLType(){return"macaddr8"}}_(Gg,Du,"PgMacaddr8");function zN(t){return new Wg(t??"")}var Lu,Vu;class Xg extends(Vu=Le,Lu=F,Vu){constructor(e,r,a){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=a}build(e){return new Jg(e,this.config)}}_(Xg,Lu,"PgNumericBuilder");var zu,$u;class Jg extends($u=be,zu=F,$u){constructor(r,a){super(r,a);_(this,"precision");_(this,"scale");this.precision=a.precision,this.scale=a.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}_(Jg,zu,"PgNumeric");function Yg(t,e){const{name:r,config:a}=vt(t,e);return new Xg(r,a==null?void 0:a.precision,a==null?void 0:a.scale)}const Ks=Yg;var qu,Uu;class ex extends(Uu=Le,qu=F,Uu){constructor(e){super(e,"array","PgPointTuple")}build(e){return new tx(e,this.config)}}_(ex,qu,"PgPointTupleBuilder");var Bu,Ku;class tx extends(Ku=be,Bu=F,Ku){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,a]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(a)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}_(tx,Bu,"PgPointTuple");var Qu,Hu;class sx extends(Hu=Le,Qu=F,Hu){constructor(e){super(e,"json","PgPointObject")}build(e){return new rx(e,this.config)}}_(sx,Qu,"PgPointObjectBuilder");var Zu,Wu;class rx extends(Wu=be,Zu=F,Wu){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,a]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(a)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}_(rx,Zu,"PgPointObject");function $N(t,e){const{name:r,config:a}=vt(t,e);return!(a!=null&&a.mode)||a.mode==="tuple"?new ex(r):new sx(r)}function qN(t){const e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function cc(t,e){const r=new ArrayBuffer(8),a=new DataView(r);for(let n=0;n<8;n++)a.setUint8(n,t[e+n]);return a.getFloat64(0,!0)}function ax(t){const e=qN(t);let r=0;const a=e[r];r+=1;const n=new DataView(e.buffer),i=n.getUint32(r,a===1);if(r+=4,i&536870912&&(n.getUint32(r,a===1),r+=4),(i&65535)===1){const o=cc(e,r);r+=8;const l=cc(e,r);return r+=8,[o,l]}throw new Error("Unsupported geometry type")}var Gu,Xu;class nx extends(Xu=Le,Gu=F,Xu){constructor(e){super(e,"array","PgGeometry")}build(e){return new ix(e,this.config)}}_(nx,Gu,"PgGeometryBuilder");var Ju,Yu;class ix extends(Yu=be,Ju=F,Yu){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return ax(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}_(ix,Ju,"PgGeometry");var eh,th;class ox extends(th=Le,eh=F,th){constructor(e){super(e,"json","PgGeometryObject")}build(e){return new lx(e,this.config)}}_(ox,eh,"PgGeometryObjectBuilder");var sh,rh;class lx extends(rh=be,sh=F,rh){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){const r=ax(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}_(lx,sh,"PgGeometryObject");function UN(t,e){const{name:r,config:a}=vt(t,e);return!(a!=null&&a.mode)||a.mode==="tuple"?new nx(r):new ox(r)}var ah,nh;class cx extends(nh=Le,ah=F,nh){constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new dx(e,this.config)}}_(cx,ah,"PgRealBuilder");var ih,oh;class dx extends(oh=be,ih=F,oh){constructor(r,a){super(r,a);_(this,"mapFromDriverValue",r=>typeof r=="string"?Number.parseFloat(r):r)}getSQLType(){return"real"}}_(dx,ih,"PgReal");function BN(t){return new cx(t??"")}var lh,ch;class ux extends(ch=Le,lh=F,ch){constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new hx(e,this.config)}}_(ux,lh,"PgSerialBuilder");var dh,uh;class hx extends(uh=be,dh=F,uh){getSQLType(){return"serial"}}_(hx,dh,"PgSerial");function KN(t){return new ux(t??"")}var hh,mh;class mx extends(mh=gn,hh=F,mh){constructor(e){super(e,"number","PgSmallInt")}build(e){return new fx(e,this.config)}}_(mx,hh,"PgSmallIntBuilder");var fh,ph;class fx extends(ph=be,fh=F,ph){constructor(){super(...arguments);_(this,"mapFromDriverValue",r=>typeof r=="string"?Number(r):r)}getSQLType(){return"smallint"}}_(fx,fh,"PgSmallInt");function QN(t){return new mx(t??"")}var gh,xh;class px extends(xh=Le,gh=F,xh){constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new gx(e,this.config)}}_(px,gh,"PgSmallSerialBuilder");var yh,vh;class gx extends(vh=be,yh=F,vh){getSQLType(){return"smallserial"}}_(gx,yh,"PgSmallSerial");function HN(t){return new px(t??"")}var bh,wh;class xx extends(wh=Le,bh=F,wh){constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new yx(e,this.config)}}_(xx,bh,"PgTextBuilder");var jh,Nh;class yx extends(Nh=be,jh=F,Nh){constructor(){super(...arguments);_(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}}_(yx,jh,"PgText");function ae(t,e={}){const{name:r,config:a}=vt(t,e);return new xx(r,a)}var Sh,kh;class vx extends(kh=Ca,Sh=F,kh){constructor(e,r,a){super(e,"string","PgTime"),this.withTimezone=r,this.precision=a,this.config.withTimezone=r,this.config.precision=a}build(e){return new bx(e,this.config)}}_(vx,Sh,"PgTimeBuilder");var Ch,_h;class bx extends(_h=be,Ch=F,_h){constructor(r,a){super(r,a);_(this,"withTimezone");_(this,"precision");this.withTimezone=a.withTimezone,this.precision=a.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}_(bx,Ch,"PgTime");function ZN(t,e={}){const{name:r,config:a}=vt(t,e);return new vx(r,a.withTimezone??!1,a.precision)}var Th,Ph;class wx extends(Ph=Ca,Th=F,Ph){constructor(e,r,a){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=a}build(e){return new jx(e,this.config)}}_(wx,Th,"PgTimestampBuilder");var Ah,Eh;class jx extends(Eh=be,Ah=F,Eh){constructor(r,a){super(r,a);_(this,"withTimezone");_(this,"precision");_(this,"mapFromDriverValue",r=>new Date(this.withTimezone?r:r+"+0000"));_(this,"mapToDriverValue",r=>r.toISOString());this.withTimezone=a.withTimezone,this.precision=a.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}}_(jx,Ah,"PgTimestamp");var Ih,Rh;class Nx extends(Rh=Ca,Ih=F,Rh){constructor(e,r,a){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=a}build(e){return new Sx(e,this.config)}}_(Nx,Ih,"PgTimestampStringBuilder");var Mh,Oh;class Sx extends(Oh=be,Mh=F,Oh){constructor(r,a){super(r,a);_(this,"withTimezone");_(this,"precision");this.withTimezone=a.withTimezone,this.precision=a.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}_(Sx,Mh,"PgTimestampString");function je(t,e={}){const{name:r,config:a}=vt(t,e);return(a==null?void 0:a.mode)==="string"?new Nx(r,a.withTimezone??!1,a.precision):new wx(r,(a==null?void 0:a.withTimezone)??!1,a==null?void 0:a.precision)}var Dh,Fh;class kx extends(Fh=Le,Dh=F,Fh){constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(tt`gen_random_uuid()`)}build(e){return new Cx(e,this.config)}}_(kx,Dh,"PgUUIDBuilder");var Lh,Vh;class Cx extends(Vh=be,Lh=F,Vh){getSQLType(){return"uuid"}}_(Cx,Lh,"PgUUID");function WN(t){return new kx(t??"")}var zh,$h;class _x extends($h=Le,zh=F,$h){constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new Tx(e,this.config)}}_(_x,zh,"PgVarcharBuilder");var qh,Uh;class Tx extends(Uh=be,qh=F,Uh){constructor(){super(...arguments);_(this,"length",this.config.length);_(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}_(Tx,qh,"PgVarchar");function ne(t,e={}){const{name:r,config:a}=vt(t,e);return new _x(r,a)}var Bh,Kh;class Px extends(Kh=Le,Bh=F,Kh){constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new Ax(e,this.config)}}_(Px,Bh,"PgBinaryVectorBuilder");var Qh,Hh;class Ax extends(Hh=be,Qh=F,Hh){constructor(){super(...arguments);_(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}}_(Ax,Qh,"PgBinaryVector");function GN(t,e){const{name:r,config:a}=vt(t,e);return new Px(r,a)}var Zh,Wh;class Ex extends(Wh=Le,Zh=F,Wh){constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){return new Ix(e,this.config)}}_(Ex,Zh,"PgHalfVectorBuilder");var Gh,Xh;class Ix extends(Xh=be,Gh=F,Xh){constructor(){super(...arguments);_(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}_(Ix,Gh,"PgHalfVector");function XN(t,e){const{name:r,config:a}=vt(t,e);return new Ex(r,a)}var Jh,Yh;class Rx extends(Yh=Le,Jh=F,Yh){constructor(e,r){super(e,"string","PgSparseVector"),this.config.dimensions=r.dimensions}build(e){return new Mx(e,this.config)}}_(Rx,Jh,"PgSparseVectorBuilder");var em,tm;class Mx extends(tm=be,em=F,tm){constructor(){super(...arguments);_(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}}_(Mx,em,"PgSparseVector");function JN(t,e){const{name:r,config:a}=vt(t,e);return new Rx(r,a)}var sm,rm;class Ox extends(rm=Le,sm=F,rm){constructor(e,r){super(e,"array","PgVector"),this.config.dimensions=r.dimensions}build(e){return new Dx(e,this.config)}}_(Ox,sm,"PgVectorBuilder");var am,nm;class Dx extends(nm=be,am=F,nm){constructor(){super(...arguments);_(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}_(Dx,am,"PgVector");function YN(t,e){const{name:r,config:a}=vt(t,e);return new Ox(r,a)}function e1(){return{bigint:TN,bigserial:PN,boolean:Pt,char:AN,cidr:EN,customType:IN,date:RN,doublePrecision:MN,inet:ON,integer:il,interval:DN,json:FN,jsonb:bi,line:LN,macaddr:VN,macaddr8:zN,numeric:Yg,point:$N,geometry:UN,real:BN,serial:KN,smallint:QN,smallserial:HN,text:ae,time:ZN,timestamp:je,uuid:WN,varchar:ne,bit:GN,halfvec:XN,sparsevec:JN,vector:YN}}const go=Symbol.for("drizzle:PgInlineForeignKeys"),dc=Symbol.for("drizzle:EnableRLS");var im,om,lm,cm,dm;class Hn extends(dm=Ot,cm=F,lm=go,om=dc,im=Ot.Symbol.ExtraConfigBuilder,dm){constructor(){super(...arguments);_(this,lm,[]);_(this,om,!1);_(this,im)}}_(Hn,cm,"PgTable"),_(Hn,"Symbol",Object.assign({},Ot.Symbol,{InlineForeignKeys:go,EnableRLS:dc}));function t1(t,e,r,a,n=t){const i=new Hn(t,a,n),o=typeof e=="function"?e(e1()):e,l=Object.fromEntries(Object.entries(o).map(([u,p])=>{const f=p;f.setName(u);const g=f.build(i);return i[go].push(...f.buildForeignKeys(g,i)),[u,g]})),c=Object.fromEntries(Object.entries(o).map(([u,p])=>{const f=p;f.setName(u);const g=f.buildExtraConfigColumn(i);return[u,g]})),h=Object.assign(i,l);return h[Ot.Symbol.Columns]=l,h[Ot.Symbol.ExtraConfigColumns]=c,Object.assign(h,{enableRLS:()=>(h[Hn.Symbol.EnableRLS]=!0,h)})}const ct=(t,e,r)=>t1(t,e,r,void 0);var Fe;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function r(n){throw new Error}t.assertNever=r,t.arrayToEnum=n=>{const i={};for(const o of n)i[o]=o;return i},t.getValidEnumValues=n=>{const i=t.objectKeys(n).filter(l=>typeof n[n[l]]!="number"),o={};for(const l of i)o[l]=n[l];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.push(o);return i},t.find=(n,i)=>{for(const o of n)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function a(n,i=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=a,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(Fe||(Fe={}));var xo;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(xo||(xo={}));const Y=Fe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ls=t=>{switch(typeof t){case"undefined":return Y.undefined;case"string":return Y.string;case"number":return isNaN(t)?Y.nan:Y.number;case"boolean":return Y.boolean;case"function":return Y.function;case"bigint":return Y.bigint;case"symbol":return Y.symbol;case"object":return Array.isArray(t)?Y.array:t===null?Y.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Y.promise:typeof Map<"u"&&t instanceof Map?Y.map:typeof Set<"u"&&t instanceof Set?Y.set:typeof Date<"u"&&t instanceof Date?Y.date:Y.object;default:return Y.unknown}},z=Fe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),s1=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class es extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(i){return i.message},a={_errors:[]},n=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)a._errors.push(r(o));else{let l=a,c=0;for(;c<o.path.length;){const h=o.path[c];c===o.path.length-1?(l[h]=l[h]||{_errors:[]},l[h]._errors.push(r(o))):l[h]=l[h]||{_errors:[]},l=l[h],c++}}};return n(this),a}static assert(e){if(!(e instanceof es))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Fe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},a=[];for(const n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):a.push(e(n));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}}es.create=t=>new es(t);const va=(t,e)=>{let r;switch(t.code){case z.invalid_type:t.received===Y.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case z.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Fe.jsonStringifyReplacer)}`;break;case z.unrecognized_keys:r=`Unrecognized key(s) in object: ${Fe.joinValues(t.keys,", ")}`;break;case z.invalid_union:r="Invalid input";break;case z.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Fe.joinValues(t.options)}`;break;case z.invalid_enum_value:r=`Invalid enum value. Expected ${Fe.joinValues(t.options)}, received '${t.received}'`;break;case z.invalid_arguments:r="Invalid function arguments";break;case z.invalid_return_type:r="Invalid function return type";break;case z.invalid_date:r="Invalid date";break;case z.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Fe.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case z.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case z.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case z.custom:r="Invalid input";break;case z.invalid_intersection_types:r="Intersection results could not be merged";break;case z.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case z.not_finite:r="Number must be finite";break;default:r=e.defaultError,Fe.assertNever(t)}return{message:r}};let Fx=va;function r1(t){Fx=t}function Zn(){return Fx}const Wn=t=>{const{data:e,path:r,errorMaps:a,issueData:n}=t,i=[...r,...n.path||[]],o={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let l="";const c=a.filter(h=>!!h).slice().reverse();for(const h of c)l=h(o,{data:e,defaultError:l}).message;return{...n,path:i,message:l}},a1=[];function G(t,e){const r=Zn(),a=Wn({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===va?void 0:va].filter(n=>!!n)});t.common.issues.push(a)}class At{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const a=[];for(const n of r){if(n.status==="aborted")return fe;n.status==="dirty"&&e.dirty(),a.push(n.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,r){const a=[];for(const n of r){const i=await n.key,o=await n.value;a.push({key:i,value:o})}return At.mergeObjectSync(e,a)}static mergeObjectSync(e,r){const a={};for(const n of r){const{key:i,value:o}=n;if(i.status==="aborted"||o.status==="aborted")return fe;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(a[i.value]=o.value)}return{status:e.value,value:a}}}const fe=Object.freeze({status:"aborted"}),Qr=t=>({status:"dirty",value:t}),zt=t=>({status:"valid",value:t}),yo=t=>t.status==="aborted",vo=t=>t.status==="dirty",Fr=t=>t.status==="valid",Wa=t=>typeof Promise<"u"&&t instanceof Promise;function Gn(t,e,r,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function Lx(t,e,r,a,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r}var re;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(re||(re={}));var Ma,Oa;class Ts{constructor(e,r,a,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=a,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const uc=(t,e)=>{if(Fr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new es(t.common.issues);return this._error=r,this._error}}};function ve(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:a,description:n}=t;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(o,l)=>{var c,h;const{message:u}=t;return o.code==="invalid_enum_value"?{message:u??l.defaultError}:typeof l.data>"u"?{message:(c=u??a)!==null&&c!==void 0?c:l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:(h=u??r)!==null&&h!==void 0?h:l.defaultError}},description:n}}class ke{get description(){return this._def.description}_getType(e){return Ls(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ls(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new At,ctx:{common:e.parent.common,data:e.data,parsedType:Ls(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Wa(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const a=this.safeParse(e,r);if(a.success)return a.data;throw a.error}safeParse(e,r){var a;const n={common:{issues:[],async:(a=r==null?void 0:r.async)!==null&&a!==void 0?a:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ls(e)},i=this._parseSync({data:e,path:n.path,parent:n});return uc(n,i)}"~validate"(e){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ls(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return Fr(i)?{value:i.value}:{issues:n.common.issues}}catch(i){!((a=(r=i==null?void 0:i.message)===null||r===void 0?void 0:r.toLowerCase())===null||a===void 0)&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>Fr(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,r){const a=await this.safeParseAsync(e,r);if(a.success)return a.data;throw a.error}async safeParseAsync(e,r){const a={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ls(e)},n=this._parse({data:e,path:a.path,parent:a}),i=await(Wa(n)?n:Promise.resolve(n));return uc(a,i)}refine(e,r){const a=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,i)=>{const o=e(n),l=()=>i.addIssue({code:z.custom,...a(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,r){return this._refinement((a,n)=>e(a)?!0:(n.addIssue(typeof r=="function"?r(a,n):r),!1))}_refinement(e){return new xs({schema:this,typeName:me.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return ks.create(this,this._def)}nullable(){return fr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ps.create(this)}promise(){return wa.create(this,this._def)}or(e){return Ya.create([this,e],this._def)}and(e){return en.create(this,e,this._def)}transform(e){return new xs({...ve(this._def),schema:this,typeName:me.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new nn({...ve(this._def),innerType:this,defaultValue:r,typeName:me.ZodDefault})}brand(){return new ol({typeName:me.ZodBranded,type:this,...ve(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new on({...ve(this._def),innerType:this,catchValue:r,typeName:me.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return xn.create(this,e)}readonly(){return ln.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const n1=/^c[^\s-]{8,}$/i,i1=/^[0-9a-z]+$/,o1=/^[0-9A-HJKMNP-TV-Z]{26}$/i,l1=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,c1=/^[a-z0-9_-]{21}$/i,d1=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,u1=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,h1=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,m1="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let $i;const f1=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,p1=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,g1=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,x1=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,y1=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,v1=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Vx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",b1=new RegExp(`^${Vx}$`);function zx(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function w1(t){return new RegExp(`^${zx(t)}$`)}function $x(t){let e=`${Vx}T${zx(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function j1(t,e){return!!((e==="v4"||!e)&&f1.test(t)||(e==="v6"||!e)&&g1.test(t))}function N1(t,e){if(!d1.test(t))return!1;try{const[r]=t.split("."),a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(a));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function S1(t,e){return!!((e==="v4"||!e)&&p1.test(t)||(e==="v6"||!e)&&x1.test(t))}class fs extends ke{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Y.string){const i=this._getOrReturnCtx(e);return G(i,{code:z.invalid_type,expected:Y.string,received:i.parsedType}),fe}const a=new At;let n;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),G(n,{code:z.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="max")e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),G(n,{code:z.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,l=e.data.length<i.value;(o||l)&&(n=this._getOrReturnCtx(e,n),o?G(n,{code:z.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&G(n,{code:z.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),a.dirty())}else if(i.kind==="email")h1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"email",code:z.invalid_string,message:i.message}),a.dirty());else if(i.kind==="emoji")$i||($i=new RegExp(m1,"u")),$i.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"emoji",code:z.invalid_string,message:i.message}),a.dirty());else if(i.kind==="uuid")l1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"uuid",code:z.invalid_string,message:i.message}),a.dirty());else if(i.kind==="nanoid")c1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"nanoid",code:z.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid")n1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"cuid",code:z.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid2")i1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"cuid2",code:z.invalid_string,message:i.message}),a.dirty());else if(i.kind==="ulid")o1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"ulid",code:z.invalid_string,message:i.message}),a.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),G(n,{validation:"url",code:z.invalid_string,message:i.message}),a.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"regex",code:z.invalid_string,message:i.message}),a.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),G(n,{code:z.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),a.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),G(n,{code:z.invalid_string,validation:{startsWith:i.value},message:i.message}),a.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),G(n,{code:z.invalid_string,validation:{endsWith:i.value},message:i.message}),a.dirty()):i.kind==="datetime"?$x(i).test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{code:z.invalid_string,validation:"datetime",message:i.message}),a.dirty()):i.kind==="date"?b1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{code:z.invalid_string,validation:"date",message:i.message}),a.dirty()):i.kind==="time"?w1(i).test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{code:z.invalid_string,validation:"time",message:i.message}),a.dirty()):i.kind==="duration"?u1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"duration",code:z.invalid_string,message:i.message}),a.dirty()):i.kind==="ip"?j1(e.data,i.version)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"ip",code:z.invalid_string,message:i.message}),a.dirty()):i.kind==="jwt"?N1(e.data,i.alg)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"jwt",code:z.invalid_string,message:i.message}),a.dirty()):i.kind==="cidr"?S1(e.data,i.version)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"cidr",code:z.invalid_string,message:i.message}),a.dirty()):i.kind==="base64"?y1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"base64",code:z.invalid_string,message:i.message}),a.dirty()):i.kind==="base64url"?v1.test(e.data)||(n=this._getOrReturnCtx(e,n),G(n,{validation:"base64url",code:z.invalid_string,message:i.message}),a.dirty()):Fe.assertNever(i);return{status:a.value,value:e.data}}_regex(e,r,a){return this.refinement(n=>e.test(n),{validation:r,code:z.invalid_string,...re.errToObj(a)})}_addCheck(e){return new fs({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...re.errToObj(e)})}url(e){return this._addCheck({kind:"url",...re.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...re.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...re.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...re.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...re.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...re.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...re.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...re.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...re.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...re.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...re.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...re.errToObj(e)})}datetime(e){var r,a;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!==null&&r!==void 0?r:!1,local:(a=e==null?void 0:e.local)!==null&&a!==void 0?a:!1,...re.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...re.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...re.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...re.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...re.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...re.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...re.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...re.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...re.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...re.errToObj(r)})}nonempty(e){return this.min(1,re.errToObj(e))}trim(){return new fs({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new fs({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new fs({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}fs.create=t=>{var e;return new fs({checks:[],typeName:me.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...ve(t)})};function k1(t,e){const r=(t.toString().split(".")[1]||"").length,a=(e.toString().split(".")[1]||"").length,n=r>a?r:a,i=parseInt(t.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return i%o/Math.pow(10,n)}class ur extends ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Y.number){const i=this._getOrReturnCtx(e);return G(i,{code:z.invalid_type,expected:Y.number,received:i.parsedType}),fe}let a;const n=new At;for(const i of this._def.checks)i.kind==="int"?Fe.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),G(a,{code:z.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?k1(e.data,i.value)!==0&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),G(a,{code:z.not_finite,message:i.message}),n.dirty()):Fe.assertNever(i);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,re.toString(r))}gt(e,r){return this.setLimit("min",e,!1,re.toString(r))}lte(e,r){return this.setLimit("max",e,!0,re.toString(r))}lt(e,r){return this.setLimit("max",e,!1,re.toString(r))}setLimit(e,r,a,n){return new ur({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:re.toString(n)}]})}_addCheck(e){return new ur({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:re.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:re.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:re.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:re.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:re.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Fe.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(e===null||a.value<e)&&(e=a.value)}return Number.isFinite(r)&&Number.isFinite(e)}}ur.create=t=>new ur({checks:[],typeName:me.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...ve(t)});class hr extends ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Y.bigint)return this._getInvalidInput(e);let a;const n=new At;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),G(a,{code:z.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):Fe.assertNever(i);return{status:n.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return G(r,{code:z.invalid_type,expected:Y.bigint,received:r.parsedType}),fe}gte(e,r){return this.setLimit("min",e,!0,re.toString(r))}gt(e,r){return this.setLimit("min",e,!1,re.toString(r))}lte(e,r){return this.setLimit("max",e,!0,re.toString(r))}lt(e,r){return this.setLimit("max",e,!1,re.toString(r))}setLimit(e,r,a,n){return new hr({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:re.toString(n)}]})}_addCheck(e){return new hr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:re.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}hr.create=t=>{var e;return new hr({checks:[],typeName:me.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...ve(t)})};class Ga extends ke{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Y.boolean){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:Y.boolean,received:a.parsedType}),fe}return zt(e.data)}}Ga.create=t=>new Ga({typeName:me.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...ve(t)});class Lr extends ke{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Y.date){const i=this._getOrReturnCtx(e);return G(i,{code:z.invalid_type,expected:Y.date,received:i.parsedType}),fe}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return G(i,{code:z.invalid_date}),fe}const a=new At;let n;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),G(n,{code:z.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),a.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),G(n,{code:z.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),a.dirty()):Fe.assertNever(i);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Lr({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:re.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:re.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Lr.create=t=>new Lr({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:me.ZodDate,...ve(t)});class Xn extends ke{_parse(e){if(this._getType(e)!==Y.symbol){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:Y.symbol,received:a.parsedType}),fe}return zt(e.data)}}Xn.create=t=>new Xn({typeName:me.ZodSymbol,...ve(t)});class Xa extends ke{_parse(e){if(this._getType(e)!==Y.undefined){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:Y.undefined,received:a.parsedType}),fe}return zt(e.data)}}Xa.create=t=>new Xa({typeName:me.ZodUndefined,...ve(t)});class Ja extends ke{_parse(e){if(this._getType(e)!==Y.null){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:Y.null,received:a.parsedType}),fe}return zt(e.data)}}Ja.create=t=>new Ja({typeName:me.ZodNull,...ve(t)});class ba extends ke{constructor(){super(...arguments),this._any=!0}_parse(e){return zt(e.data)}}ba.create=t=>new ba({typeName:me.ZodAny,...ve(t)});class Rr extends ke{constructor(){super(...arguments),this._unknown=!0}_parse(e){return zt(e.data)}}Rr.create=t=>new Rr({typeName:me.ZodUnknown,...ve(t)});class Qs extends ke{_parse(e){const r=this._getOrReturnCtx(e);return G(r,{code:z.invalid_type,expected:Y.never,received:r.parsedType}),fe}}Qs.create=t=>new Qs({typeName:me.ZodNever,...ve(t)});class Jn extends ke{_parse(e){if(this._getType(e)!==Y.undefined){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:Y.void,received:a.parsedType}),fe}return zt(e.data)}}Jn.create=t=>new Jn({typeName:me.ZodVoid,...ve(t)});class ps extends ke{_parse(e){const{ctx:r,status:a}=this._processInputParams(e),n=this._def;if(r.parsedType!==Y.array)return G(r,{code:z.invalid_type,expected:Y.array,received:r.parsedType}),fe;if(n.exactLength!==null){const o=r.data.length>n.exactLength.value,l=r.data.length<n.exactLength.value;(o||l)&&(G(r,{code:o?z.too_big:z.too_small,minimum:l?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),a.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(G(r,{code:z.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),a.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(G(r,{code:z.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((o,l)=>n.type._parseAsync(new Ts(r,o,r.path,l)))).then(o=>At.mergeArray(a,o));const i=[...r.data].map((o,l)=>n.type._parseSync(new Ts(r,o,r.path,l)));return At.mergeArray(a,i)}get element(){return this._def.type}min(e,r){return new ps({...this._def,minLength:{value:e,message:re.toString(r)}})}max(e,r){return new ps({...this._def,maxLength:{value:e,message:re.toString(r)}})}length(e,r){return new ps({...this._def,exactLength:{value:e,message:re.toString(r)}})}nonempty(e){return this.min(1,e)}}ps.create=(t,e)=>new ps({type:t,minLength:null,maxLength:null,exactLength:null,typeName:me.ZodArray,...ve(e)});function Kr(t){if(t instanceof Je){const e={};for(const r in t.shape){const a=t.shape[r];e[r]=ks.create(Kr(a))}return new Je({...t._def,shape:()=>e})}else return t instanceof ps?new ps({...t._def,type:Kr(t.element)}):t instanceof ks?ks.create(Kr(t.unwrap())):t instanceof fr?fr.create(Kr(t.unwrap())):t instanceof Ps?Ps.create(t.items.map(e=>Kr(e))):t}class Je extends ke{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Fe.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==Y.object){const h=this._getOrReturnCtx(e);return G(h,{code:z.invalid_type,expected:Y.object,received:h.parsedType}),fe}const{status:a,ctx:n}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Qs&&this._def.unknownKeys==="strip"))for(const h in n.data)o.includes(h)||l.push(h);const c=[];for(const h of o){const u=i[h],p=n.data[h];c.push({key:{status:"valid",value:h},value:u._parse(new Ts(n,p,n.path,h)),alwaysSet:h in n.data})}if(this._def.catchall instanceof Qs){const h=this._def.unknownKeys;if(h==="passthrough")for(const u of l)c.push({key:{status:"valid",value:u},value:{status:"valid",value:n.data[u]}});else if(h==="strict")l.length>0&&(G(n,{code:z.unrecognized_keys,keys:l}),a.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const u of l){const p=n.data[u];c.push({key:{status:"valid",value:u},value:h._parse(new Ts(n,p,n.path,u)),alwaysSet:u in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const h=[];for(const u of c){const p=await u.key,f=await u.value;h.push({key:p,value:f,alwaysSet:u.alwaysSet})}return h}).then(h=>At.mergeObjectSync(a,h)):At.mergeObjectSync(a,c)}get shape(){return this._def.shape()}strict(e){return re.errToObj,new Je({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,a)=>{var n,i,o,l;const c=(o=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,r,a).message)!==null&&o!==void 0?o:a.defaultError;return r.code==="unrecognized_keys"?{message:(l=re.errToObj(e).message)!==null&&l!==void 0?l:c}:{message:c}}}:{}})}strip(){return new Je({...this._def,unknownKeys:"strip"})}passthrough(){return new Je({...this._def,unknownKeys:"passthrough"})}extend(e){return new Je({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Je({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:me.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Je({...this._def,catchall:e})}pick(e){const r={};return Fe.objectKeys(e).forEach(a=>{e[a]&&this.shape[a]&&(r[a]=this.shape[a])}),new Je({...this._def,shape:()=>r})}omit(e){const r={};return Fe.objectKeys(this.shape).forEach(a=>{e[a]||(r[a]=this.shape[a])}),new Je({...this._def,shape:()=>r})}deepPartial(){return Kr(this)}partial(e){const r={};return Fe.objectKeys(this.shape).forEach(a=>{const n=this.shape[a];e&&!e[a]?r[a]=n:r[a]=n.optional()}),new Je({...this._def,shape:()=>r})}required(e){const r={};return Fe.objectKeys(this.shape).forEach(a=>{if(e&&!e[a])r[a]=this.shape[a];else{let i=this.shape[a];for(;i instanceof ks;)i=i._def.innerType;r[a]=i}}),new Je({...this._def,shape:()=>r})}keyof(){return qx(Fe.objectKeys(this.shape))}}Je.create=(t,e)=>new Je({shape:()=>t,unknownKeys:"strip",catchall:Qs.create(),typeName:me.ZodObject,...ve(e)});Je.strictCreate=(t,e)=>new Je({shape:()=>t,unknownKeys:"strict",catchall:Qs.create(),typeName:me.ZodObject,...ve(e)});Je.lazycreate=(t,e)=>new Je({shape:t,unknownKeys:"strip",catchall:Qs.create(),typeName:me.ZodObject,...ve(e)});class Ya extends ke{_parse(e){const{ctx:r}=this._processInputParams(e),a=this._def.options;function n(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return r.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new es(l.ctx.common.issues));return G(r,{code:z.invalid_union,unionErrors:o}),fe}if(r.common.async)return Promise.all(a.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(n);{let i;const o=[];for(const c of a){const h={...r,common:{...r.common,issues:[]},parent:null},u=c._parseSync({data:r.data,path:r.path,parent:h});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:h}),h.common.issues.length&&o.push(h.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new es(c));return G(r,{code:z.invalid_union,unionErrors:l}),fe}}get options(){return this._def.options}}Ya.create=(t,e)=>new Ya({options:t,typeName:me.ZodUnion,...ve(e)});const Fs=t=>t instanceof sn?Fs(t.schema):t instanceof xs?Fs(t.innerType()):t instanceof rn?[t.value]:t instanceof mr?t.options:t instanceof an?Fe.objectValues(t.enum):t instanceof nn?Fs(t._def.innerType):t instanceof Xa?[void 0]:t instanceof Ja?[null]:t instanceof ks?[void 0,...Fs(t.unwrap())]:t instanceof fr?[null,...Fs(t.unwrap())]:t instanceof ol||t instanceof ln?Fs(t.unwrap()):t instanceof on?Fs(t._def.innerType):[];class wi extends ke{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==Y.object)return G(r,{code:z.invalid_type,expected:Y.object,received:r.parsedType}),fe;const a=this.discriminator,n=r.data[a],i=this.optionsMap.get(n);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(G(r,{code:z.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),fe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,a){const n=new Map;for(const i of r){const o=Fs(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const l of o){if(n.has(l))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(l)}`);n.set(l,i)}}return new wi({typeName:me.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:n,...ve(a)})}}function bo(t,e){const r=Ls(t),a=Ls(e);if(t===e)return{valid:!0,data:t};if(r===Y.object&&a===Y.object){const n=Fe.objectKeys(e),i=Fe.objectKeys(t).filter(l=>n.indexOf(l)!==-1),o={...t,...e};for(const l of i){const c=bo(t[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(r===Y.array&&a===Y.array){if(t.length!==e.length)return{valid:!1};const n=[];for(let i=0;i<t.length;i++){const o=t[i],l=e[i],c=bo(o,l);if(!c.valid)return{valid:!1};n.push(c.data)}return{valid:!0,data:n}}else return r===Y.date&&a===Y.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class en extends ke{_parse(e){const{status:r,ctx:a}=this._processInputParams(e),n=(i,o)=>{if(yo(i)||yo(o))return fe;const l=bo(i.value,o.value);return l.valid?((vo(i)||vo(o))&&r.dirty(),{status:r.value,value:l.data}):(G(a,{code:z.invalid_intersection_types}),fe)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([i,o])=>n(i,o)):n(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}en.create=(t,e,r)=>new en({left:t,right:e,typeName:me.ZodIntersection,...ve(r)});class Ps extends ke{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==Y.array)return G(a,{code:z.invalid_type,expected:Y.array,received:a.parsedType}),fe;if(a.data.length<this._def.items.length)return G(a,{code:z.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),fe;!this._def.rest&&a.data.length>this._def.items.length&&(G(a,{code:z.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...a.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new Ts(a,o,a.path,l)):null}).filter(o=>!!o);return a.common.async?Promise.all(i).then(o=>At.mergeArray(r,o)):At.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new Ps({...this._def,rest:e})}}Ps.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ps({items:t,typeName:me.ZodTuple,rest:null,...ve(e)})};class tn extends ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==Y.object)return G(a,{code:z.invalid_type,expected:Y.object,received:a.parsedType}),fe;const n=[],i=this._def.keyType,o=this._def.valueType;for(const l in a.data)n.push({key:i._parse(new Ts(a,l,a.path,l)),value:o._parse(new Ts(a,a.data[l],a.path,l)),alwaysSet:l in a.data});return a.common.async?At.mergeObjectAsync(r,n):At.mergeObjectSync(r,n)}get element(){return this._def.valueType}static create(e,r,a){return r instanceof ke?new tn({keyType:e,valueType:r,typeName:me.ZodRecord,...ve(a)}):new tn({keyType:fs.create(),valueType:e,typeName:me.ZodRecord,...ve(r)})}}class Yn extends ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==Y.map)return G(a,{code:z.invalid_type,expected:Y.map,received:a.parsedType}),fe;const n=this._def.keyType,i=this._def.valueType,o=[...a.data.entries()].map(([l,c],h)=>({key:n._parse(new Ts(a,l,a.path,[h,"key"])),value:i._parse(new Ts(a,c,a.path,[h,"value"]))}));if(a.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const h=await c.key,u=await c.value;if(h.status==="aborted"||u.status==="aborted")return fe;(h.status==="dirty"||u.status==="dirty")&&r.dirty(),l.set(h.value,u.value)}return{status:r.value,value:l}})}else{const l=new Map;for(const c of o){const h=c.key,u=c.value;if(h.status==="aborted"||u.status==="aborted")return fe;(h.status==="dirty"||u.status==="dirty")&&r.dirty(),l.set(h.value,u.value)}return{status:r.value,value:l}}}}Yn.create=(t,e,r)=>new Yn({valueType:e,keyType:t,typeName:me.ZodMap,...ve(r)});class Vr extends ke{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==Y.set)return G(a,{code:z.invalid_type,expected:Y.set,received:a.parsedType}),fe;const n=this._def;n.minSize!==null&&a.data.size<n.minSize.value&&(G(a,{code:z.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&a.data.size>n.maxSize.value&&(G(a,{code:z.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());const i=this._def.valueType;function o(c){const h=new Set;for(const u of c){if(u.status==="aborted")return fe;u.status==="dirty"&&r.dirty(),h.add(u.value)}return{status:r.value,value:h}}const l=[...a.data.values()].map((c,h)=>i._parse(new Ts(a,c,a.path,h)));return a.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,r){return new Vr({...this._def,minSize:{value:e,message:re.toString(r)}})}max(e,r){return new Vr({...this._def,maxSize:{value:e,message:re.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Vr.create=(t,e)=>new Vr({valueType:t,minSize:null,maxSize:null,typeName:me.ZodSet,...ve(e)});class Jr extends ke{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==Y.function)return G(r,{code:z.invalid_type,expected:Y.function,received:r.parsedType}),fe;function a(l,c){return Wn({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Zn(),va].filter(h=>!!h),issueData:{code:z.invalid_arguments,argumentsError:c}})}function n(l,c){return Wn({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Zn(),va].filter(h=>!!h),issueData:{code:z.invalid_return_type,returnTypeError:c}})}const i={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof wa){const l=this;return zt(async function(...c){const h=new es([]),u=await l._def.args.parseAsync(c,i).catch(g=>{throw h.addIssue(a(c,g)),h}),p=await Reflect.apply(o,this,u);return await l._def.returns._def.type.parseAsync(p,i).catch(g=>{throw h.addIssue(n(p,g)),h})})}else{const l=this;return zt(function(...c){const h=l._def.args.safeParse(c,i);if(!h.success)throw new es([a(c,h.error)]);const u=Reflect.apply(o,this,h.data),p=l._def.returns.safeParse(u,i);if(!p.success)throw new es([n(u,p.error)]);return p.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Jr({...this._def,args:Ps.create(e).rest(Rr.create())})}returns(e){return new Jr({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,a){return new Jr({args:e||Ps.create([]).rest(Rr.create()),returns:r||Rr.create(),typeName:me.ZodFunction,...ve(a)})}}class sn extends ke{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}sn.create=(t,e)=>new sn({getter:t,typeName:me.ZodLazy,...ve(e)});class rn extends ke{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return G(r,{received:r.data,code:z.invalid_literal,expected:this._def.value}),fe}return{status:"valid",value:e.data}}get value(){return this._def.value}}rn.create=(t,e)=>new rn({value:t,typeName:me.ZodLiteral,...ve(e)});function qx(t,e){return new mr({values:t,typeName:me.ZodEnum,...ve(e)})}class mr extends ke{constructor(){super(...arguments),Ma.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),a=this._def.values;return G(r,{expected:Fe.joinValues(a),received:r.parsedType,code:z.invalid_type}),fe}if(Gn(this,Ma)||Lx(this,Ma,new Set(this._def.values)),!Gn(this,Ma).has(e.data)){const r=this._getOrReturnCtx(e),a=this._def.values;return G(r,{received:r.data,code:z.invalid_enum_value,options:a}),fe}return zt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return mr.create(e,{...this._def,...r})}exclude(e,r=this._def){return mr.create(this.options.filter(a=>!e.includes(a)),{...this._def,...r})}}Ma=new WeakMap;mr.create=qx;class an extends ke{constructor(){super(...arguments),Oa.set(this,void 0)}_parse(e){const r=Fe.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==Y.string&&a.parsedType!==Y.number){const n=Fe.objectValues(r);return G(a,{expected:Fe.joinValues(n),received:a.parsedType,code:z.invalid_type}),fe}if(Gn(this,Oa)||Lx(this,Oa,new Set(Fe.getValidEnumValues(this._def.values))),!Gn(this,Oa).has(e.data)){const n=Fe.objectValues(r);return G(a,{received:a.data,code:z.invalid_enum_value,options:n}),fe}return zt(e.data)}get enum(){return this._def.values}}Oa=new WeakMap;an.create=(t,e)=>new an({values:t,typeName:me.ZodNativeEnum,...ve(e)});class wa extends ke{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==Y.promise&&r.common.async===!1)return G(r,{code:z.invalid_type,expected:Y.promise,received:r.parsedType}),fe;const a=r.parsedType===Y.promise?r.data:Promise.resolve(r.data);return zt(a.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}}wa.create=(t,e)=>new wa({type:t,typeName:me.ZodPromise,...ve(e)});class xs extends ke{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===me.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:a}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:o=>{G(a,o),o.fatal?r.abort():r.dirty()},get path(){return a.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const o=n.transform(a.data,i);if(a.common.async)return Promise.resolve(o).then(async l=>{if(r.value==="aborted")return fe;const c=await this._def.schema._parseAsync({data:l,path:a.path,parent:a});return c.status==="aborted"?fe:c.status==="dirty"||r.value==="dirty"?Qr(c.value):c});{if(r.value==="aborted")return fe;const l=this._def.schema._parseSync({data:o,path:a.path,parent:a});return l.status==="aborted"?fe:l.status==="dirty"||r.value==="dirty"?Qr(l.value):l}}if(n.type==="refinement"){const o=l=>{const c=n.refinement(l,i);if(a.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(a.common.async===!1){const l=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return l.status==="aborted"?fe:(l.status==="dirty"&&r.dirty(),o(l.value),{status:r.value,value:l.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(l=>l.status==="aborted"?fe:(l.status==="dirty"&&r.dirty(),o(l.value).then(()=>({status:r.value,value:l.value}))))}if(n.type==="transform")if(a.common.async===!1){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!Fr(o))return o;const l=n.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:l}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>Fr(o)?Promise.resolve(n.transform(o.value,i)).then(l=>({status:r.value,value:l})):o);Fe.assertNever(n)}}xs.create=(t,e,r)=>new xs({schema:t,typeName:me.ZodEffects,effect:e,...ve(r)});xs.createWithPreprocess=(t,e,r)=>new xs({schema:e,effect:{type:"preprocess",transform:t},typeName:me.ZodEffects,...ve(r)});class ks extends ke{_parse(e){return this._getType(e)===Y.undefined?zt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ks.create=(t,e)=>new ks({innerType:t,typeName:me.ZodOptional,...ve(e)});class fr extends ke{_parse(e){return this._getType(e)===Y.null?zt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}fr.create=(t,e)=>new fr({innerType:t,typeName:me.ZodNullable,...ve(e)});class nn extends ke{_parse(e){const{ctx:r}=this._processInputParams(e);let a=r.data;return r.parsedType===Y.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}nn.create=(t,e)=>new nn({innerType:t,typeName:me.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ve(e)});class on extends ke{_parse(e){const{ctx:r}=this._processInputParams(e),a={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return Wa(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new es(a.common.issues)},input:a.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new es(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}on.create=(t,e)=>new on({innerType:t,typeName:me.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ve(e)});class ei extends ke{_parse(e){if(this._getType(e)!==Y.nan){const a=this._getOrReturnCtx(e);return G(a,{code:z.invalid_type,expected:Y.nan,received:a.parsedType}),fe}return{status:"valid",value:e.data}}}ei.create=t=>new ei({typeName:me.ZodNaN,...ve(t)});const C1=Symbol("zod_brand");class ol extends ke{_parse(e){const{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}class xn extends ke{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return i.status==="aborted"?fe:i.status==="dirty"?(r.dirty(),Qr(i.value)):this._def.out._parseAsync({data:i.value,path:a.path,parent:a})})();{const n=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?fe:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:a.path,parent:a})}}static create(e,r){return new xn({in:e,out:r,typeName:me.ZodPipeline})}}class ln extends ke{_parse(e){const r=this._def.innerType._parse(e),a=n=>(Fr(n)&&(n.value=Object.freeze(n.value)),n);return Wa(r)?r.then(n=>a(n)):a(r)}unwrap(){return this._def.innerType}}ln.create=(t,e)=>new ln({innerType:t,typeName:me.ZodReadonly,...ve(e)});function hc(t,e){const r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function Ux(t,e={},r){return t?ba.create().superRefine((a,n)=>{var i,o;const l=t(a);if(l instanceof Promise)return l.then(c=>{var h,u;if(!c){const p=hc(e,a),f=(u=(h=p.fatal)!==null&&h!==void 0?h:r)!==null&&u!==void 0?u:!0;n.addIssue({code:"custom",...p,fatal:f})}});if(!l){const c=hc(e,a),h=(o=(i=c.fatal)!==null&&i!==void 0?i:r)!==null&&o!==void 0?o:!0;n.addIssue({code:"custom",...c,fatal:h})}}):ba.create()}const _1={object:Je.lazycreate};var me;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(me||(me={}));const T1=(t,e={message:`Input not instance of ${t.name}`})=>Ux(r=>r instanceof t,e),Bx=fs.create,Kx=ur.create,P1=ei.create,A1=hr.create,Qx=Ga.create,E1=Lr.create,I1=Xn.create,R1=Xa.create,M1=Ja.create,O1=ba.create,D1=Rr.create,F1=Qs.create,L1=Jn.create,V1=ps.create,z1=Je.create,$1=Je.strictCreate,q1=Ya.create,U1=wi.create,B1=en.create,K1=Ps.create,Q1=tn.create,H1=Yn.create,Z1=Vr.create,W1=Jr.create,G1=sn.create,X1=rn.create,J1=mr.create,Y1=an.create,e2=wa.create,mc=xs.create,t2=ks.create,s2=fr.create,r2=xs.createWithPreprocess,a2=xn.create,n2=()=>Bx().optional(),i2=()=>Kx().optional(),o2=()=>Qx().optional(),l2={string:t=>fs.create({...t,coerce:!0}),number:t=>ur.create({...t,coerce:!0}),boolean:t=>Ga.create({...t,coerce:!0}),bigint:t=>hr.create({...t,coerce:!0}),date:t=>Lr.create({...t,coerce:!0})},c2=fe;var Re=Object.freeze({__proto__:null,defaultErrorMap:va,setErrorMap:r1,getErrorMap:Zn,makeIssue:Wn,EMPTY_PATH:a1,addIssueToContext:G,ParseStatus:At,INVALID:fe,DIRTY:Qr,OK:zt,isAborted:yo,isDirty:vo,isValid:Fr,isAsync:Wa,get util(){return Fe},get objectUtil(){return xo},ZodParsedType:Y,getParsedType:Ls,ZodType:ke,datetimeRegex:$x,ZodString:fs,ZodNumber:ur,ZodBigInt:hr,ZodBoolean:Ga,ZodDate:Lr,ZodSymbol:Xn,ZodUndefined:Xa,ZodNull:Ja,ZodAny:ba,ZodUnknown:Rr,ZodNever:Qs,ZodVoid:Jn,ZodArray:ps,ZodObject:Je,ZodUnion:Ya,ZodDiscriminatedUnion:wi,ZodIntersection:en,ZodTuple:Ps,ZodRecord:tn,ZodMap:Yn,ZodSet:Vr,ZodFunction:Jr,ZodLazy:sn,ZodLiteral:rn,ZodEnum:mr,ZodNativeEnum:an,ZodPromise:wa,ZodEffects:xs,ZodTransformer:xs,ZodOptional:ks,ZodNullable:fr,ZodDefault:nn,ZodCatch:on,ZodNaN:ei,BRAND:C1,ZodBranded:ol,ZodPipeline:xn,ZodReadonly:ln,custom:Ux,Schema:ke,ZodSchema:ke,late:_1,get ZodFirstPartyTypeKind(){return me},coerce:l2,any:O1,array:V1,bigint:A1,boolean:Qx,date:E1,discriminatedUnion:U1,effect:mc,enum:J1,function:W1,instanceof:T1,intersection:B1,lazy:G1,literal:X1,map:H1,nan:P1,nativeEnum:Y1,never:F1,null:M1,nullable:s2,number:Kx,object:z1,oboolean:o2,onumber:i2,optional:t2,ostring:n2,pipeline:a2,preprocess:r2,promise:e2,record:Q1,set:Z1,strictObject:$1,string:Bx,symbol:I1,transformer:mc,tuple:K1,undefined:R1,union:q1,unknown:D1,void:L1,NEVER:c2,ZodIssueCode:z,quotelessJson:s1,ZodError:es});const Xe={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function at(t,e){return e.includes(t.columnType)}function d2(t){return"enumValues"in t&&Array.isArray(t.enumValues)&&t.enumValues.length>0}const u2=Re.union([Re.string(),Re.number(),Re.boolean(),Re.null()]),h2=Re.union([u2,Re.record(Re.any()),Re.array(Re.any())]),m2=Re.custom(t=>t instanceof Buffer);function Hx(t,e){const r=(e==null?void 0:e.zodInstance)??Re,a=(e==null?void 0:e.coerce)??{};let n;return d2(t)&&(n=t.enumValues.length?r.enum(t.enumValues):r.string()),n||(at(t,["PgGeometry","PgPointTuple"])?n=r.tuple([r.number(),r.number()]):at(t,["PgGeometryObject","PgPointObject"])?n=r.object({x:r.number(),y:r.number()}):at(t,["PgHalfVector","PgVector"])?(n=r.array(r.number()),n=t.dimensions?n.length(t.dimensions):n):at(t,["PgLine"])?n=r.tuple([r.number(),r.number(),r.number()]):at(t,["PgLineABC"])?n=r.object({a:r.number(),b:r.number(),c:r.number()}):at(t,["PgArray"])?(n=r.array(Hx(t.baseColumn,r)),n=t.size?n.length(t.size):n):t.dataType==="array"?n=r.array(r.any()):t.dataType==="number"?n=f2(t,r,a):t.dataType==="bigint"?n=p2(t,r,a):t.dataType==="boolean"?n=a===!0||a.boolean?r.coerce.boolean():r.boolean():t.dataType==="date"?n=a===!0||a.date?r.coerce.date():r.date():t.dataType==="string"?n=g2(t,r,a):t.dataType==="json"?n=h2:t.dataType==="custom"?n=r.any():t.dataType==="buffer"&&(n=m2)),n||(n=r.any()),n}function f2(t,e,r){let a=t.getSQLType().includes("unsigned"),n,i,o=!1;at(t,["MySqlTinyInt","SingleStoreTinyInt"])?(n=a?0:Xe.INT8_MIN,i=a?Xe.INT8_UNSIGNED_MAX:Xe.INT8_MAX,o=!0):at(t,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(n=a?0:Xe.INT16_MIN,i=a?Xe.INT16_UNSIGNED_MAX:Xe.INT16_MAX,o=!0):at(t,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(n=a?0:Xe.INT24_MIN,i=a?Xe.INT24_UNSIGNED_MAX:Xe.INT24_MAX,o=at(t,["MySqlMediumInt","SingleStoreMediumInt"])):at(t,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(n=a?0:Xe.INT32_MIN,i=a?Xe.INT32_UNSIGNED_MAX:Xe.INT32_MAX,o=!0):at(t,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(n=a?0:Xe.INT48_MIN,i=a?Xe.INT48_UNSIGNED_MAX:Xe.INT48_MAX):at(t,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(a=a||at(t,["MySqlSerial","SingleStoreSerial"]),n=a?0:Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=!0):at(t,["MySqlYear","SingleStoreYear"])?(n=1901,i=2155,o=!0):(n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER);let l=r===!0||r!=null&&r.number?e.coerce.number():e.number();return l=l.min(n).max(i),o?l.int():l}function p2(t,e,r){const a=t.getSQLType().includes("unsigned"),n=a?0n:Xe.INT64_MIN,i=a?Xe.INT64_UNSIGNED_MAX:Xe.INT64_MAX;return(r===!0||r!=null&&r.bigint?e.coerce.bigint():e.bigint()).min(n).max(i)}function g2(t,e,r){if(at(t,["PgUUID"]))return e.string().uuid();let a,n,i=!1;at(t,["PgVarchar","SQLiteText"])?a=t.length:at(t,["MySqlVarChar","SingleStoreVarChar"])?a=t.length??Xe.INT16_UNSIGNED_MAX:at(t,["MySqlText","SingleStoreText"])&&(t.textType==="longtext"?a=Xe.INT32_UNSIGNED_MAX:t.textType==="mediumtext"?a=Xe.INT24_UNSIGNED_MAX:t.textType==="text"?a=Xe.INT16_UNSIGNED_MAX:a=Xe.INT8_UNSIGNED_MAX),at(t,["PgChar","MySqlChar","SingleStoreChar"])&&(a=t.length,i=!0),at(t,["PgBinaryVector"])&&(n=/^[01]+$/,a=t.dimensions);let o=r===!0||r!=null&&r.string?e.coerce.string():e.string();return o=n?o.regex(n):o,a&&i?o.length(a):a?o.max(a):o}function Zx(t){return ig(t)?CN(t):_N(t)}function Wx(t,e,r,a){const n={};for(const[i,o]of Object.entries(t)){if(!wt(o,ya)&&!wt(o,pt)&&!wt(o,pt.Aliased)&&typeof o=="object"){const p=ig(o)||kN(o)?Zx(o):o;n[i]=Wx(p,e[i]??{},r,a);continue}const l=e[i];if(l!==void 0&&typeof l!="function"){n[i]=l;continue}const c=wt(o,ya)?o:void 0,h=c?Hx(c,a):Re.any(),u=typeof l=="function"?l(h):h;r.never(c)||(n[i]=u,c&&(r.nullable(c)&&(n[i]=n[i].nullable()),r.optional(c)&&(n[i]=n[i].optional())))}return Re.object(n)}const x2={never:t=>{var e,r;return((e=t==null?void 0:t.generated)==null?void 0:e.type)==="always"||((r=t==null?void 0:t.generatedIdentity)==null?void 0:r.type)==="always"},optional:t=>!t.notNull||t.notNull&&t.hasDefault,nullable:t=>!t.notNull},dt=(t,e)=>{const r=Zx(t);return Wx(r,{},x2)},yt=ct("users",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),phoneNumber:ne("phone_number").notNull().unique(),name:ae("name").notNull(),avatar:ae("avatar"),location:ae("location").notNull(),isOnline:Pt("is_online").default(!1),isVerified:Pt("is_verified").default(!1),verifiedAt:je("verified_at"),isAdmin:Pt("is_admin").default(!1),lastSeen:je("last_seen").defaultNow(),createdAt:je("created_at").defaultNow(),updatedAt:je("updated_at").defaultNow()}),y2=ct("sessions",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),userId:ne("user_id").notNull().references(()=>yt.id),token:ne("token").notNull().unique(),expiresAt:je("expires_at").notNull(),createdAt:je("created_at").defaultNow()}),v2=ct("otp_codes",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),phoneNumber:ne("phone_number").notNull(),code:ne("code").notNull(),expiresAt:je("expires_at").notNull(),isUsed:Pt("is_used").default(!1),createdAt:je("created_at").defaultNow()}),Gx=ct("chats",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),name:ae("name"),isGroup:Pt("is_group").default(!1),avatar:ae("avatar"),participants:bi("participants").$type().notNull(),createdAt:je("created_at").defaultNow(),updatedAt:je("updated_at").defaultNow()}),b2=ct("messages",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),chatId:ne("chat_id").notNull().references(()=>Gx.id),senderId:ne("sender_id").notNull().references(()=>yt.id),content:ae("content"),messageType:ae("message_type").notNull().default("text"),imageUrl:ae("image_url"),audioUrl:ae("audio_url"),stickerUrl:ae("sticker_url"),stickerId:ne("sticker_id"),locationLat:Ks("location_lat"),locationLon:Ks("location_lon"),locationName:ae("location_name"),replyToMessageId:ne("reply_to_message_id"),timestamp:je("timestamp").defaultNow(),isRead:Pt("is_read").default(!1),isDelivered:Pt("is_delivered").default(!1),isEdited:Pt("is_edited").default(!1),editedAt:je("edited_at"),deletedAt:je("deleted_at")}),w2=ct("admin_credentials",{id:ne("id").primaryKey().default("admin_settings"),email:ae("email").notNull(),password:ae("password").notNull(),updatedAt:je("updated_at").defaultNow(),createdAt:je("created_at").defaultNow()}),j2=ct("app_features",{id:ne("id").primaryKey(),name:ae("name").notNull(),description:ae("description").notNull(),isEnabled:Pt("is_enabled").default(!0),category:ae("category").notNull().default("general"),priority:il("priority").default(0),updatedAt:je("updated_at").defaultNow(),createdAt:je("created_at").defaultNow()});dt(yt).omit({id:!0,isVerified:!0,verifiedAt:!0,isAdmin:!0,lastSeen:!0,createdAt:!0,updatedAt:!0});dt(y2).omit({id:!0,createdAt:!0});dt(v2).omit({id:!0,createdAt:!0});dt(Gx).omit({id:!0,createdAt:!0,updatedAt:!0});const N2=ct("stickers",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),name:ae("name").notNull(),imageUrl:ae("image_url").notNull(),category:ae("category").notNull().default("general"),isActive:Pt("is_active").default(!0),sortOrder:il("sort_order").default(0),createdAt:je("created_at").defaultNow()}),ll=ct("stories",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),userId:ne("user_id").notNull().references(()=>yt.id),location:ae("location").notNull(),content:ae("content"),imageUrl:ae("image_url"),videoUrl:ae("video_url"),backgroundColor:ae("background_color").default("#075e54"),textColor:ae("text_color").default("#ffffff"),timestamp:je("timestamp").defaultNow(),expiresAt:je("expires_at").notNull(),viewCount:ae("view_count").default("0"),viewers:bi("viewers").$type().default([])});dt(b2).omit({id:!0,timestamp:!0});dt(ll).omit({id:!0,timestamp:!0,viewCount:!0});dt(N2).omit({id:!0,createdAt:!0});const ji=ct("stores",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),userId:ne("user_id").notNull().references(()=>yt.id),name:ae("name").notNull(),description:ae("description").notNull(),imageUrl:ae("image_url"),category:ae("category").notNull(),location:ae("location").notNull(),phoneNumber:ae("phone_number"),isOpen:Pt("is_open").default(!0),isActive:Pt("is_active").default(!1),status:ae("status").notNull().default("pending"),isVerified:Pt("is_verified").default(!1),verifiedAt:je("verified_at"),approvedAt:je("approved_at"),approvedBy:ne("approved_by").references(()=>yt.id),rejectionReason:ae("rejection_reason"),createdAt:je("created_at").defaultNow(),updatedAt:je("updated_at").defaultNow()}),Ni=ct("products",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),userId:ne("user_id").notNull().references(()=>yt.id),storeId:ne("store_id").references(()=>ji.id),name:ae("name").notNull(),description:ae("description").notNull(),price:Ks("price").notNull(),imageUrl:ae("image_url"),category:ae("category").notNull(),location:ae("location").notNull(),isActive:Pt("is_active").default(!0),commissionRate:Ks("commission_rate").notNull().default("0.05"),createdAt:je("created_at").defaultNow(),updatedAt:je("updated_at").defaultNow()}),Xx=ct("affiliate_links",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),productId:ne("product_id").notNull().references(()=>Ni.id),affiliateId:ne("affiliate_id").notNull().references(()=>yt.id),uniqueCode:ne("unique_code").notNull().unique(),clicks:ae("clicks").default("0"),conversions:ae("conversions").default("0"),totalCommission:Ks("total_commission").default("0"),createdAt:je("created_at").defaultNow()}),S2=ct("commissions",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),affiliateLinkId:ne("affiliate_link_id").notNull().references(()=>Xx.id),buyerId:ne("buyer_id").notNull().references(()=>yt.id),amount:Ks("amount").notNull(),status:ae("status").notNull().default("pending"),transactionId:ne("transaction_id"),createdAt:je("created_at").defaultNow(),paidAt:je("paid_at")}),k2=ct("contacts",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),userId:ne("user_id").notNull().references(()=>yt.id),contactUserId:ne("contact_user_id").references(()=>yt.id),phoneNumber:ne("phone_number").notNull(),name:ae("name").notNull(),isAppUser:Pt("is_app_user").default(!1),createdAt:je("created_at").defaultNow()}),C2=ct("cart_items",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),userId:ne("user_id").notNull().references(()=>yt.id),productId:ne("product_id").notNull().references(()=>Ni.id),quantity:ae("quantity").notNull().default("1"),addedAt:je("added_at").defaultNow()}),Jx=ct("orders",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),buyerId:ne("buyer_id").notNull().references(()=>yt.id),sellerId:ne("seller_id").notNull().references(()=>yt.id),storeId:ne("store_id").references(()=>ji.id),totalAmount:Ks("total_amount").notNull(),status:ae("status").notNull().default("pending"),paymentMethod:ae("payment_method").notNull().default("cash_on_delivery"),deliveryAddress:ae("delivery_address").notNull(),customerPhone:ae("customer_phone").notNull(),customerName:ae("customer_name").notNull(),notes:ae("notes"),orderDate:je("order_date").defaultNow(),confirmedAt:je("confirmed_at"),deliveredAt:je("delivered_at"),cancelledAt:je("cancelled_at"),cancellationReason:ae("cancellation_reason")}),_2=ct("order_items",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),orderId:ne("order_id").notNull().references(()=>Jx.id),productId:ne("product_id").notNull().references(()=>Ni.id),productName:ae("product_name").notNull(),productPrice:Ks("product_price").notNull(),quantity:ae("quantity").notNull(),subtotal:Ks("subtotal").notNull()}),T2=dt(ji).omit({id:!0,status:!0,isVerified:!0,verifiedAt:!0,approvedAt:!0,approvedBy:!0,rejectionReason:!0,createdAt:!0,updatedAt:!0}),P2=dt(Ni).omit({id:!0,createdAt:!0,updatedAt:!0});dt(Xx).omit({id:!0,uniqueCode:!0,clicks:!0,conversions:!0,totalCommission:!0,createdAt:!0});dt(S2).omit({id:!0,createdAt:!0,paidAt:!0});dt(k2).omit({id:!0,createdAt:!0});dt(C2).omit({id:!0,addedAt:!0});dt(Jx).omit({id:!0,orderDate:!0,confirmedAt:!0,deliveredAt:!0,cancelledAt:!0});dt(_2).omit({id:!0,orderId:!0});const A2=ct("verification_requests",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),userId:ne("user_id").notNull().references(()=>yt.id),storeId:ne("store_id").references(()=>ji.id),requestType:ae("request_type").notNull(),status:ae("status").notNull().default("pending"),documents:bi("documents").$type().default([]),reason:ae("reason"),adminNote:ae("admin_note"),submittedAt:je("submitted_at").defaultNow(),reviewedAt:je("reviewed_at"),reviewedBy:ne("reviewed_by").references(()=>yt.id)});dt(A2).omit({id:!0,submittedAt:!0,reviewedAt:!0});const E2=ct("story_likes",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),storyId:ne("story_id").notNull().references(()=>ll.id),userId:ne("user_id").notNull().references(()=>yt.id),reactionType:ae("reaction_type").notNull().default("like"),createdAt:je("created_at").defaultNow()}),I2=ct("story_comments",{id:ne("id").primaryKey().default(tt`gen_random_uuid()`),storyId:ne("story_id").notNull().references(()=>ll.id),userId:ne("user_id").notNull().references(()=>yt.id),content:ae("content").notNull(),createdAt:je("created_at").defaultNow(),updatedAt:je("updated_at").defaultNow()});dt(E2).omit({id:!0,createdAt:!0});dt(I2).omit({id:!0,createdAt:!0,updatedAt:!0});dt(w2).omit({id:!0,createdAt:!0,updatedAt:!0});dt(j2).omit({createdAt:!0,updatedAt:!0});const R2=T2.extend({name:Re.string().min(1,"اسم المتجر مطلوب"),description:Re.string().min(1,"وصف المتجر مطلوب"),category:Re.string().min(1,"فئة المتجر مطلوبة"),location:Re.string().min(1,"موقع المتجر مطلوب")});function M2(){const[t,e]=d.useState(!1),[r,a]=d.useState(!1),[n,i]=d.useState(!1),[o,l]=d.useState(null),[c,h]=d.useState(""),{toast:u}=lt(),p=d.useRef(!0),{data:f}=ye({queryKey:["/api/user/current"]}),{data:g,isLoading:j}=ye({queryKey:["/api/user/store"],refetchInterval:3e4}),{data:x=[]}=ye({queryKey:["/api/user/products"]}),m=Ha({resolver:Za(R2),defaultValues:{name:"",description:"",category:"",location:"",phoneNumber:"",imageUrl:"",isOpen:!0}});d.useEffect(()=>{f!=null&&f.location&&m.setValue("location",f.location)},[f,m]),d.useEffect(()=>{g&&!p.current?(o==="pending"&&g.status==="approved"?u({title:"🎉 مبروك عليك!",description:"تم الموافقة على متجرك بنجاح! يمكنك الآن إضافة منتجاتك وبدء البيع.",duration:8e3}):o==="pending"&&g.status==="rejected"&&u({title:"تم رفض طلب المتجر",description:g.rejectionReason||"يرجى مراجعة البيانات والمحاولة مرة أخرى.",variant:"destructive",duration:8e3}),l(g.status)):g&&p.current&&(l(g.status),p.current=!1)},[g,o,u]);const S=Ha({resolver:Za(P2.extend({name:Re.string().min(1,"اسم المنتج مطلوب"),description:Re.string().min(1,"وصف المنتج مطلوب"),price:Re.string().min(1,"السعر مطلوب"),category:Re.string().min(1,"فئة المنتج مطلوبة")})),defaultValues:{name:"",description:"",price:"",category:"",imageUrl:"",location:(f==null?void 0:f.location)||"",isActive:!0}}),v=Se({mutationFn:async w=>{console.log("Sending store data to API:",w);const A=await ce("/api/stores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)});return console.log("API response:",A),A},onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/user/store"]}),ft.invalidateQueries({queryKey:["/api/user/products"]}),ft.invalidateQueries({queryKey:["/api/stores"]}),ft.refetchQueries({queryKey:["/api/user/store"]}),u({title:"تم تقديم طلب إنشاء المتجر",description:"تم تقديم طلبك بنجاح! سيتم مراجعته من قبل الإدارة وستتلقى إشعارًا عند الموافقة."}),e(!1),m.reset()},onError:w=>{console.error("Create store error:",w),console.error("Error details:",JSON.stringify(w,null,2)),u({title:"خطأ",description:w.message||"فشل في إنشاء المتجر. تحقق من اتصالك بالإنترنت وحاول مرة أخرى.",variant:"destructive"})}}),y=Se({mutationFn:async w=>{if(!g)throw new Error("No store found");return ce(`/api/stores/${g.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})},onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/user/store"]}),u({title:"تم تحديث المتجر",description:"تم تحديث معلومات متجرك بنجاح!"}),a(!1)},onError:w=>{u({title:"خطأ",description:w.message||"فشل في تحديث المتجر",variant:"destructive"})}}),C=Se({mutationFn:async w=>{if(!g)throw new Error("No store found");return ce("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...w,imageUrl:c,userId:f==null?void 0:f.id,storeId:g.id})})},onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/user/products"]}),u({title:"تم إضافة المنتج",description:"تم إضافة المنتج بنجاح!"}),i(!1),h(""),S.reset()},onError:w=>{u({title:"خطأ",description:w.message||"فشل في إضافة المنتج",variant:"destructive"})}}),k=Se({mutationFn:async w=>{const A=new FormData;A.append("media",w);const I=localStorage.getItem("auth_token");if(!I)throw new Error("يجب تسجيل الدخول أولاً");const K=await fetch("/api/upload/media",{method:"POST",headers:{Authorization:`Bearer ${I}`},body:A});if(!K.ok)throw new Error("فشل في رفع الصورة");return K.json()},onSuccess:w=>{h(w.mediaUrl),u({title:"تم رفع الصورة",description:"تم رفع صورة المنتج بنجاح"})},onError:w=>{u({title:"خطأ",description:w.message||"فشل في رفع الصورة",variant:"destructive"})}}),D=w=>{var I;const A=(I=w.target.files)==null?void 0:I[0];if(A){if(A.size>5*1024*1024){u({title:"حجم الصورة كبير",description:"يجب أن يكون حجم الصورة أقل من 5 ميجابايت",variant:"destructive"});return}k.mutate(A)}},Q=()=>{const w=m.getValues();if(!w.name||!w.description||!w.category||!w.location){u({title:"خطأ في البيانات",description:"يرجى ملء جميع الحقول المطلوبة",variant:"destructive"});return}v.mutate(w)},H=w=>{y.mutate(w)},M=w=>{C.mutate(w)},L=w=>{i(w),w||(h(""),S.reset())},$=()=>{g&&(m.reset({name:g.name,description:g.description,category:g.category,location:g.location,phoneNumber:g.phoneNumber||"",imageUrl:g.imageUrl||"",isOpen:g.isOpen??!0}),a(!0))};return j?s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4",children:s.jsx("div",{className:"max-w-4xl mx-auto",children:s.jsx("div",{className:"text-center",children:"جاري التحميل..."})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"متجري"}),g&&s.jsxs(T,{onClick:$,variant:"outline","data-testid":"button-edit-store",children:[s.jsx(Fl,{className:"w-4 h-4 ml-2"}),"تعديل المتجر"]})]}),g?s.jsxs("div",{className:"space-y-6",children:[s.jsxs(oe,{children:[s.jsxs(xt,{children:[s.jsxs(Nt,{className:"flex items-center flex-wrap gap-2",children:[s.jsx(Bt,{className:"w-5 h-5 ml-2"}),g.name,s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Te,{className:`${g.isOpen?"bg-green-500":"bg-red-500"}`,children:g.isOpen?"مفتوح":"مغلق"}),s.jsx(Te,{className:`${g.status==="approved"?"bg-green-500":g.status==="pending"?"bg-yellow-500":g.status==="rejected"?"bg-red-500":"bg-gray-500"}`,children:g.status==="approved"?"معتمد":g.status==="pending"?"قيد المراجعة":g.status==="rejected"?"مرفوض":g.status==="suspended"?"معلق":"غير محدد"})]})]}),g.status==="rejected"&&g.rejectionReason&&s.jsxs("div",{className:"text-sm text-red-600 dark:text-red-400 mt-2",children:[s.jsx("strong",{children:"سبب الرفض:"})," ",g.rejectionReason]}),g.status==="pending"&&s.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mt-3",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(is,{className:"w-5 h-5 text-yellow-600 ml-2"}),s.jsx("h4",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"طلب قيد المراجعة"})]}),s.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-2",children:"تم تقديم طلب إنشاء متجرك بنجاح وهو الآن قيد المراجعة من قبل فريق الإدارة. سيتم إشعارك فور الموافقة على الطلب وتفعيل متجرك."}),s.jsxs("div",{className:"text-xs text-yellow-600 dark:text-yellow-400 mt-2",children:["تاريخ التقديم: ",g.createdAt?new Date(g.createdAt).toLocaleDateString("ar-DZ"):"غير محدد"]})]}),g.status==="approved"&&s.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3 mt-3",children:s.jsxs("div",{className:"flex items-center text-green-700 dark:text-green-300",children:[s.jsx(is,{className:"w-4 h-4 ml-2"}),s.jsxs("span",{className:"text-sm",children:["تم الموافقة على متجرك في: ",g.approvedAt?new Date(g.approvedAt).toLocaleDateString("ar-DZ"):"غير محدد"]})]})})]}),s.jsx(le,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[s.jsx(gs,{className:"w-4 h-4 ml-2"}),g.location]}),g.phoneNumber&&s.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[s.jsx(Es,{className:"w-4 h-4 ml-2"}),g.phoneNumber]}),s.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[s.jsx(Dn,{className:"w-4 h-4 ml-2"}),g.category]})]}),s.jsx("div",{children:s.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:g.description})})]})})]}),s.jsxs(oe,{children:[s.jsx(xt,{children:s.jsxs(Nt,{className:"flex justify-between items-center",children:[s.jsxs("span",{children:["منتجات المتجر (",x.length,")"]}),s.jsxs(Yt,{open:n,onOpenChange:L,children:[s.jsx(Qa,{asChild:!0,children:s.jsxs(T,{className:"bg-[var(--whatsapp-primary)] hover:bg-[var(--whatsapp-secondary)]","data-testid":"button-add-product",disabled:g.status!=="approved",children:[s.jsx(Bs,{className:"w-4 h-4 ml-2"}),"إضافة منتج"]})}),s.jsxs(Kt,{className:"max-w-md","data-testid":"add-product-modal",children:[s.jsx(Qt,{children:s.jsx(Ht,{children:"إضافة منتج جديد"})}),s.jsxs("form",{onSubmit:S.handleSubmit(M),className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"productName",children:"اسم المنتج *"}),s.jsx(Ce,{id:"productName",...S.register("name"),placeholder:"سماعة بلوتوث","data-testid":"input-product-name"}),S.formState.errors.name&&s.jsx("p",{className:"text-sm text-red-500",children:S.formState.errors.name.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"productDescription",children:"وصف المنتج *"}),s.jsx(qs,{id:"productDescription",...S.register("description"),placeholder:"وصف تفصيلي للمنتج...","data-testid":"input-product-description"}),S.formState.errors.description&&s.jsx("p",{className:"text-sm text-red-500",children:S.formState.errors.description.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"productPrice",children:"السعر (دج) *"}),s.jsx(Ce,{id:"productPrice",...S.register("price"),placeholder:"5000",type:"number","data-testid":"input-product-price"}),S.formState.errors.price&&s.jsx("p",{className:"text-sm text-red-500",children:S.formState.errors.price.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"productCategory",children:"فئة المنتج *"}),s.jsx(Ce,{id:"productCategory",...S.register("category"),placeholder:"إلكترونيات، ملابس، طعام...","data-testid":"input-product-category"}),S.formState.errors.category&&s.jsx("p",{className:"text-sm text-red-500",children:S.formState.errors.category.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{children:"صورة المنتج"}),s.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4",children:c?s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:c,alt:"صورة المنتج",className:"w-full h-32 object-cover rounded-lg"}),s.jsx(T,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>h(""),"data-testid":"button-remove-image",children:s.jsx(dr,{className:"w-4 h-4"})})]}):s.jsxs("div",{className:"text-center",children:[s.jsx("label",{htmlFor:"product-image-upload",className:"cursor-pointer",children:s.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center",children:k.isPending?s.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):s.jsx(Pf,{className:"w-6 h-6 text-gray-400"})}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:k.isPending?"جاري تحميل الصورة...":s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"font-semibold text-blue-600",children:"انقر للتحميل"}),s.jsx("br",{}),"أو اسحب الصورة هنا"]})}),s.jsx("div",{className:"text-xs text-gray-500",children:"JPG, PNG, GIF حتى 5MB"})]})}),s.jsx("input",{id:"product-image-upload",type:"file",accept:"image/*,image/jpeg,image/png,image/gif,image/webp",onChange:D,className:"hidden","data-testid":"input-product-image",disabled:k.isPending})]})})]}),s.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[s.jsx(T,{type:"button",variant:"outline",onClick:()=>L(!1),"data-testid":"button-cancel-product",children:"إلغاء"}),s.jsx(T,{type:"submit",disabled:C.isPending,className:"bg-[var(--whatsapp-primary)] hover:bg-[var(--whatsapp-secondary)]","data-testid":"button-submit-product",children:C.isPending?"جاري الإضافة...":"إضافة المنتج"})]})]})]})]})]})}),s.jsx(le,{children:x.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"لا توجد منتجات في متجرك حتى الآن"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"ابدأ بإضافة منتجاتك لزيادة المبيعات"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map(w=>s.jsxs(oe,{className:"overflow-hidden","data-testid":`product-card-${w.id}`,children:[w.imageUrl&&s.jsx("div",{className:"h-48 bg-gray-200 dark:bg-gray-700",children:s.jsx("img",{src:w.imageUrl,alt:w.name,className:"w-full h-full object-cover"})}),s.jsxs(le,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold text-lg mb-2",children:w.name}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-2 line-clamp-2",children:w.description}),s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("span",{className:"text-lg font-bold text-[var(--whatsapp-primary)]",children:[parseInt(w.price).toLocaleString()," دج"]}),s.jsx(Te,{variant:w.isActive?"default":"secondary",children:w.isActive?"نشط":"متوقف"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(T,{size:"sm",variant:"outline",className:"flex-1","data-testid":`button-edit-product-${w.id}`,children:[s.jsx(Fl,{className:"w-3 h-3 ml-1"}),"تعديل"]}),s.jsx(T,{size:"sm",variant:w.isActive?"secondary":"default",className:"flex-1","data-testid":`button-toggle-product-${w.id}`,children:w.isActive?"إيقاف":"تفعيل"})]})]})]},w.id))})})]})]}):s.jsx(oe,{children:s.jsxs(le,{className:"p-8 text-center",children:[s.jsx(Bt,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"لا يوجد لديك متجر حتى الآن"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"أنشئ متجرك الخاص لعرض منتجاتك وزيادة مبيعاتك"}),s.jsxs(Yt,{open:t,onOpenChange:e,children:[s.jsx(Qa,{asChild:!0,children:s.jsxs(T,{className:"bg-[var(--whatsapp-primary)] hover:bg-[var(--whatsapp-secondary)]","data-testid":"button-create-store",children:[s.jsx(Bs,{className:"w-4 h-4 ml-2"}),"إنشاء متجر جديد"]})}),s.jsxs(Kt,{className:"max-w-md","data-testid":"create-store-modal",children:[s.jsx(Qt,{children:s.jsx(Ht,{children:"إنشاء متجر جديد"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"name",children:"اسم المتجر *"}),s.jsx(Ce,{id:"name",...m.register("name"),placeholder:"متجر الإلكترونيات","data-testid":"input-store-name"}),m.formState.errors.name&&s.jsx("p",{className:"text-sm text-red-500",children:m.formState.errors.name.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"description",children:"وصف المتجر *"}),s.jsx(qs,{id:"description",...m.register("description"),placeholder:"وصف موجز عن متجرك ونوع المنتجات التي تبيعها","data-testid":"input-store-description"}),m.formState.errors.description&&s.jsx("p",{className:"text-sm text-red-500",children:m.formState.errors.description.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"category",children:"فئة المتجر *"}),s.jsx(Ce,{id:"category",...m.register("category"),placeholder:"إلكترونيات، ملابس، طعام، إلخ","data-testid":"input-store-category"}),m.formState.errors.category&&s.jsx("p",{className:"text-sm text-red-500",children:m.formState.errors.category.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"location",children:"الموقع *"}),s.jsx(Ce,{id:"location",...m.register("location"),placeholder:"تندوف، وهران، الجزائر...","data-testid":"input-store-location"}),m.formState.errors.location&&s.jsx("p",{className:"text-sm text-red-500",children:m.formState.errors.location.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"phoneNumber",children:"رقم الهاتف"}),s.jsx(Ce,{id:"phoneNumber",...m.register("phoneNumber"),placeholder:"+213555123456","data-testid":"input-store-phone"})]}),s.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[s.jsx(T,{type:"button",variant:"outline",onClick:()=>e(!1),"data-testid":"button-cancel-create",children:"إلغاء"}),s.jsx(T,{type:"button",disabled:v.isPending,className:"bg-[var(--whatsapp-primary)] hover:bg-[var(--whatsapp-secondary)] disabled:opacity-50","data-testid":"button-submit-create",onClick:Q,children:v.isPending?"جاري الإنشاء...":"إنشاء المتجر"})]})]})]})]})]})}),s.jsx(Yt,{open:r,onOpenChange:a,children:s.jsxs(Kt,{className:"max-w-md","data-testid":"edit-store-modal",children:[s.jsx(Qt,{children:s.jsx(Ht,{children:"تعديل المتجر"})}),s.jsxs("form",{onSubmit:m.handleSubmit(H),className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"name",children:"اسم المتجر *"}),s.jsx(Ce,{id:"name",...m.register("name"),placeholder:"متجر الإلكترونيات","data-testid":"input-edit-store-name"}),m.formState.errors.name&&s.jsx("p",{className:"text-sm text-red-500",children:m.formState.errors.name.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"description",children:"وصف المتجر *"}),s.jsx(qs,{id:"description",...m.register("description"),placeholder:"وصف موجز عن متجرك ونوع المنتجات التي تبيعها","data-testid":"input-edit-store-description"}),m.formState.errors.description&&s.jsx("p",{className:"text-sm text-red-500",children:m.formState.errors.description.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"category",children:"فئة المتجر *"}),s.jsx(Ce,{id:"category",...m.register("category"),placeholder:"إلكترونيات، ملابس، طعام، إلخ","data-testid":"input-edit-store-category"}),m.formState.errors.category&&s.jsx("p",{className:"text-sm text-red-500",children:m.formState.errors.category.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"phoneNumber",children:"رقم الهاتف"}),s.jsx(Ce,{id:"phoneNumber",...m.register("phoneNumber"),placeholder:"+213555123456","data-testid":"input-edit-store-phone"})]}),s.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[s.jsx(T,{type:"button",variant:"outline",onClick:()=>a(!1),"data-testid":"button-cancel-edit",children:"إلغاء"}),s.jsx(T,{type:"submit",disabled:y.isPending,className:"bg-[var(--whatsapp-primary)] hover:bg-[var(--whatsapp-secondary)]","data-testid":"button-submit-edit",children:y.isPending?"جاري التحديث...":"حفظ التغييرات"})]})]})]})})]})})}var cl="Tabs",[O2,jk]=$r(cl,[Em]),Yx=Em(),[D2,dl]=O2(cl),ey=d.forwardRef((t,e)=>{const{__scopeTabs:r,value:a,onValueChange:n,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...h}=t,u=To(l),[p,f]=qa({prop:a,onChange:n,defaultProp:i});return s.jsx(D2,{scope:r,baseId:oi(),value:p,onValueChange:f,orientation:o,dir:u,activationMode:c,children:s.jsx(Ae.div,{dir:u,"data-orientation":o,...h,ref:e})})});ey.displayName=cl;var ty="TabsList",sy=d.forwardRef((t,e)=>{const{__scopeTabs:r,loop:a=!0,...n}=t,i=dl(ty,r),o=Yx(r);return s.jsx(Pv,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:a,children:s.jsx(Ae.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:e})})});sy.displayName=ty;var ry="TabsTrigger",ay=d.forwardRef((t,e)=>{const{__scopeTabs:r,value:a,disabled:n=!1,...i}=t,o=dl(ry,r),l=Yx(r),c=oy(o.baseId,a),h=ly(o.baseId,a),u=a===o.value;return s.jsx(Av,{asChild:!0,...l,focusable:!n,active:u,children:s.jsx(Ae.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":h,"data-state":u?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:c,...i,ref:e,onMouseDown:xe(t.onMouseDown,p=>{!n&&p.button===0&&p.ctrlKey===!1?o.onValueChange(a):p.preventDefault()}),onKeyDown:xe(t.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&o.onValueChange(a)}),onFocus:xe(t.onFocus,()=>{const p=o.activationMode!=="manual";!u&&!n&&p&&o.onValueChange(a)})})})});ay.displayName=ry;var ny="TabsContent",iy=d.forwardRef((t,e)=>{const{__scopeTabs:r,value:a,forceMount:n,children:i,...o}=t,l=dl(ny,r),c=oy(l.baseId,a),h=ly(l.baseId,a),u=a===l.value,p=d.useRef(u);return d.useEffect(()=>{const f=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(f)},[]),s.jsx(qr,{present:n||u,children:({present:f})=>s.jsx(Ae.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:h,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:p.current?"0s":void 0},children:f&&i})})});iy.displayName=ny;function oy(t,e){return`${t}-trigger-${e}`}function ly(t,e){return`${t}-content-${e}`}var F2=ey,cy=sy,dy=ay,uy=iy;const hy=F2,ul=d.forwardRef(({className:t,...e},r)=>s.jsx(cy,{ref:r,className:se("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));ul.displayName=cy.displayName;const Yr=d.forwardRef(({className:t,...e},r)=>s.jsx(dy,{ref:r,className:se("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));Yr.displayName=dy.displayName;const ea=d.forwardRef(({className:t,...e},r)=>s.jsx(uy,{ref:r,className:se("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));ea.displayName=uy.displayName;function L2(){const{toast:t}=lt(),[,e]=ys(),[r,a]=d.useState(null),[n,i]=d.useState(!1),{data:o=[],isLoading:l}=ye({queryKey:["/api/products"]}),{data:c=[],isLoading:h}=ye({queryKey:["/api/user/affiliate-links"]}),{data:u=[],isLoading:p}=ye({queryKey:["/api/user/commissions"]}),{data:f}=ye({queryKey:["/api/user/commissions/total"]}),g=Se({mutationFn:async k=>ce("/api/affiliate-links",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:k})}),onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/user/affiliate-links"]}),i(!1),a(null),t({title:"تم إنشاء رابط التسويق بنجاح!",description:"يمكنك الآن مشاركة الرابط وكسب العمولة من كل عملية بيع"})},onError:()=>{t({title:"خطأ",description:"فشل في إنشاء رابط التسويق",variant:"destructive"})}}),j=Se({mutationFn:async k=>ce("/api/chats/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otherUserId:k})}),onSuccess:k=>{e(`/chat/${k.chatId}`)}}),x=k=>{navigator.clipboard.writeText(k),t({title:"تم النسخ!",description:"تم نسخ الرابط إلى الحافظة"})},m=k=>new Intl.NumberFormat("ar-DZ",{style:"currency",currency:"DZD",minimumFractionDigits:0}).format(parseFloat(k)),S=k=>new Date(k).toLocaleDateString("ar-DZ"),v=k=>`${window.location.origin}/affiliate/${k}`,y=u.filter(k=>k.status==="pending"),C=u.filter(k=>k.status==="paid");return l||h||p?s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-whatsapp-green mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"جارِ التحميل..."})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20 sm:pb-0",children:s.jsxs("div",{className:"max-w-4xl mx-auto p-4",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(or,{className:"w-8 h-8 text-whatsapp-green"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"التسويق بالعمولة"})]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"اكسب المال من خلال تسويق المنتجات والحصول على عمولة من كل عملية بيع"})]}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[s.jsx(oe,{children:s.jsxs(le,{className:"p-4 text-center",children:[s.jsx(or,{className:"w-8 h-8 mx-auto text-green-500 mb-2"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"إجمالي العمولات"}),s.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:f?m(f.total):"0 دج"})]})}),s.jsx(oe,{children:s.jsxs(le,{className:"p-4 text-center",children:[s.jsx(Pn,{className:"w-8 h-8 mx-auto text-blue-500 mb-2"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"روابط التسويق"}),s.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:c.length})]})}),s.jsx(oe,{children:s.jsxs(le,{className:"p-4 text-center",children:[s.jsx(is,{className:"w-8 h-8 mx-auto text-orange-500 mb-2"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"في الانتظار"}),s.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:y.length})]})}),s.jsx(oe,{children:s.jsxs(le,{className:"p-4 text-center",children:[s.jsx(gt,{className:"w-8 h-8 mx-auto text-green-500 mb-2"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"مدفوعة"}),s.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:C.length})]})})]}),s.jsxs(hy,{defaultValue:"links",className:"space-y-6",children:[s.jsxs(ul,{className:"grid w-full grid-cols-3",children:[s.jsx(Yr,{value:"links",children:"روابط التسويق"}),s.jsx(Yr,{value:"products",children:"المنتجات المتاحة"}),s.jsx(Yr,{value:"commissions",children:"العمولات"})]}),s.jsx(ea,{value:"links",className:"space-y-4",children:c.length===0?s.jsx(oe,{children:s.jsxs(le,{className:"p-8 text-center",children:[s.jsx(Pn,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"لا توجد روابط تسويقية"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"ابدأ بإنشاء أول رابط تسويقي لك"}),s.jsxs(T,{onClick:()=>i(!0),className:"bg-whatsapp-green hover:bg-whatsapp-green/90",children:[s.jsx(Bs,{className:"w-4 h-4 ml-2"}),"إنشاء رابط تسويقي"]})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["روابط التسويق (",c.length,")"]}),s.jsxs(T,{onClick:()=>i(!0),className:"bg-whatsapp-green hover:bg-whatsapp-green/90",children:[s.jsx(Bs,{className:"w-4 h-4 ml-2"}),"إنشاء رابط جديد"]})]}),s.jsx("div",{className:"grid gap-4",children:c.map(k=>s.jsx(oe,{children:s.jsx(le,{className:"p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[k.product.imageUrl&&s.jsx("img",{src:k.product.imageUrl,alt:k.product.name,className:"w-20 h-20 rounded-lg object-cover"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:k.product.name}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["السعر: ",m(k.product.price)," • العمولة: ",(parseFloat(k.product.commissionRate)*100).toFixed(0),"%"]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Mb,{className:"w-4 h-4"}),s.jsxs("span",{children:[k.clicks," نقرة"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(no,{className:"w-4 h-4"}),s.jsxs("span",{children:[k.conversions," عملية بيع"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(or,{className:"w-4 h-4"}),s.jsxs("span",{children:["عمولة: ",m(k.totalCommission)]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ce,{value:v(k.uniqueCode),readOnly:!0,className:"text-sm"}),s.jsx(T,{size:"sm",variant:"outline",onClick:()=>x(v(k.uniqueCode)),children:s.jsx(kb,{className:"w-4 h-4"})}),s.jsx(T,{size:"sm",variant:"outline",onClick:()=>window.open(v(k.uniqueCode),"_blank"),children:s.jsx(io,{className:"w-4 h-4"})})]})]})]})})},k.id))})]})}),s.jsxs(ea,{value:"products",className:"space-y-4",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"المنتجات المتاحة للتسويق"})}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:o.map(k=>{const D=c.some(Q=>Q.product.id===k.id);return s.jsxs(oe,{className:"overflow-hidden",children:[k.imageUrl&&s.jsx("img",{src:k.imageUrl,alt:k.name,className:"w-full h-48 object-cover"}),s.jsxs(le,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:k.name}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:k.description}),s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"text-lg font-bold text-whatsapp-green",children:m(k.price)}),s.jsxs(Te,{variant:"secondary",children:["عمولة ",(parseFloat(k.commissionRate)*100).toFixed(0),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("p",{children:["البائع: ",k.owner.name]}),s.jsxs("p",{children:["الموقع: ",k.location]})]}),s.jsxs(T,{variant:"ghost",size:"sm",onClick:()=>j.mutate(k.owner.id),disabled:j.isPending,className:"text-whatsapp-green hover:bg-green-50 dark:hover:bg-green-950","data-testid":`button-contact-owner-${k.id}`,children:[s.jsx(fn,{className:"w-4 h-4 ml-1"}),"تواصل"]})]}),D?s.jsxs(Te,{variant:"default",className:"w-full justify-center py-2",children:[s.jsx(gt,{className:"w-4 h-4 ml-2"}),"لديك رابط تسويقي"]}):s.jsx(T,{onClick:()=>{a(k),g.mutate(k.id)},disabled:g.isPending,className:"w-full bg-whatsapp-green hover:bg-whatsapp-green/90",children:g.isPending?"جارِ الإنشاء...":s.jsxs(s.Fragment,{children:[s.jsx(Pn,{className:"w-4 h-4 ml-2"}),"إنشاء رابط تسويقي"]})})]})]},k.id)})})]}),s.jsxs(ea,{value:"commissions",className:"space-y-4",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["تاريخ العمولات (",u.length,")"]})}),u.length===0?s.jsx(oe,{children:s.jsxs(le,{className:"p-8 text-center",children:[s.jsx(no,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"لا توجد عمولات بعد"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"ابدأ بتسويق المنتجات لكسب العمولات"})]})}):s.jsx("div",{className:"space-y-3",children:u.map(k=>s.jsx(oe,{children:s.jsx(le,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:k.affiliateLink.product.name}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:S(k.createdAt)})]}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-lg font-bold text-whatsapp-green",children:m(k.amount)}),s.jsx(Te,{variant:k.status==="paid"?"default":"secondary",className:k.status==="paid"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"",children:k.status==="paid"?"مدفوعة":k.status==="pending"?"في الانتظار":"ملغية"})]})]})})},k.id))})]})]}),s.jsx(Yt,{open:n,onOpenChange:i,children:s.jsxs(Kt,{children:[s.jsx(Qt,{children:s.jsx(Ht,{children:"اختر منتجاً للتسويق"})}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:s.jsx("div",{className:"grid gap-3",children:o.filter(k=>!c.some(D=>D.product.id===k.id)).map(k=>s.jsx(oe,{className:"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:()=>{a(k),g.mutate(k.id)},children:s.jsx(le,{className:"p-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[k.imageUrl&&s.jsx("img",{src:k.imageUrl,alt:k.name,className:"w-12 h-12 rounded object-cover"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:k.name}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsx("span",{children:m(k.price)}),s.jsxs(Te,{variant:"secondary",className:"text-xs",children:[(parseFloat(k.commissionRate)*100).toFixed(0),"%"]})]})]})]})})},k.id))})})]})})]})})}function V2(){var L,$;const[t,e]=d.useState(!1),[r,a]=d.useState(""),[n,i]=d.useState(""),[o,l]=d.useState(""),[c,h]=d.useState(!1),[u,p]=d.useState(""),[f,g]=d.useState(!1),{toast:j}=lt(),x=vs(),{data:m,isLoading:S}=ye({queryKey:["/api/user/current"]}),{data:v=[]}=ye({queryKey:["/api/user/verification-requests"],enabled:!!m});d.useEffect(()=>{m&&(a(m.name||""),i(m.location||""),l(m.avatar||""))},[m]);const y=Se({mutationFn:async w=>ce("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)}),onSuccess:()=>{x.invalidateQueries({queryKey:["/api/user/current"]}),e(!1),j({title:"تم التحديث",description:"تم تحديث ملفك الشخصي بنجاح"})},onError:w=>{j({title:"خطأ",description:w.message||"فشل في تحديث الملف الشخصي",variant:"destructive"})}}),C=Se({mutationFn:async w=>{const A=new FormData;A.append("media",w);const I=localStorage.getItem("auth_token");if(!I)throw new Error("يجب تسجيل الدخول أولاً");const K=await fetch("/api/upload/media",{method:"POST",headers:{Authorization:`Bearer ${I}`},body:A});if(!K.ok)throw new Error("فشل في رفع الصورة");return K.json()},onSuccess:w=>{l(w.mediaUrl),j({title:"تم رفع الصورة",description:"تم رفع صورة الملف الشخصي بنجاح"})},onError:w=>{j({title:"خطأ",description:w.message||"فشل في رفع الصورة",variant:"destructive"})}}),k=Se({mutationFn:async w=>ce("/api/verification-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)}),onSuccess:()=>{x.invalidateQueries({queryKey:["/api/user/verification-requests"]}),h(!1),p(""),j({title:"تم إرسال الطلب",description:"تم إرسال طلب التوثيق بنجاح، سيتم مراجعته قريباً"})},onError:()=>{j({title:"خطأ",description:"فشل في إرسال طلب التوثيق",variant:"destructive"})}}),D=Se({mutationFn:async()=>ce("/api/user/delete-account",{method:"DELETE",headers:{"Content-Type":"application/json"}}),onSuccess:()=>{j({title:"تم حذف الحساب",description:"تم حذف حسابك بنجاح"}),localStorage.removeItem("auth_token"),window.location.href="/login"},onError:w=>{j({title:"خطأ",description:w.message||"فشل في حذف الحساب",variant:"destructive"})}}),Q=w=>{var I;const A=(I=w.target.files)==null?void 0:I[0];if(A){if(A.size>10*1024*1024){j({title:"خطأ",description:"حجم الصورة كبير جداً. يرجى اختيار صورة أصغر من 10 ميجابايت",variant:"destructive"});return}if(!A.type.startsWith("image/")){j({title:"خطأ",description:"يرجى اختيار ملف صورة صحيح",variant:"destructive"});return}t||e(!0),C.mutate(A)}w.target.value=""},H=()=>{if(!r.trim()||!n.trim()){j({title:"خطأ",description:"يرجى ملء جميع الحقول المطلوبة",variant:"destructive"});return}y.mutate({name:r.trim(),location:n.trim(),avatar:o})},M=()=>{m&&(a(m.name||""),i(m.location||""),l(m.avatar||"")),e(!1)};return S?s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20 flex items-center justify-center",children:s.jsx("div",{className:"text-lg",children:"جاري التحميل..."})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20",children:[s.jsx("div",{className:"bg-whatsapp-green text-white p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(jt,{href:"/",children:s.jsx(T,{variant:"ghost",size:"icon",className:"text-white hover:bg-green-600 w-12 h-12 rounded-full","data-testid":"button-back",children:s.jsx(Sa,{className:"w-6 h-6"})})}),s.jsx("h1",{className:"text-2xl font-bold",children:"الملف الشخصي"})]}),!t&&s.jsxs(T,{onClick:()=>e(!0),variant:"ghost",className:"text-white hover:bg-green-600 px-4 py-2 rounded-xl","data-testid":"button-edit",children:[s.jsx(Ef,{className:"w-5 h-5 ml-2"}),"تعديل"]})]})}),s.jsxs("div",{className:"px-4 py-6 space-y-6",children:[s.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsxs(Ft,{className:"w-32 h-32",children:[s.jsx(Lt,{src:o||(m==null?void 0:m.avatar)||void 0,alt:r||(m==null?void 0:m.name)}),s.jsx(Vt,{className:"text-2xl",children:(($=(L=r||(m==null?void 0:m.name))==null?void 0:L.charAt(0))==null?void 0:$.toUpperCase())||"U"})]}),s.jsxs("div",{className:"absolute bottom-0 right-0",children:[s.jsx("label",{htmlFor:"avatar-upload",className:"cursor-pointer",children:s.jsx("div",{className:"w-10 h-10 rounded-full bg-whatsapp-green hover:bg-green-600 flex items-center justify-center shadow-lg transition-all duration-200 hover:scale-105",children:C.isPending?s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(Of,{className:"w-5 h-5 text-white"})})}),s.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*,image/jpeg,image/png,image/gif,image/webp",onChange:Q,className:"hidden","data-testid":"input-avatar-upload"})]})]}),C.isPending?s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}),"جاري رفع الصورة..."]}):s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"اضغط لتحميل صورة من هاتفك"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Pe,{htmlFor:"name",className:"flex items-center gap-2 text-lg",children:[s.jsx(_s,{className:"w-5 h-5"}),"الاسم",(m==null?void 0:m.isVerified)&&s.jsx("div",{title:"حساب موثق",children:s.jsx(Ba,{className:"w-4 h-4 text-blue-500","data-testid":"badge-verified-user"})})]}),t?s.jsx(Ce,{id:"name",value:r,onChange:w=>a(w.target.value),placeholder:"أدخل اسمك",className:"text-lg h-12 rounded-xl","data-testid":"input-name"}):s.jsx("div",{className:"text-xl p-3 bg-white dark:bg-gray-800 rounded-xl",children:(m==null?void 0:m.name)||"غير محدد"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Pe,{className:"flex items-center gap-2 text-lg",children:[s.jsx(Es,{className:"w-5 h-5"}),"رقم الهاتف"]}),s.jsx("div",{className:"text-xl p-3 bg-gray-100 dark:bg-gray-700 rounded-xl text-gray-600 dark:text-gray-400",children:(m==null?void 0:m.phoneNumber)||"غير محدد"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Pe,{htmlFor:"location",className:"flex items-center gap-2 text-lg",children:[s.jsx(gs,{className:"w-5 h-5"}),"المنطقة"]}),t?s.jsx(Ce,{id:"location",value:n,onChange:w=>i(w.target.value),placeholder:"أدخل منطقتك",className:"text-lg h-12 rounded-xl","data-testid":"input-location"}):s.jsx("div",{className:"text-xl p-3 bg-white dark:bg-gray-800 rounded-xl",children:(m==null?void 0:m.location)||"غير محدد"})]})]}),!t&&s.jsxs(oe,{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20 border-blue-200 dark:border-blue-800",children:[s.jsxs(xt,{children:[s.jsxs(Nt,{className:"flex items-center gap-2 text-blue-700 dark:text-blue-400",children:[s.jsx(lo,{className:"w-5 h-5"}),"توثيق الحساب"]}),s.jsx(lr,{children:"احصل على العلامة الزرقاء واستمتع بالمزايا الحصرية"})]}),s.jsx(le,{className:"space-y-4",children:m!=null&&m.isVerified?s.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[s.jsx(Ba,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:"حسابك موثق ✨"})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"مزايا التوثيق:"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:"النجمة الزرقاء بجانب اسمك"})]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:"أولوية في نتائج البحث"})]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:"زيادة الثقة مع العملاء"})]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:"دعم فني مخصص"})]})]})]}),v.length>0&&s.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-950/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:s.jsxs("div",{className:"flex items-center gap-2 text-yellow-700 dark:text-yellow-400",children:[v[0].status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx(is,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"طلبك قيد المراجعة..."})]}),v[0].status==="approved"&&s.jsxs(s.Fragment,{children:[s.jsx(Gs,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"تم قبول طلبك!"})]}),v[0].status==="rejected"&&s.jsxs(s.Fragment,{children:[s.jsx(Rn,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"تم رفض الطلب"})]})]})}),v.filter(w=>w.status==="pending").length===0&&s.jsxs(Yt,{open:c,onOpenChange:h,children:[s.jsx(Qa,{asChild:!0,children:s.jsxs(T,{className:"w-full bg-blue-500 hover:bg-blue-600","data-testid":"button-request-verification",children:[s.jsx(lo,{className:"w-4 h-4 ml-2"}),"طلب توثيق الحساب"]})}),s.jsxs(Kt,{children:[s.jsxs(Qt,{children:[s.jsx(Ht,{children:"طلب توثيق الحساب"}),s.jsx(Fn,{children:"أخبرنا لماذا تستحق التوثيق واحصل على العلامة الزرقاء"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Pe,{htmlFor:"verification-reason",children:"سبب طلب التوثيق:"}),s.jsx(qs,{id:"verification-reason",placeholder:"مثال: أنا صاحب متجر معروف في المنطقة أو لدي خبرة في التجارة...",value:u,onChange:w=>p(w.target.value),className:"mt-2","data-testid":"textarea-verification-reason"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(T,{variant:"outline",onClick:()=>h(!1),className:"flex-1",children:"إلغاء"}),s.jsx(T,{onClick:()=>k.mutate({requestType:"user",reason:u}),disabled:!u.trim()||k.isPending,className:"flex-1 bg-blue-500 hover:bg-blue-600","data-testid":"button-submit-verification",children:k.isPending?"جاري الإرسال...":"إرسال الطلب"})]})]})]})]})]})})]}),t&&s.jsxs("div",{className:"flex gap-3 pt-6",children:[s.jsx(T,{onClick:M,variant:"outline",className:"flex-1 h-12 text-lg rounded-xl","data-testid":"button-cancel",children:"إلغاء"}),s.jsx(T,{onClick:H,disabled:y.isPending,className:"flex-1 h-12 text-lg rounded-xl bg-whatsapp-green hover:bg-green-600","data-testid":"button-save",children:y.isPending?"جاري الحفظ...":s.jsxs(s.Fragment,{children:[s.jsx(If,{className:"w-5 h-5 ml-2"}),"حفظ"]})})]}),!t&&s.jsx("div",{className:"pt-8 border-t border-gray-200 dark:border-gray-700",children:s.jsxs(Yt,{open:f,onOpenChange:g,children:[s.jsx(Qa,{asChild:!0,children:s.jsxs(T,{variant:"destructive",className:"w-full h-12 text-lg rounded-xl bg-red-500 hover:bg-red-600","data-testid":"button-delete-account",children:[s.jsx(Bo,{className:"w-5 h-5 ml-2"}),"حذف الحساب"]})}),s.jsxs(Kt,{children:[s.jsxs(Qt,{children:[s.jsx(Ht,{className:"text-red-600",children:"حذف الحساب"}),s.jsx(Fn,{children:"هل أنت متأكد من رغبتك في حذف حسابك نهائياً؟"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-950/20 rounded-lg border border-red-200 dark:border-red-800",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Rn,{className:"w-5 h-5 text-red-500 mt-0.5"}),s.jsxs("div",{className:"space-y-2 text-sm text-red-700 dark:text-red-400",children:[s.jsx("p",{className:"font-medium",children:"تحذير هام:"}),s.jsxs("ul",{className:"space-y-1 text-xs",children:[s.jsx("li",{children:"• سيتم حذف جميع بياناتك نهائياً"}),s.jsx("li",{children:"• سيتم حذف متجرك وجميع منتجاتك"}),s.jsx("li",{children:"• سيتم حذف جميع محادثاتك ورسائلك"}),s.jsx("li",{children:"• لن تتمكن من استرداد هذه البيانات"})]})]})]})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(T,{variant:"outline",onClick:()=>g(!1),className:"flex-1","data-testid":"button-cancel-delete",children:"إلغاء"}),s.jsx(T,{variant:"destructive",onClick:()=>D.mutate(),disabled:D.isPending,className:"flex-1 bg-red-500 hover:bg-red-600","data-testid":"button-confirm-delete",children:D.isPending?"جاري الحذف...":"حذف نهائياً"})]})]})]})]})})]})]})}function z2(){const{toast:t}=lt(),[,e]=Um("/affiliate/:uniqueCode"),[r,a]=d.useState(null),[n,i]=d.useState(!0),[o,l]=d.useState(null),[c,h]=d.useState(!1);d.useEffect(()=>{if(!(e!=null&&e.uniqueCode))return;(async()=>{try{const g=await fetch(`/api/affiliate/${e.uniqueCode}/click`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!g.ok)throw new Error("الرابط غير صالح أو منتهي الصلاحية");const j=await g.json();a(j.product)}catch(g){l(g instanceof Error?g.message:"حدث خطأ غير متوقع")}finally{i(!1)}})()},[e==null?void 0:e.uniqueCode]);const u=()=>{r&&(h(!0),setTimeout(()=>{t({title:"تم تسجيل اهتمامك!",description:"شكراً لزيارة المنتج عبر الرابط التسويقي"}),h(!1)},1e3))},p=f=>new Intl.NumberFormat("ar-DZ",{style:"currency",currency:"DZD",minimumFractionDigits:0}).format(parseFloat(f));return n?s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:s.jsx(oe,{className:"w-full max-w-md",children:s.jsxs(le,{className:"p-8 text-center",children:[s.jsx(oo,{className:"w-8 h-8 animate-spin mx-auto text-whatsapp-green mb-4"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"جارِ التحميل..."}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"يتم تحميل معلومات المنتج"})]})})}):o||!r?s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:s.jsx(oe,{className:"w-full max-w-md",children:s.jsxs(le,{className:"p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(io,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"رابط غير صالح"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:o||"هذا الرابط غير صالح أو منتهي الصلاحية"}),s.jsx(T,{onClick:()=>window.location.href="/",variant:"outline",children:"العودة للرئيسية"})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:s.jsx(oe,{className:"w-full max-w-2xl",children:s.jsxs(le,{className:"p-6",children:[s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 text-blue-800 dark:text-blue-200",children:[s.jsx(or,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"رابط تسويقي"})]}),s.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-300 mt-1",children:"هذا المنتج تم مشاركته عبر نظام التسويق بالعمولة في BizChat"})]}),s.jsxs("div",{className:"flex gap-6 mb-6",children:[r.imageUrl&&s.jsx("img",{src:r.imageUrl,alt:r.name,className:"w-32 h-32 rounded-lg object-cover flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:r.name}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 line-clamp-3",children:r.description}),s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"text-2xl font-bold text-whatsapp-green",children:p(r.price)}),s.jsx(Te,{variant:"secondary",children:r.category})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_s,{className:"w-4 h-4"}),s.jsxs("span",{children:["البائع: ",r.owner.name]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gs,{className:"w-4 h-4"}),s.jsxs("span",{children:["الموقع: ",r.location]})]})]})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(T,{onClick:u,disabled:c,className:"flex-1 bg-whatsapp-green hover:bg-whatsapp-green/90",children:c?s.jsxs(s.Fragment,{children:[s.jsx(oo,{className:"w-4 h-4 ml-2 animate-spin"}),"جارِ التوجيه..."]}):s.jsxs(s.Fragment,{children:[s.jsx(io,{className:"w-4 h-4 ml-2"}),"عرض المنتج"]})}),s.jsx(T,{variant:"outline",onClick:()=>window.location.href="/",children:"تصفح المزيد"})]}),s.jsxs("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-green-800 dark:text-green-200 mb-1",children:[s.jsx(or,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"معلومات العمولة"})]}),s.jsxs("p",{className:"text-xs text-green-600 dark:text-green-300",children:["المسوق يحصل على عمولة ",(parseFloat(r.commissionRate)*100).toFixed(0),"% عند شراء هذا المنتج عبر هذا الرابط"]})]})]})})})}function my(t){const e=d.useRef({value:t,previous:t});return d.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var $2=[" ","Enter","ArrowUp","ArrowDown"],q2=[" ","Enter"],yn="Select",[Si,ki,U2]=um(yn),[_a,Nk]=$r(yn,[U2,ii]),Ci=ii(),[B2,gr]=_a(yn),[K2,Q2]=_a(yn),fy=t=>{const{__scopeSelect:e,children:r,open:a,defaultOpen:n,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:h,name:u,autoComplete:p,disabled:f,required:g,form:j}=t,x=Ci(e),[m,S]=d.useState(null),[v,y]=d.useState(null),[C,k]=d.useState(!1),D=To(h),[Q=!1,H]=qa({prop:a,defaultProp:n,onChange:i}),[M,L]=qa({prop:o,defaultProp:l,onChange:c}),$=d.useRef(null),w=m?j||!!m.closest("form"):!0,[A,I]=d.useState(new Set),K=Array.from(A).map(E=>E.props.value).join(";");return s.jsx(Dv,{...x,children:s.jsxs(B2,{required:g,scope:e,trigger:m,onTriggerChange:S,valueNode:v,onValueNodeChange:y,valueNodeHasChildren:C,onValueNodeHasChildrenChange:k,contentId:oi(),value:M,onValueChange:L,open:Q,onOpenChange:H,dir:D,triggerPointerDownPosRef:$,disabled:f,children:[s.jsx(Si.Provider,{scope:e,children:s.jsx(K2,{scope:t.__scopeSelect,onNativeOptionAdd:d.useCallback(E=>{I(U=>new Set(U).add(E))},[]),onNativeOptionRemove:d.useCallback(E=>{I(U=>{const te=new Set(U);return te.delete(E),te})},[]),children:r})}),w?s.jsxs(Vy,{"aria-hidden":!0,required:g,tabIndex:-1,name:u,autoComplete:p,value:M,onChange:E=>L(E.target.value),disabled:f,form:j,children:[M===void 0?s.jsx("option",{value:""}):null,Array.from(A)]},K):null]})})};fy.displayName=yn;var py="SelectTrigger",gy=d.forwardRef((t,e)=>{const{__scopeSelect:r,disabled:a=!1,...n}=t,i=Ci(r),o=gr(py,r),l=o.disabled||a,c=ot(e,o.onTriggerChange),h=ki(r),u=d.useRef("touch"),[p,f,g]=zy(x=>{const m=h().filter(y=>!y.disabled),S=m.find(y=>y.value===o.value),v=$y(m,x,S);v!==void 0&&o.onValueChange(v.value)}),j=x=>{l||(o.onOpenChange(!0),g()),x&&(o.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return s.jsx(mm,{asChild:!0,...i,children:s.jsx(Ae.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":Ly(o.value)?"":void 0,...n,ref:c,onClick:xe(n.onClick,x=>{x.currentTarget.focus(),u.current!=="mouse"&&j(x)}),onPointerDown:xe(n.onPointerDown,x=>{u.current=x.pointerType;const m=x.target;m.hasPointerCapture(x.pointerId)&&m.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(j(x),x.preventDefault())}),onKeyDown:xe(n.onKeyDown,x=>{const m=p.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&f(x.key),!(m&&x.key===" ")&&$2.includes(x.key)&&(j(),x.preventDefault())})})})});gy.displayName=py;var xy="SelectValue",yy=d.forwardRef((t,e)=>{const{__scopeSelect:r,className:a,style:n,children:i,placeholder:o="",...l}=t,c=gr(xy,r),{onValueNodeHasChildrenChange:h}=c,u=i!==void 0,p=ot(e,c.onValueNodeChange);return ts(()=>{h(u)},[h,u]),s.jsx(Ae.span,{...l,ref:p,style:{pointerEvents:"none"},children:Ly(c.value)?s.jsx(s.Fragment,{children:o}):i})});yy.displayName=xy;var H2="SelectIcon",vy=d.forwardRef((t,e)=>{const{__scopeSelect:r,children:a,...n}=t;return s.jsx(Ae.span,{"aria-hidden":!0,...n,ref:e,children:a||"▼"})});vy.displayName=H2;var Z2="SelectPortal",by=t=>s.jsx(hm,{asChild:!0,...t});by.displayName=Z2;var zr="SelectContent",wy=d.forwardRef((t,e)=>{const r=gr(zr,t.__scopeSelect),[a,n]=d.useState();if(ts(()=>{n(new DocumentFragment)},[]),!r.open){const i=a;return i?li.createPortal(s.jsx(jy,{scope:t.__scopeSelect,children:s.jsx(Si.Slot,{scope:t.__scopeSelect,children:s.jsx("div",{children:t.children})})}),i):null}return s.jsx(Ny,{...t,ref:e})});wy.displayName=zr;var ls=10,[jy,xr]=_a(zr),W2="SelectContentImpl",G2=Ov("SelectContent.RemoveScroll"),Ny=d.forwardRef((t,e)=>{const{__scopeSelect:r,position:a="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:h,alignOffset:u,arrowPadding:p,collisionBoundary:f,collisionPadding:g,sticky:j,hideWhenDetached:x,avoidCollisions:m,...S}=t,v=gr(zr,r),[y,C]=d.useState(null),[k,D]=d.useState(null),Q=ot(e,ue=>C(ue)),[H,M]=d.useState(null),[L,$]=d.useState(null),w=ki(r),[A,I]=d.useState(!1),K=d.useRef(!1);d.useEffect(()=>{if(y)return Ev(y)},[y]),Iv();const E=d.useCallback(ue=>{const[ze,...Ge]=w().map(Oe=>Oe.ref.current),[$e]=Ge.slice(-1),Ve=document.activeElement;for(const Oe of ue)if(Oe===Ve||(Oe==null||Oe.scrollIntoView({block:"nearest"}),Oe===ze&&k&&(k.scrollTop=0),Oe===$e&&k&&(k.scrollTop=k.scrollHeight),Oe==null||Oe.focus(),document.activeElement!==Ve))return},[w,k]),U=d.useCallback(()=>E([H,y]),[E,H,y]);d.useEffect(()=>{A&&U()},[A,U]);const{onOpenChange:te,triggerPointerDownPosRef:q}=v;d.useEffect(()=>{if(y){let ue={x:0,y:0};const ze=$e=>{var Ve,Oe;ue={x:Math.abs(Math.round($e.pageX)-(((Ve=q.current)==null?void 0:Ve.x)??0)),y:Math.abs(Math.round($e.pageY)-(((Oe=q.current)==null?void 0:Oe.y)??0))}},Ge=$e=>{ue.x<=10&&ue.y<=10?$e.preventDefault():y.contains($e.target)||te(!1),document.removeEventListener("pointermove",ze),q.current=null};return q.current!==null&&(document.addEventListener("pointermove",ze),document.addEventListener("pointerup",Ge,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ze),document.removeEventListener("pointerup",Ge,{capture:!0})}}},[y,te,q]),d.useEffect(()=>{const ue=()=>te(!1);return window.addEventListener("blur",ue),window.addEventListener("resize",ue),()=>{window.removeEventListener("blur",ue),window.removeEventListener("resize",ue)}},[te]);const[ge,Me]=zy(ue=>{const ze=w().filter(Ve=>!Ve.disabled),Ge=ze.find(Ve=>Ve.ref.current===document.activeElement),$e=$y(ze,ue,Ge);$e&&setTimeout(()=>$e.ref.current.focus())}),Ke=d.useCallback((ue,ze,Ge)=>{const $e=!K.current&&!Ge;(v.value!==void 0&&v.value===ze||$e)&&(M(ue),$e&&(K.current=!0))},[v.value]),Qe=d.useCallback(()=>y==null?void 0:y.focus(),[y]),ut=d.useCallback((ue,ze,Ge)=>{const $e=!K.current&&!Ge;(v.value!==void 0&&v.value===ze||$e)&&$(ue)},[v.value]),St=a==="popper"?wo:Sy,ss=St===wo?{side:l,sideOffset:c,align:h,alignOffset:u,arrowPadding:p,collisionBoundary:f,collisionPadding:g,sticky:j,hideWhenDetached:x,avoidCollisions:m}:{};return s.jsx(jy,{scope:r,content:y,viewport:k,onViewportChange:D,itemRefCallback:Ke,selectedItem:H,onItemLeave:Qe,itemTextRefCallback:ut,focusSelectedItem:U,selectedItemText:L,position:a,isPositioned:A,searchRef:ge,children:s.jsx(Rv,{as:G2,allowPinchZoom:!0,children:s.jsx(Mv,{asChild:!0,trapped:v.open,onMountAutoFocus:ue=>{ue.preventDefault()},onUnmountAutoFocus:xe(n,ue=>{var ze;(ze=v.trigger)==null||ze.focus({preventScroll:!0}),ue.preventDefault()}),children:s.jsx(fm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:ue=>ue.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:s.jsx(St,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:ue=>ue.preventDefault(),...S,...ss,onPlaced:()=>I(!0),ref:Q,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:xe(S.onKeyDown,ue=>{const ze=ue.ctrlKey||ue.altKey||ue.metaKey;if(ue.key==="Tab"&&ue.preventDefault(),!ze&&ue.key.length===1&&Me(ue.key),["ArrowUp","ArrowDown","Home","End"].includes(ue.key)){let $e=w().filter(Ve=>!Ve.disabled).map(Ve=>Ve.ref.current);if(["ArrowUp","End"].includes(ue.key)&&($e=$e.slice().reverse()),["ArrowUp","ArrowDown"].includes(ue.key)){const Ve=ue.target,Oe=$e.indexOf(Ve);$e=$e.slice(Oe+1)}setTimeout(()=>E($e)),ue.preventDefault()}})})})})})})});Ny.displayName=W2;var X2="SelectItemAlignedPosition",Sy=d.forwardRef((t,e)=>{const{__scopeSelect:r,onPlaced:a,...n}=t,i=gr(zr,r),o=xr(zr,r),[l,c]=d.useState(null),[h,u]=d.useState(null),p=ot(e,Q=>u(Q)),f=ki(r),g=d.useRef(!1),j=d.useRef(!0),{viewport:x,selectedItem:m,selectedItemText:S,focusSelectedItem:v}=o,y=d.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&h&&x&&m&&S){const Q=i.trigger.getBoundingClientRect(),H=h.getBoundingClientRect(),M=i.valueNode.getBoundingClientRect(),L=S.getBoundingClientRect();if(i.dir!=="rtl"){const Ve=L.left-H.left,Oe=M.left-Ve,Zt=Q.left-Oe,ie=Q.width+Zt,pe=Math.max(ie,H.width),We=window.innerWidth-ls,st=ho(Oe,[ls,Math.max(ls,We-pe)]);l.style.minWidth=ie+"px",l.style.left=st+"px"}else{const Ve=H.right-L.right,Oe=window.innerWidth-M.right-Ve,Zt=window.innerWidth-Q.right-Oe,ie=Q.width+Zt,pe=Math.max(ie,H.width),We=window.innerWidth-ls,st=ho(Oe,[ls,Math.max(ls,We-pe)]);l.style.minWidth=ie+"px",l.style.right=st+"px"}const $=f(),w=window.innerHeight-ls*2,A=x.scrollHeight,I=window.getComputedStyle(h),K=parseInt(I.borderTopWidth,10),E=parseInt(I.paddingTop,10),U=parseInt(I.borderBottomWidth,10),te=parseInt(I.paddingBottom,10),q=K+E+A+te+U,ge=Math.min(m.offsetHeight*5,q),Me=window.getComputedStyle(x),Ke=parseInt(Me.paddingTop,10),Qe=parseInt(Me.paddingBottom,10),ut=Q.top+Q.height/2-ls,St=w-ut,ss=m.offsetHeight/2,ue=m.offsetTop+ss,ze=K+E+ue,Ge=q-ze;if(ze<=ut){const Ve=$.length>0&&m===$[$.length-1].ref.current;l.style.bottom="0px";const Oe=h.clientHeight-x.offsetTop-x.offsetHeight,Zt=Math.max(St,ss+(Ve?Qe:0)+Oe+U),ie=ze+Zt;l.style.height=ie+"px"}else{const Ve=$.length>0&&m===$[0].ref.current;l.style.top="0px";const Zt=Math.max(ut,K+x.offsetTop+(Ve?Ke:0)+ss)+Ge;l.style.height=Zt+"px",x.scrollTop=ze-ut+x.offsetTop}l.style.margin=`${ls}px 0`,l.style.minHeight=ge+"px",l.style.maxHeight=w+"px",a==null||a(),requestAnimationFrame(()=>g.current=!0)}},[f,i.trigger,i.valueNode,l,h,x,m,S,i.dir,a]);ts(()=>y(),[y]);const[C,k]=d.useState();ts(()=>{h&&k(window.getComputedStyle(h).zIndex)},[h]);const D=d.useCallback(Q=>{Q&&j.current===!0&&(y(),v==null||v(),j.current=!1)},[y,v]);return s.jsx(Y2,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:g,onScrollButtonChange:D,children:s.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C},children:s.jsx(Ae.div,{...n,ref:p,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}})})})});Sy.displayName=X2;var J2="SelectPopperPosition",wo=d.forwardRef((t,e)=>{const{__scopeSelect:r,align:a="start",collisionPadding:n=ls,...i}=t,o=Ci(r);return s.jsx(pm,{...o,...i,ref:e,align:a,collisionPadding:n,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});wo.displayName=J2;var[Y2,hl]=_a(zr,{}),jo="SelectViewport",ky=d.forwardRef((t,e)=>{const{__scopeSelect:r,nonce:a,...n}=t,i=xr(jo,r),o=hl(jo,r),l=ot(e,i.onViewportChange),c=d.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),s.jsx(Si.Slot,{scope:r,children:s.jsx(Ae.div,{"data-radix-select-viewport":"",role:"presentation",...n,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...n.style},onScroll:xe(n.onScroll,h=>{const u=h.currentTarget,{contentWrapper:p,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&p){const g=Math.abs(c.current-u.scrollTop);if(g>0){const j=window.innerHeight-ls*2,x=parseFloat(p.style.minHeight),m=parseFloat(p.style.height),S=Math.max(x,m);if(S<j){const v=S+g,y=Math.min(j,v),C=v-y;p.style.height=y+"px",p.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,p.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});ky.displayName=jo;var Cy="SelectGroup",[eS,tS]=_a(Cy),sS=d.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t,n=oi();return s.jsx(eS,{scope:r,id:n,children:s.jsx(Ae.div,{role:"group","aria-labelledby":n,...a,ref:e})})});sS.displayName=Cy;var _y="SelectLabel",Ty=d.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t,n=tS(_y,r);return s.jsx(Ae.div,{id:n.id,...a,ref:e})});Ty.displayName=_y;var ti="SelectItem",[rS,Py]=_a(ti),Ay=d.forwardRef((t,e)=>{const{__scopeSelect:r,value:a,disabled:n=!1,textValue:i,...o}=t,l=gr(ti,r),c=xr(ti,r),h=l.value===a,[u,p]=d.useState(i??""),[f,g]=d.useState(!1),j=ot(e,v=>{var y;return(y=c.itemRefCallback)==null?void 0:y.call(c,v,a,n)}),x=oi(),m=d.useRef("touch"),S=()=>{n||(l.onValueChange(a),l.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(rS,{scope:r,value:a,disabled:n,textId:x,isSelected:h,onItemTextChange:d.useCallback(v=>{p(y=>y||((v==null?void 0:v.textContent)??"").trim())},[]),children:s.jsx(Si.ItemSlot,{scope:r,value:a,disabled:n,textValue:u,children:s.jsx(Ae.div,{role:"option","aria-labelledby":x,"data-highlighted":f?"":void 0,"aria-selected":h&&f,"data-state":h?"checked":"unchecked","aria-disabled":n||void 0,"data-disabled":n?"":void 0,tabIndex:n?void 0:-1,...o,ref:j,onFocus:xe(o.onFocus,()=>g(!0)),onBlur:xe(o.onBlur,()=>g(!1)),onClick:xe(o.onClick,()=>{m.current!=="mouse"&&S()}),onPointerUp:xe(o.onPointerUp,()=>{m.current==="mouse"&&S()}),onPointerDown:xe(o.onPointerDown,v=>{m.current=v.pointerType}),onPointerMove:xe(o.onPointerMove,v=>{var y;m.current=v.pointerType,n?(y=c.onItemLeave)==null||y.call(c):m.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:xe(o.onPointerLeave,v=>{var y;v.currentTarget===document.activeElement&&((y=c.onItemLeave)==null||y.call(c))}),onKeyDown:xe(o.onKeyDown,v=>{var C;((C=c.searchRef)==null?void 0:C.current)!==""&&v.key===" "||(q2.includes(v.key)&&S(),v.key===" "&&v.preventDefault())})})})})});Ay.displayName=ti;var Da="SelectItemText",Ey=d.forwardRef((t,e)=>{const{__scopeSelect:r,className:a,style:n,...i}=t,o=gr(Da,r),l=xr(Da,r),c=Py(Da,r),h=Q2(Da,r),[u,p]=d.useState(null),f=ot(e,S=>p(S),c.onItemTextChange,S=>{var v;return(v=l.itemTextRefCallback)==null?void 0:v.call(l,S,c.value,c.disabled)}),g=u==null?void 0:u.textContent,j=d.useMemo(()=>s.jsx("option",{value:c.value,disabled:c.disabled,children:g},c.value),[c.disabled,c.value,g]),{onNativeOptionAdd:x,onNativeOptionRemove:m}=h;return ts(()=>(x(j),()=>m(j)),[x,m,j]),s.jsxs(s.Fragment,{children:[s.jsx(Ae.span,{id:c.textId,...i,ref:f}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?li.createPortal(i.children,o.valueNode):null]})});Ey.displayName=Da;var Iy="SelectItemIndicator",Ry=d.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t;return Py(Iy,r).isSelected?s.jsx(Ae.span,{"aria-hidden":!0,...a,ref:e}):null});Ry.displayName=Iy;var No="SelectScrollUpButton",My=d.forwardRef((t,e)=>{const r=xr(No,t.__scopeSelect),a=hl(No,t.__scopeSelect),[n,i]=d.useState(!1),o=ot(e,a.onScrollButtonChange);return ts(()=>{if(r.viewport&&r.isPositioned){let l=function(){const h=c.scrollTop>0;i(h)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),n?s.jsx(Dy,{...t,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});My.displayName=No;var So="SelectScrollDownButton",Oy=d.forwardRef((t,e)=>{const r=xr(So,t.__scopeSelect),a=hl(So,t.__scopeSelect),[n,i]=d.useState(!1),o=ot(e,a.onScrollButtonChange);return ts(()=>{if(r.viewport&&r.isPositioned){let l=function(){const h=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<h;i(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),n?s.jsx(Dy,{...t,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});Oy.displayName=So;var Dy=d.forwardRef((t,e)=>{const{__scopeSelect:r,onAutoScroll:a,...n}=t,i=xr("SelectScrollButton",r),o=d.useRef(null),l=ki(r),c=d.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return d.useEffect(()=>()=>c(),[c]),ts(()=>{var u;const h=l().find(p=>p.ref.current===document.activeElement);(u=h==null?void 0:h.ref.current)==null||u.scrollIntoView({block:"nearest"})},[l]),s.jsx(Ae.div,{"aria-hidden":!0,...n,ref:e,style:{flexShrink:0,...n.style},onPointerDown:xe(n.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(a,50))}),onPointerMove:xe(n.onPointerMove,()=>{var h;(h=i.onItemLeave)==null||h.call(i),o.current===null&&(o.current=window.setInterval(a,50))}),onPointerLeave:xe(n.onPointerLeave,()=>{c()})})}),aS="SelectSeparator",Fy=d.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t;return s.jsx(Ae.div,{"aria-hidden":!0,...a,ref:e})});Fy.displayName=aS;var ko="SelectArrow",nS=d.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t,n=Ci(r),i=gr(ko,r),o=xr(ko,r);return i.open&&o.position==="popper"?s.jsx(gm,{...n,...a,ref:e}):null});nS.displayName=ko;function Ly(t){return t===""||t===void 0}var Vy=d.forwardRef((t,e)=>{const{value:r,...a}=t,n=d.useRef(null),i=ot(e,n),o=my(r);return d.useEffect(()=>{const l=n.current,c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==r&&u){const p=new Event("change",{bubbles:!0});u.call(l,r),l.dispatchEvent(p)}},[o,r]),s.jsx(mn,{asChild:!0,children:s.jsx("select",{...a,ref:i,defaultValue:r})})});Vy.displayName="BubbleSelect";function zy(t){const e=Jt(t),r=d.useRef(""),a=d.useRef(0),n=d.useCallback(o=>{const l=r.current+o;e(l),function c(h){r.current=h,window.clearTimeout(a.current),h!==""&&(a.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),i=d.useCallback(()=>{r.current="",window.clearTimeout(a.current)},[]);return d.useEffect(()=>()=>window.clearTimeout(a.current),[]),[r,n,i]}function $y(t,e,r){const n=e.length>1&&Array.from(e).every(h=>h===e[0])?e[0]:e,i=r?t.indexOf(r):-1;let o=iS(t,Math.max(i,0));n.length===1&&(o=o.filter(h=>h!==r));const c=o.find(h=>h.textValue.toLowerCase().startsWith(n.toLowerCase()));return c!==r?c:void 0}function iS(t,e){return t.map((r,a)=>t[(e+a)%t.length])}var oS=fy,qy=gy,lS=yy,cS=vy,dS=by,Uy=wy,uS=ky,By=Ty,Ky=Ay,hS=Ey,mS=Ry,Qy=My,Hy=Oy,Zy=Fy;const Co=oS,_o=lS,si=d.forwardRef(({className:t,children:e,...r},a)=>s.jsxs(qy,{ref:a,className:se("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[e,s.jsx(cS,{asChild:!0,children:s.jsx(_f,{className:"h-4 w-4 opacity-50"})})]}));si.displayName=qy.displayName;const Wy=d.forwardRef(({className:t,...e},r)=>s.jsx(Qy,{ref:r,className:se("flex cursor-default items-center justify-center py-1",t),...e,children:s.jsx(Nb,{className:"h-4 w-4"})}));Wy.displayName=Qy.displayName;const Gy=d.forwardRef(({className:t,...e},r)=>s.jsx(Hy,{ref:r,className:se("flex cursor-default items-center justify-center py-1",t),...e,children:s.jsx(_f,{className:"h-4 w-4"})}));Gy.displayName=Hy.displayName;const ri=d.forwardRef(({className:t,children:e,position:r="popper",...a},n)=>s.jsx(dS,{children:s.jsxs(Uy,{ref:n,className:se("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...a,children:[s.jsx(Wy,{}),s.jsx(uS,{className:se("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),s.jsx(Gy,{})]})}));ri.displayName=Uy.displayName;const fS=d.forwardRef(({className:t,...e},r)=>s.jsx(By,{ref:r,className:se("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));fS.displayName=By.displayName;const Vs=d.forwardRef(({className:t,children:e,...r},a)=>s.jsxs(Ky,{ref:a,className:se("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(mS,{children:s.jsx(Gs,{className:"h-4 w-4"})})}),s.jsx(hS,{children:e})]}));Vs.displayName=Ky.displayName;const pS=d.forwardRef(({className:t,...e},r)=>s.jsx(Zy,{ref:r,className:se("-mx-1 my-1 h-px bg-muted",t),...e}));pS.displayName=Zy.displayName;var gS=Object.defineProperty,xS=Object.defineProperties,yS=Object.getOwnPropertyDescriptors,ai=Object.getOwnPropertySymbols,Xy=Object.prototype.hasOwnProperty,Jy=Object.prototype.propertyIsEnumerable,fc=(t,e,r)=>e in t?gS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vS=(t,e)=>{for(var r in e||(e={}))Xy.call(e,r)&&fc(t,r,e[r]);if(ai)for(var r of ai(e))Jy.call(e,r)&&fc(t,r,e[r]);return t},bS=(t,e)=>xS(t,yS(e)),wS=(t,e)=>{var r={};for(var a in t)Xy.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&ai)for(var a of ai(t))e.indexOf(a)<0&&Jy.call(t,a)&&(r[a]=t[a]);return r};function jS(t){let e=setTimeout(t,0),r=setTimeout(t,10),a=setTimeout(t,50);return[e,r,a]}function NS(t){let e=d.useRef();return d.useEffect(()=>{e.current=t}),e.current}var SS=18,Yy=40,kS=`${Yy}px`,CS=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function _S({containerRef:t,inputRef:e,pushPasswordManagerStrategy:r,isFocused:a}){let[n,i]=d.useState(!1),[o,l]=d.useState(!1),[c,h]=d.useState(!1),u=d.useMemo(()=>r==="none"?!1:(r==="increase-width"||r==="experimental-no-flickering")&&n&&o,[n,o,r]),p=d.useCallback(()=>{let f=t.current,g=e.current;if(!f||!g||c||r==="none")return;let j=f,x=j.getBoundingClientRect().left+j.offsetWidth,m=j.getBoundingClientRect().top+j.offsetHeight/2,S=x-SS,v=m;document.querySelectorAll(CS).length===0&&document.elementFromPoint(S,v)===f||(i(!0),h(!0))},[t,e,c,r]);return d.useEffect(()=>{let f=t.current;if(!f||r==="none")return;function g(){let x=window.innerWidth-f.getBoundingClientRect().right;l(x>=Yy)}g();let j=setInterval(g,1e3);return()=>{clearInterval(j)}},[t,r]),d.useEffect(()=>{let f=a||document.activeElement===e.current;if(r==="none"||!f)return;let g=setTimeout(p,0),j=setTimeout(p,2e3),x=setTimeout(p,5e3),m=setTimeout(()=>{h(!0)},6e3);return()=>{clearTimeout(g),clearTimeout(j),clearTimeout(x),clearTimeout(m)}},[e,a,r,p]),{hasPWMBadge:n,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:kS}}var ev=d.createContext({}),tv=d.forwardRef((t,e)=>{var r=t,{value:a,onChange:n,maxLength:i,textAlign:o="left",pattern:l,placeholder:c,inputMode:h="numeric",onComplete:u,pushPasswordManagerStrategy:p="increase-width",pasteTransformer:f,containerClassName:g,noScriptCSSFallback:j=TS,render:x,children:m}=r,S=wS(r,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),v,y,C,k,D;let[Q,H]=d.useState(typeof S.defaultValue=="string"?S.defaultValue:""),M=a??Q,L=NS(M),$=d.useCallback(ie=>{n==null||n(ie),H(ie)},[n]),w=d.useMemo(()=>l?typeof l=="string"?new RegExp(l):l:null,[l]),A=d.useRef(null),I=d.useRef(null),K=d.useRef({value:M,onChange:$,isIOS:typeof window<"u"&&((y=(v=window==null?void 0:window.CSS)==null?void 0:v.supports)==null?void 0:y.call(v,"-webkit-touch-callout","none"))}),E=d.useRef({prev:[(C=A.current)==null?void 0:C.selectionStart,(k=A.current)==null?void 0:k.selectionEnd,(D=A.current)==null?void 0:D.selectionDirection]});d.useImperativeHandle(e,()=>A.current,[]),d.useEffect(()=>{let ie=A.current,pe=I.current;if(!ie||!pe)return;K.current.value!==ie.value&&K.current.onChange(ie.value),E.current.prev=[ie.selectionStart,ie.selectionEnd,ie.selectionDirection];function We(){if(document.activeElement!==ie){Ke(null),ut(null);return}let Be=ie.selectionStart,Ct=ie.selectionEnd,Rs=ie.selectionDirection,b=ie.maxLength,P=ie.value,R=E.current.prev,Z=-1,B=-1,V;if(P.length!==0&&Be!==null&&Ct!==null){let O=Be===Ct,he=Be===P.length&&P.length<b;if(O&&!he){let Ee=Be;if(Ee===0)Z=0,B=1,V="forward";else if(Ee===b)Z=Ee-1,B=Ee,V="backward";else if(b>1&&P.length>1){let Wt=0;if(R[0]!==null&&R[1]!==null){V=Ee<R[1]?"backward":"forward";let $t=R[0]===R[1]&&R[0]<b;V==="backward"&&!$t&&(Wt=-1)}Z=Wt+Ee,B=Wt+Ee+1}}Z!==-1&&B!==-1&&Z!==B&&A.current.setSelectionRange(Z,B,V)}let ee=Z!==-1?Z:Be,_e=B!==-1?B:Ct,He=V??Rs;Ke(ee),ut(_e),E.current.prev=[ee,_e,He]}if(document.addEventListener("selectionchange",We,{capture:!0}),We(),document.activeElement===ie&&ge(!0),!document.getElementById("input-otp-style")){let Be=document.createElement("style");if(Be.id="input-otp-style",document.head.appendChild(Be),Be.sheet){let Ct="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";Ia(Be.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),Ia(Be.sheet,`[data-input-otp]:autofill { ${Ct} }`),Ia(Be.sheet,`[data-input-otp]:-webkit-autofill { ${Ct} }`),Ia(Be.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),Ia(Be.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let st=()=>{pe&&pe.style.setProperty("--root-height",`${ie.clientHeight}px`)};st();let kt=new ResizeObserver(st);return kt.observe(ie),()=>{document.removeEventListener("selectionchange",We,{capture:!0}),kt.disconnect()}},[]);let[U,te]=d.useState(!1),[q,ge]=d.useState(!1),[Me,Ke]=d.useState(null),[Qe,ut]=d.useState(null);d.useEffect(()=>{jS(()=>{var ie,pe,We,st;(ie=A.current)==null||ie.dispatchEvent(new Event("input"));let kt=(pe=A.current)==null?void 0:pe.selectionStart,Be=(We=A.current)==null?void 0:We.selectionEnd,Ct=(st=A.current)==null?void 0:st.selectionDirection;kt!==null&&Be!==null&&(Ke(kt),ut(Be),E.current.prev=[kt,Be,Ct])})},[M,q]),d.useEffect(()=>{L!==void 0&&M!==L&&L.length<i&&M.length===i&&(u==null||u(M))},[i,u,L,M]);let St=_S({containerRef:I,inputRef:A,pushPasswordManagerStrategy:p,isFocused:q}),ss=d.useCallback(ie=>{let pe=ie.currentTarget.value.slice(0,i);if(pe.length>0&&w&&!w.test(pe)){ie.preventDefault();return}typeof L=="string"&&pe.length<L.length&&document.dispatchEvent(new Event("selectionchange")),$(pe)},[i,$,L,w]),ue=d.useCallback(()=>{var ie;if(A.current){let pe=Math.min(A.current.value.length,i-1),We=A.current.value.length;(ie=A.current)==null||ie.setSelectionRange(pe,We),Ke(pe),ut(We)}ge(!0)},[i]),ze=d.useCallback(ie=>{var pe,We;let st=A.current;if(!f&&(!K.current.isIOS||!ie.clipboardData||!st))return;let kt=ie.clipboardData.getData("text/plain"),Be=f?f(kt):kt;ie.preventDefault();let Ct=(pe=A.current)==null?void 0:pe.selectionStart,Rs=(We=A.current)==null?void 0:We.selectionEnd,b=(Ct!==Rs?M.slice(0,Ct)+Be+M.slice(Rs):M.slice(0,Ct)+Be+M.slice(Ct)).slice(0,i);if(b.length>0&&w&&!w.test(b))return;st.value=b,$(b);let P=Math.min(b.length,i-1),R=b.length;st.setSelectionRange(P,R),Ke(P),ut(R)},[i,$,w,M]),Ge=d.useMemo(()=>({position:"relative",cursor:S.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[S.disabled]),$e=d.useMemo(()=>({position:"absolute",inset:0,width:St.willPushPWMBadge?`calc(100% + ${St.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:St.willPushPWMBadge?`inset(0 ${St.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:o,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[St.PWM_BADGE_SPACE_WIDTH,St.willPushPWMBadge,o]),Ve=d.useMemo(()=>d.createElement("input",bS(vS({autoComplete:S.autoComplete||"one-time-code"},S),{"data-input-otp":!0,"data-input-otp-placeholder-shown":M.length===0||void 0,"data-input-otp-mss":Me,"data-input-otp-mse":Qe,inputMode:h,pattern:w==null?void 0:w.source,"aria-placeholder":c,style:$e,maxLength:i,value:M,ref:A,onPaste:ie=>{var pe;ze(ie),(pe=S.onPaste)==null||pe.call(S,ie)},onChange:ss,onMouseOver:ie=>{var pe;te(!0),(pe=S.onMouseOver)==null||pe.call(S,ie)},onMouseLeave:ie=>{var pe;te(!1),(pe=S.onMouseLeave)==null||pe.call(S,ie)},onFocus:ie=>{var pe;ue(),(pe=S.onFocus)==null||pe.call(S,ie)},onBlur:ie=>{var pe;ge(!1),(pe=S.onBlur)==null||pe.call(S,ie)}})),[ss,ue,ze,h,$e,i,Qe,Me,S,w==null?void 0:w.source,M]),Oe=d.useMemo(()=>({slots:Array.from({length:i}).map((ie,pe)=>{var We;let st=q&&Me!==null&&Qe!==null&&(Me===Qe&&pe===Me||pe>=Me&&pe<Qe),kt=M[pe]!==void 0?M[pe]:null,Be=M[0]!==void 0?null:(We=c==null?void 0:c[pe])!=null?We:null;return{char:kt,placeholderChar:Be,isActive:st,hasFakeCaret:st&&kt===null}}),isFocused:q,isHovering:!S.disabled&&U}),[q,U,i,Qe,Me,S.disabled,M]),Zt=d.useMemo(()=>x?x(Oe):d.createElement(ev.Provider,{value:Oe},m),[m,Oe,x]);return d.createElement(d.Fragment,null,j!==null&&d.createElement("noscript",null,d.createElement("style",null,j)),d.createElement("div",{ref:I,"data-input-otp-container":!0,style:Ge,className:g},Zt,d.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Ve)))});tv.displayName="Input";function Ia(t,e){try{t.insertRule(e)}catch{console.error("input-otp could not insert CSS rule:",e)}}var TS=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const sv=d.forwardRef(({className:t,containerClassName:e,...r},a)=>s.jsx(tv,{ref:a,containerClassName:se("flex items-center gap-2 has-[:disabled]:opacity-50",e),className:se("disabled:cursor-not-allowed",t),...r}));sv.displayName="InputOTP";const rv=d.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:se("flex items-center",t),...e}));rv.displayName="InputOTPGroup";const vr=d.forwardRef(({index:t,className:e,...r},a)=>{const n=d.useContext(ev),{char:i,hasFakeCaret:o,isActive:l}=n.slots[t];return s.jsxs("div",{ref:a,className:se("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",l&&"z-10 ring-2 ring-ring ring-offset-background",e),...r,children:[i,o&&s.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});vr.displayName="InputOTPSlot";const PS=d.forwardRef(({...t},e)=>s.jsx("div",{ref:e,role:"separator",...t,children:s.jsx(_b,{})}));PS.displayName="InputOTPSeparator";const AS=[{code:"+213",name:"Algeria",flag:"🇩🇿"},{code:"+966",name:"Saudi Arabia",flag:"🇸🇦"},{code:"+971",name:"UAE",flag:"🇦🇪"},{code:"+20",name:"Egypt",flag:"🇪🇬"},{code:"+212",name:"Morocco",flag:"🇲🇦"},{code:"+1",name:"USA",flag:"🇺🇸"},{code:"+44",name:"UK",flag:"🇬🇧"}];function ES(){const[t,e]=d.useState("phone"),[r,a]=d.useState("+213"),[n,i]=d.useState(""),[o,l]=d.useState(""),[c,h]=d.useState(""),[u,p]=d.useState(""),[f,g]=d.useState(""),[j,x]=d.useState(!1),[m,S]=d.useState(""),[v,y]=d.useState(""),[C,k]=d.useState(!1),[D,Q]=d.useState(!1),{toast:H}=lt(),{login:M}=rp(),L=["تندوف","الجزائر","وهران","قسنطينة","عنابة","سطيف","باتنة","تيزي وزو","بجاية","مستغانم"];d.useEffect(()=>{C&&(e("profile"),k(!1))},[C]);const $=async()=>{if(!n.trim()){H({title:"خطأ",description:"يرجى إدخال رقم الهاتف",variant:"destructive"});return}x(!0);const I=r+n;l(I);try{const K=await ce("/api/auth/send-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:I})});if(K.showDirectly&&K.code)S(K.code),y(K.code),H({title:"رمز التحقق",description:K.message,duration:1e4});else{try{const E=await fetch("/api/dev/last-otp").then(U=>U.json()).catch(()=>null);E!=null&&E.code&&(S(E.code),y(E.code))}catch{}H({title:"تم الإرسال",description:K.message||"تم إرسال رمز التحقق إلى هاتفك"})}e("otp")}catch(K){H({title:"خطأ",description:K.message||"فشل في إرسال رمز التحقق",variant:"destructive"})}finally{x(!1)}},w=async()=>{var I;if(c.length!==6){H({title:"خطأ",description:"يرجى إدخال رمز التحقق المكون من 6 أرقام",variant:"destructive"});return}x(!0);try{const K=await ce("/api/auth/verify-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:o,code:c})});K.user&&K.token&&(M(K.user,K.token),H({title:"مرحباً!",description:"تم تسجيل الدخول بنجاح"}))}catch(K){(I=K.message)!=null&&I.includes("Name and location are required")?(Q(!0),H({title:"مستخدم جديد",description:"يرجى إكمال بياناتك الشخصية"}),k(!0)):H({title:"خطأ",description:K.message||"رمز التحقق غير صحيح",variant:"destructive"})}finally{x(!1)}},A=async()=>{if(!u.trim()||!f){H({title:"خطأ",description:"يرجى إكمال جميع البيانات",variant:"destructive"});return}if(!D){H({title:"خطأ",description:"يجب التحقق من رمز OTP أولاً",variant:"destructive"});return}x(!0);try{const I=await ce("/api/auth/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:o,name:u.trim(),location:f})});M(I.user,I.token),H({title:"مرحباً!",description:"تم إنشاء حسابك بنجاح"})}catch(I){H({title:"خطأ",description:I.message||"فشل في إنشاء الحساب",variant:"destructive"})}finally{x(!1)}};return t==="phone"?s.jsx("div",{className:"min-h-screen bg-[#075e54] flex items-center justify-center p-4",dir:"rtl",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"BizChat"}),s.jsx("p",{className:"text-green-100 text-sm",children:"منصة التواصل التجاري الذكية - سنرسل لك رمز تحقق للتأكد من رقم هاتفك"})]}),s.jsxs(oe,{className:"border-0 shadow-lg","data-testid":"card-phone-verification",children:[s.jsxs(xt,{className:"text-center pb-4",children:[s.jsx(Nt,{className:"text-lg font-semibold",children:"تسجيل الدخول"}),s.jsx(lr,{children:"أدخل رقم هاتفك للمتابعة"})]}),s.jsxs(le,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"country",children:"البلد"}),s.jsxs(Co,{value:r,onValueChange:a,children:[s.jsx(si,{"data-testid":"select-country",children:s.jsx(_o,{})}),s.jsx(ri,{children:AS.map(I=>s.jsx(Vs,{value:I.code,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{children:I.flag}),s.jsx("span",{children:I.name}),s.jsx("span",{className:"text-muted-foreground",children:I.code})]})},I.code))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"phone",children:"رقم الهاتف"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"flex items-center px-3 py-2 border border-input rounded-md bg-background text-sm font-medium",children:r}),s.jsx(Ce,{id:"phone",type:"tel",value:n,onChange:I=>i(I.target.value.replace(/\D/g,"")),placeholder:"555123456",className:"flex-1","data-testid":"input-phone-number"})]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"سيتم إرسال رمز تحقق عبر الرسائل النصية إلى هذا الرقم"})]}),s.jsx(T,{onClick:$,className:"w-full bg-[#25d366] hover:bg-[#22c55e] text-white",disabled:j,"data-testid":"button-send-otp",children:j?"جارِ الإرسال...":"إرسال رمز التحقق"}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground justify-center mt-6",children:[s.jsx(Ka,{className:"w-4 h-4"}),s.jsx("span",{children:"محمي بتشفير تام"})]})]})]})]})}):t==="otp"?s.jsx("div",{className:"min-h-screen bg-[#075e54] flex items-center justify-center p-4",dir:"rtl",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-white rounded-full mb-4",children:s.jsx(Cs,{className:"w-10 h-10 text-[#075e54]"})}),s.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"تحقق من رقم هاتفك"}),s.jsxs("p",{className:"text-green-100 text-sm",children:["أدخل الرمز المرسل إلى ",o]})]}),s.jsxs(oe,{className:"border-0 shadow-lg","data-testid":"card-otp-verification",children:[s.jsxs(xt,{className:"text-center pb-4",children:[s.jsx(Nt,{className:"text-lg font-semibold",children:"رمز التحقق"}),s.jsx(lr,{children:"أدخل الرمز المكون من 6 أرقام"})]}),s.jsxs(le,{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx(sv,{value:c,onChange:h,maxLength:6,"data-testid":"input-otp",children:s.jsxs(rv,{children:[s.jsx(vr,{index:0}),s.jsx(vr,{index:1}),s.jsx(vr,{index:2}),s.jsx(vr,{index:3}),s.jsx(vr,{index:4}),s.jsx(vr,{index:5})]})})}),!1,s.jsx(T,{onClick:w,className:"w-full bg-[#25d366] hover:bg-[#22c55e] text-white",disabled:j||c.length!==6,"data-testid":"button-verify-otp",children:j?"جارِ التحقق...":"تحقق من الرمز"}),s.jsx("div",{className:"text-center",children:s.jsx(T,{variant:"ghost",onClick:()=>e("phone"),className:"text-sm text-muted-foreground hover:text-foreground","data-testid":"button-back-to-phone",children:"تغيير رقم الهاتف"})})]})]})]})}):t==="profile"?s.jsx("div",{className:"min-h-screen bg-[#075e54] flex items-center justify-center p-4",dir:"rtl",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-white rounded-full mb-4",children:s.jsx(pr,{className:"w-10 h-10 text-[#075e54]"})}),s.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"إعداد الملف الشخصي"}),s.jsx("p",{className:"text-green-100 text-sm",children:"أكمل بياناتك لإنشاء حسابك"})]}),s.jsxs(oe,{className:"border-0 shadow-lg","data-testid":"card-profile-setup",children:[s.jsxs(xt,{className:"text-center pb-4",children:[s.jsx(Nt,{className:"text-lg font-semibold",children:"بياناتك الشخصية"}),s.jsx(lr,{children:"هذه البيانات ستظهر للآخرين"})]}),s.jsxs(le,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"name",children:"الاسم"}),s.jsx(Ce,{id:"name",value:u,onChange:I=>p(I.target.value),placeholder:"أدخل اسمك الكامل","data-testid":"input-name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"location",children:"المنطقة"}),s.jsxs(Co,{value:f,onValueChange:g,children:[s.jsx(si,{"data-testid":"select-location",children:s.jsx(_o,{placeholder:"اختر منطقتك"})}),s.jsx(ri,{children:L.map(I=>s.jsx(Vs,{value:I,children:I},I))})]})]}),s.jsx(T,{onClick:A,className:"w-full bg-[#25d366] hover:bg-[#22c55e] text-white",disabled:j||!u.trim()||!f,"data-testid":"button-complete-profile",children:j?"جارِ الإنشاء...":"إنشاء الحساب"})]})]})]})}):null}function IS(){return s.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:s.jsx(oe,{className:"w-full max-w-md mx-4",children:s.jsxs(le,{className:"pt-6",children:[s.jsxs("div",{className:"flex mb-4 gap-2",children:[s.jsx(Rn,{className:"h-8 w-8 text-red-500"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),s.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const RS=Re.object({customerName:Re.string().min(1,"الاسم مطلوب"),customerPhone:Re.string().min(1,"رقم الهاتف مطلوب"),deliveryAddress:Re.string().min(1,"عنوان التسليم مطلوب"),notes:Re.string().optional()});function MS(){const[t,e]=d.useState(!1),[r,a]=d.useState(null),[,n]=ys(),{toast:i}=lt(),{data:o}=ye({queryKey:["/api/user/current"]}),{data:l=[],isLoading:c}=ye({queryKey:["/api/cart"]}),h=Ha({resolver:Za(RS),defaultValues:{customerName:(o==null?void 0:o.name)||"",customerPhone:(o==null?void 0:o.phoneNumber)||"",deliveryAddress:"",notes:""}}),u=Se({mutationFn:async({productId:v,quantity:y})=>ce(`/api/cart/${v}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:y})}),onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/cart"]})},onError:()=>{i({title:"خطأ",description:"فشل في تحديث الكمية",variant:"destructive"})}}),p=Se({mutationFn:async v=>ce(`/api/cart/${v}`,{method:"DELETE"}),onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/cart"]}),i({title:"تم الحذف",description:"تم حذف المنتج من السلة"})},onError:()=>{i({title:"خطأ",description:"فشل في حذف المنتج",variant:"destructive"})}}),f=Se({mutationFn:async({sellerItems:v,formData:y})=>{const C=v.reduce((k,D)=>k+parseFloat(D.product.price)*parseInt(D.quantity),0);return ce("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:{sellerId:v[0].product.owner.id,storeId:null,totalAmount:C.toString(),paymentMethod:"cash_on_delivery",deliveryAddress:y.deliveryAddress,customerPhone:y.customerPhone,customerName:y.customerName,notes:y.notes||null},items:v.map(k=>({productId:k.productId,productName:k.product.name,productPrice:k.product.price,quantity:k.quantity,subtotal:(parseFloat(k.product.price)*parseInt(k.quantity)).toString()}))})})},onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/cart"]}),ft.invalidateQueries({queryKey:["/api/orders/user"]}),i({title:"تم إنشاء الطلب",description:"تم إنشاء طلبك بنجاح! سيتواصل معك البائع قريباً"}),e(!1),h.reset(),n("/orders")},onError:()=>{i({title:"خطأ",description:"فشل في إنشاء الطلب",variant:"destructive"})}}),g=(v,y)=>{y<1||u.mutate({productId:v,quantity:y.toString()})},j=v=>{p.mutate(v)},x=l.reduce((v,y)=>{const C=y.product.owner.id;return v[C]||(v[C]=[]),v[C].push(y),v},{}),m=v=>{a(v),e(!0)},S=v=>{if(!r)return;const y=x[r];f.mutate({sellerItems:y,formData:v})};return c?s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4",children:s.jsx("div",{className:"text-center",children:"جاري التحميل..."})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20",children:[s.jsx("div",{className:"bg-whatsapp-green text-white p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(jt,{href:"/stores",children:s.jsx(T,{variant:"ghost",size:"icon",className:"text-white hover:bg-green-600 w-12 h-12 rounded-full","data-testid":"button-back",children:s.jsx(Sa,{className:"w-6 h-6"})})}),s.jsx("h1",{className:"text-2xl font-bold",children:"السلة"})]}),s.jsxs(Te,{variant:"secondary",className:"bg-white text-whatsapp-green",children:[l.length," عنصر"]})]})}),s.jsx("div",{className:"p-4",children:l.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Dr,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"السلة فارغة"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"ابدأ بإضافة المنتجات إلى سلتك"}),s.jsx(jt,{href:"/stores",children:s.jsx(T,{className:"bg-whatsapp-green hover:bg-green-600",children:"تصفح المتاجر"})})]}):s.jsx("div",{className:"space-y-6",children:Object.entries(x).map(([v,y])=>{const C=y[0].product.owner,k=y.reduce((D,Q)=>D+parseFloat(Q.product.price)*parseInt(Q.quantity),0);return s.jsxs(oe,{className:"overflow-hidden","data-testid":`seller-cart-${v}`,children:[s.jsx(xt,{className:"bg-gray-50 dark:bg-gray-800",children:s.jsxs(Nt,{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(_s,{className:"w-5 h-5"}),s.jsx("span",{children:C.name})]}),s.jsxs(Te,{variant:"outline",children:[y.length," منتج"]})]})}),s.jsxs(le,{className:"p-0",children:[y.map(D=>s.jsx("div",{className:"border-b last:border-b-0 p-4","data-testid":`cart-item-${D.id}`,children:s.jsxs("div",{className:"flex gap-4",children:[D.product.imageUrl&&s.jsx("img",{src:D.product.imageUrl,alt:D.product.name,className:"w-20 h-20 object-cover rounded-lg"}),!D.product.imageUrl&&s.jsx("div",{className:"w-20 h-20 bg-gray-200 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:s.jsx(Dt,{className:"w-8 h-8 text-gray-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-lg mb-1",children:D.product.name}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2",children:D.product.description}),s.jsx(Te,{variant:"outline",className:"text-xs mb-2",children:D.product.category}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(T,{size:"sm",variant:"outline",onClick:()=>g(D.productId,parseInt(D.quantity)-1),disabled:parseInt(D.quantity)<=1||u.isPending,"data-testid":`button-decrease-${D.id}`,children:s.jsx(Ib,{className:"w-3 h-3"})}),s.jsx("span",{className:"w-8 text-center font-medium",children:D.quantity}),s.jsx(T,{size:"sm",variant:"outline",onClick:()=>g(D.productId,parseInt(D.quantity)+1),disabled:u.isPending,"data-testid":`button-increase-${D.id}`,children:s.jsx(Bs,{className:"w-3 h-3"})})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("span",{className:"text-lg font-bold text-whatsapp-green",children:[(parseFloat(D.product.price)*parseInt(D.quantity)).toLocaleString()," دج"]}),s.jsx(T,{size:"sm",variant:"destructive",onClick:()=>j(D.productId),disabled:p.isPending,"data-testid":`button-remove-${D.id}`,children:s.jsx(Bo,{className:"w-3 h-3"})})]})]})]})]})},D.id)),s.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("span",{className:"text-lg font-semibold",children:"المجموع الفرعي:"}),s.jsxs("span",{className:"text-xl font-bold text-whatsapp-green",children:[k.toLocaleString()," دج"]})]}),s.jsxs(T,{className:"w-full bg-whatsapp-green hover:bg-green-600",onClick:()=>m(v),disabled:f.isPending,"data-testid":`button-checkout-${v}`,children:[s.jsx(Cb,{className:"w-4 h-4 ml-2"}),"طلب من ",C.name," - دفع عند الاستلام"]})]})]})]},v)})})}),s.jsx(Yt,{open:t,onOpenChange:e,children:s.jsxs(Kt,{className:"max-w-md","data-testid":"checkout-modal",children:[s.jsx(Qt,{children:s.jsx(Ht,{children:"إتمام الطلب - دفع عند الاستلام"})}),s.jsxs("form",{onSubmit:h.handleSubmit(S),className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"customerName",children:"الاسم الكامل *"}),s.jsx(Ce,{id:"customerName",...h.register("customerName"),placeholder:"أدخل اسمك الكامل","data-testid":"input-customer-name"}),h.formState.errors.customerName&&s.jsx("p",{className:"text-sm text-red-500",children:h.formState.errors.customerName.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"customerPhone",children:"رقم الهاتف *"}),s.jsx(Ce,{id:"customerPhone",...h.register("customerPhone"),placeholder:"+213555123456","data-testid":"input-customer-phone"}),h.formState.errors.customerPhone&&s.jsx("p",{className:"text-sm text-red-500",children:h.formState.errors.customerPhone.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"deliveryAddress",children:"عنوان التسليم *"}),s.jsx(qs,{id:"deliveryAddress",...h.register("deliveryAddress"),placeholder:"أدخل العنوان الكامل للتسليم","data-testid":"input-delivery-address"}),h.formState.errors.deliveryAddress&&s.jsx("p",{className:"text-sm text-red-500",children:h.formState.errors.deliveryAddress.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Pe,{htmlFor:"notes",children:"ملاحظات إضافية"}),s.jsx(qs,{id:"notes",...h.register("notes"),placeholder:"أي ملاحظات أو تعليمات خاصة...","data-testid":"input-notes"})]}),r&&s.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-green-800 dark:text-green-200 mb-2",children:[s.jsx(gt,{className:"w-4 h-4"}),s.jsx("span",{className:"font-semibold",children:"طريقة الدفع: نقداً عند الاستلام"})]}),s.jsx("p",{className:"text-sm text-green-600 dark:text-green-300",children:"ستدفع المبلغ نقداً عند استلام الطلب"})]}),s.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[s.jsx(T,{type:"button",variant:"outline",onClick:()=>e(!1),"data-testid":"button-cancel-checkout",children:"إلغاء"}),s.jsx(T,{type:"submit",disabled:f.isPending,className:"bg-whatsapp-green hover:bg-green-600","data-testid":"button-submit-order",children:f.isPending?"جاري الإرسال...":"تأكيد الطلب"})]})]})]})})]})}function OS(){const[t,e]=d.useState("user"),{toast:r}=lt();ye({queryKey:["/api/user/current"]});const{data:a=[],isLoading:n}=ye({queryKey:["/api/orders/user"],enabled:t==="user"}),{data:i=[],isLoading:o}=ye({queryKey:["/api/orders/seller"],enabled:t==="seller"}),l=Se({mutationFn:async({orderId:f,status:g})=>ce(`/api/orders/${f}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:g})}),onSuccess:()=>{ft.invalidateQueries({queryKey:["/api/orders/seller"]}),r({title:"تم التحديث",description:"تم تحديث حالة الطلب بنجاح"})},onError:()=>{r({title:"خطأ",description:"فشل في تحديث حالة الطلب",variant:"destructive"})}}),c=f=>{switch(f){case"pending":return{label:"في الانتظار",color:"bg-yellow-500",icon:is,description:"الطلب في انتظار موافقة البائع"};case"confirmed":return{label:"مؤكد",color:"bg-blue-500",icon:gt,description:"تم تأكيد الطلب من البائع"};case"prepared":return{label:"جاهز",color:"bg-purple-500",icon:Dt,description:"الطلب جاهز للتسليم"};case"delivered":return{label:"تم التسليم",color:"bg-green-500",icon:gt,description:"تم تسليم الطلب بنجاح"};case"cancelled":return{label:"ملغى",color:"bg-red-500",icon:$s,description:"تم إلغاء الطلب"};default:return{label:f,color:"bg-gray-500",icon:Rn,description:""}}},h=f=>f?(typeof f=="string"?new Date(f):f).toLocaleDateString("ar",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"غير محدد",u=(f,g)=>{l.mutate({orderId:f,status:g})},p=(f,g=!1)=>{const j=c(f.status),x=j.icon;return s.jsxs(oe,{className:"overflow-hidden","data-testid":`order-card-${f.id}`,children:[s.jsx(xt,{className:"pb-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(Nt,{className:"text-lg mb-2",children:["طلب #",f.id.slice(0,8)]}),s.jsx("div",{className:"flex items-center gap-2 mb-2",children:g?s.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[s.jsx(_s,{className:"w-4 h-4"}),s.jsx("span",{children:f.customerName})]}):s.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[s.jsx(_s,{className:"w-4 h-4"}),s.jsxs("span",{children:["البائع: ",f.seller.name]})]})}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[s.jsx(mi,{className:"w-4 h-4"}),s.jsx("span",{children:h(f.orderDate)})]})]}),s.jsxs("div",{className:"text-left",children:[s.jsxs(Te,{className:`${j.color} text-white mb-2`,children:[s.jsx(x,{className:"w-3 h-3 ml-1"}),j.label]}),s.jsxs("div",{className:"text-lg font-bold text-whatsapp-green",children:[parseInt(f.totalAmount).toLocaleString()," دج"]})]})]})}),s.jsxs(le,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-semibold",children:"المنتجات:"}),f.items.map(m=>s.jsxs("div",{className:"flex gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[m.product.imageUrl&&s.jsx("img",{src:m.product.imageUrl,alt:m.productName,className:"w-12 h-12 object-cover rounded"}),!m.product.imageUrl&&s.jsx("div",{className:"w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded flex items-center justify-center",children:s.jsx(Dt,{className:"w-4 h-4 text-gray-400"})}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium",children:m.productName}),s.jsx(Te,{variant:"outline",className:"text-xs",children:m.product.category})]}),s.jsxs("div",{className:"text-left",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:[m.quantity," × ",parseInt(m.productPrice).toLocaleString()," دج"]}),s.jsxs("div",{className:"font-semibold",children:[parseInt(m.subtotal).toLocaleString()," دج"]})]})]})})]},m.id))]}),s.jsxs("div",{className:"space-y-2 p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[s.jsx("h4",{className:"font-semibold text-blue-800 dark:text-blue-200",children:"معلومات التسليم:"}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(gs,{className:"w-4 h-4 mt-0.5 text-blue-600"}),s.jsx("span",{children:f.deliveryAddress})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Es,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{children:f.customerPhone})]}),s.jsx("div",{className:"text-blue-600 dark:text-blue-300 font-medium",children:"الدفع: نقداً عند الاستلام"})]}),f.notes&&s.jsxs("div",{className:"mt-2 p-2 bg-blue-100 dark:bg-blue-900 rounded text-sm",children:[s.jsx("strong",{children:"ملاحظات:"})," ",f.notes]})]}),s.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:j.description}),f.status==="cancelled"&&f.cancellationReason&&s.jsxs("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:[s.jsx("strong",{children:"سبب الإلغاء:"})," ",f.cancellationReason]})]}),g&&f.status!=="cancelled"&&f.status!=="delivered"&&s.jsxs("div",{className:"flex gap-2 pt-3 border-t",children:[f.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsxs(T,{size:"sm",onClick:()=>u(f.id,"confirmed"),disabled:l.isPending,className:"bg-blue-500 hover:bg-blue-600","data-testid":`button-confirm-${f.id}`,children:[s.jsx(gt,{className:"w-3 h-3 ml-1"}),"تأكيد الطلب"]}),s.jsxs(T,{size:"sm",variant:"destructive",onClick:()=>u(f.id,"cancelled"),disabled:l.isPending,"data-testid":`button-cancel-${f.id}`,children:[s.jsx($s,{className:"w-3 h-3 ml-1"}),"رفض الطلب"]})]}),f.status==="confirmed"&&s.jsxs(T,{size:"sm",onClick:()=>u(f.id,"prepared"),disabled:l.isPending,className:"bg-purple-500 hover:bg-purple-600","data-testid":`button-prepare-${f.id}`,children:[s.jsx(Dt,{className:"w-3 h-3 ml-1"}),"جاهز للتسليم"]}),f.status==="prepared"&&s.jsxs(T,{size:"sm",onClick:()=>u(f.id,"delivered"),disabled:l.isPending,className:"bg-green-500 hover:bg-green-600","data-testid":`button-deliver-${f.id}`,children:[s.jsx(Mf,{className:"w-3 h-3 ml-1"}),"تم التسليم"]})]})]})]},f.id)};return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20",children:[s.jsx("div",{className:"bg-whatsapp-green text-white p-4",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(jt,{href:"/stores",children:s.jsx(T,{variant:"ghost",size:"icon",className:"text-white hover:bg-green-600 w-12 h-12 rounded-full","data-testid":"button-back",children:s.jsx(Sa,{className:"w-6 h-6"})})}),s.jsx("h1",{className:"text-2xl font-bold",children:"الطلبات"})]})})}),s.jsx("div",{className:"p-4",children:s.jsxs(hy,{value:t,onValueChange:e,className:"space-y-4",children:[s.jsxs(ul,{className:"grid w-full grid-cols-2",children:[s.jsx(Yr,{value:"user","data-testid":"tab-user-orders",children:"طلباتي"}),s.jsx(Yr,{value:"seller","data-testid":"tab-seller-orders",children:"طلبات المتجر"})]}),s.jsx(ea,{value:"user",className:"space-y-4",children:n?s.jsx("div",{className:"text-center py-8",children:"جاري التحميل..."}):a.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Dt,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"لا توجد طلبات"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"لم تقم بإنشاء أي طلبات حتى الآن"}),s.jsx(jt,{href:"/stores",children:s.jsx(T,{className:"bg-whatsapp-green hover:bg-green-600",children:"ابدأ التسوق"})})]}):s.jsx("div",{className:"space-y-4",children:a.map(f=>p(f,!1))})}),s.jsx(ea,{value:"seller",className:"space-y-4",children:o?s.jsx("div",{className:"text-center py-8",children:"جاري التحميل..."}):i.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Dt,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"لا توجد طلبات"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"لا توجد طلبات في متجرك حتى الآن"}),s.jsx(jt,{href:"/my-store",children:s.jsx(T,{className:"bg-whatsapp-green hover:bg-green-600",children:"إدارة المتجر"})})]}):s.jsx("div",{className:"space-y-4",children:i.map(f=>p(f,!0))})})]})})]})}const av=Xj,nv=d.createContext({}),Hr=({...t})=>s.jsx(nv.Provider,{value:{name:t.name},children:s.jsx(tN,{...t})}),_i=()=>{const t=d.useContext(nv),e=d.useContext(iv),{getFieldState:r,formState:a}=vi(),n=r(t.name,a);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:i}=e;return{id:i,name:t.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...n}},iv=d.createContext({}),jr=d.forwardRef(({className:t,...e},r)=>{const a=d.useId();return s.jsx(iv.Provider,{value:{id:a},children:s.jsx("div",{ref:r,className:se("space-y-2",t),...e})})});jr.displayName="FormItem";const Nr=d.forwardRef(({className:t,...e},r)=>{const{error:a,formItemId:n}=_i();return s.jsx(Pe,{ref:r,className:se(a&&"text-destructive",t),htmlFor:n,...e})});Nr.displayName="FormLabel";const Sr=d.forwardRef(({...t},e)=>{const{error:r,formItemId:a,formDescriptionId:n,formMessageId:i}=_i();return s.jsx(xm,{ref:e,id:a,"aria-describedby":r?`${n} ${i}`:`${n}`,"aria-invalid":!!r,...t})});Sr.displayName="FormControl";const DS=d.forwardRef(({className:t,...e},r)=>{const{formDescriptionId:a}=_i();return s.jsx("p",{ref:r,id:a,className:se("text-sm text-muted-foreground",t),...e})});DS.displayName="FormDescription";const kr=d.forwardRef(({className:t,children:e,...r},a)=>{const{error:n,formMessageId:i}=_i(),o=n?String((n==null?void 0:n.message)??""):e;return o?s.jsx("p",{ref:a,id:i,className:se("text-sm font-medium text-destructive",t),...r,children:o}):null});kr.displayName="FormMessage";const FS=Re.object({email:Re.string().email("يرجى إدخال بريد إلكتروني صحيح"),password:Re.string().min(6,"كلمة المرور يجب أن تكون 6 أحرف على الأقل")});function LS(){const[,t]=ys(),[e,r]=d.useState(!1),{toast:a}=lt(),n=Ha({resolver:Za(FS),defaultValues:{email:"",password:""}}),i=Se({mutationFn:l=>ce("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),onSuccess:l=>{localStorage.setItem("auth_token",l.token),a({title:"مرحباً بك في لوحة الإدارة",description:"تم تسجيل الدخول بنجاح"}),t("/admin")},onError:l=>{a({title:"خطأ في تسجيل الدخول",description:l.message||"البريد الإلكتروني أو كلمة المرور غير صحيحة",variant:"destructive"})}});d.useEffect(()=>{const l=localStorage.getItem("auth_token");l&&l.startsWith("admin-")&&t("/admin")},[t]);const o=l=>{i.mutate(l)};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",dir:"rtl",children:s.jsxs(oe,{className:"w-full max-w-md",children:[s.jsxs(xt,{className:"space-y-1 text-center",children:[s.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mb-4",children:s.jsx(Ka,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),s.jsx(Nt,{className:"text-2xl font-bold",children:"لوحة الإدارة"}),s.jsx(lr,{children:"أدخل بيانات المدير للوصول للوحة التحكم"})]}),s.jsx(le,{className:"space-y-4",children:s.jsx(av,{...n,children:s.jsxs("form",{onSubmit:n.handleSubmit(o),className:"space-y-4",children:[s.jsx(Hr,{control:n.control,name:"email",render:({field:l})=>s.jsxs(jr,{children:[s.jsx(Nr,{children:"البريد الإلكتروني"}),s.jsx(Sr,{children:s.jsxs("div",{className:"relative",children:[s.jsx(Af,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(Ce,{...l,type:"email",placeholder:"admin@example.com",className:"pr-10","data-testid":"input-email"})]})}),s.jsx(kr,{})]})}),s.jsx(Hr,{control:n.control,name:"password",render:({field:l})=>s.jsxs(jr,{children:[s.jsx(Nr,{children:"كلمة المرور"}),s.jsx(Sr,{children:s.jsxs("div",{className:"relative",children:[s.jsx(Tn,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(Ce,{...l,type:e?"text":"password",placeholder:"••••••••",className:"pr-10 pl-10","data-testid":"input-password"}),s.jsx("button",{type:"button",onClick:()=>r(!e),className:"absolute left-3 top-3 h-4 w-4 text-gray-400 hover:text-gray-600","data-testid":"toggle-password",children:e?s.jsx(_n,{className:"h-4 w-4"}):s.jsx(La,{className:"h-4 w-4"})})]})}),s.jsx(kr,{})]})}),s.jsx(T,{type:"submit",className:"w-full",disabled:i.isPending,"data-testid":"button-login",children:i.isPending?"جاري تسجيل الدخول...":"تسجيل الدخول"})]})})})]})})}function As({children:t}){const[e]=ys(),[r,a]=d.useState(!1),n=[{title:"لوحة التحكم",icon:Tb,href:"/admin"},{title:"طلبات التوثيق",icon:gt,href:"/admin/verification-requests"},{title:"إدارة المستخدمين",icon:pr,href:"/admin/users"},{title:"إدارة المتاجر",icon:Bt,href:"/admin/stores"},{title:"إدارة الطلبات",icon:Dr,href:"/admin/orders"},{title:"إدارة الميزات",icon:On,href:"/admin/features"},{title:"الإعدادات",icon:Dn,href:"/admin/settings"}],i=()=>{localStorage.removeItem("auth_token"),window.location.href="/admin/login"},o=({mobile:l=!1})=>s.jsxs("div",{className:se("bg-white dark:bg-gray-900 border-l border-gray-200 dark:border-gray-800",l?"w-full":"w-64"),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"لوحة الإدارة"}),l&&s.jsx(T,{variant:"ghost",size:"sm",onClick:()=>a(!1),"data-testid":"close-sidebar",children:s.jsx(dr,{className:"h-5 w-5"})})]}),s.jsx("nav",{className:"p-4 space-y-2",children:n.map(c=>{const h=e===c.href||c.href!=="/admin"&&e.startsWith(c.href);return s.jsx(jt,{href:c.href,children:s.jsxs(T,{variant:h?"secondary":"ghost",className:se("w-full justify-start gap-2","text-right",h&&"bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300"),"data-testid":`nav-${c.href.split("/").pop()}`,children:[s.jsx(c.icon,{className:"h-4 w-4"}),c.title]})},c.href)})}),s.jsx("div",{className:"absolute bottom-0 right-0 left-0 p-4 border-t border-gray-200 dark:border-gray-800",children:s.jsxs(T,{onClick:i,variant:"ghost",className:"w-full justify-start gap-2 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950","data-testid":"logout-button",children:[s.jsx(Pb,{className:"h-4 w-4"}),"تسجيل الخروج"]})})]});return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950",dir:"rtl",children:[s.jsx("div",{className:"lg:hidden bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(T,{variant:"ghost",size:"sm",onClick:()=>a(!0),"data-testid":"open-sidebar",children:s.jsx(Ab,{className:"h-5 w-5"})}),s.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"لوحة الإدارة"})]})}),s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"hidden lg:block fixed top-0 right-0 h-full",children:s.jsx(o,{})}),r&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>a(!1)}),s.jsx("div",{className:"lg:hidden fixed top-0 right-0 h-full w-80 z-50",children:s.jsx(o,{mobile:!0})})]}),s.jsx("div",{className:"flex-1 lg:mr-64",children:s.jsx("main",{className:"p-4 lg:p-8",children:t})})]})]})}function VS(){const{data:t,isLoading:e}=ye({queryKey:["/api/admin/dashboard-stats"],staleTime:3e5}),r=[{title:"إجمالي المستخدمين",value:(t==null?void 0:t.totalUsers)||0,icon:pr,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-950",testId:"stat-total-users"},{title:"المستخدمون النشطون",value:(t==null?void 0:t.activeUsers)||0,icon:$b,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-950",testId:"stat-active-users"},{title:"المستخدمون الموثقون",value:(t==null?void 0:t.verifiedUsers)||0,icon:gt,color:"text-emerald-600",bgColor:"bg-emerald-50 dark:bg-emerald-950",testId:"stat-verified-users"},{title:"إجمالي المتاجر",value:(t==null?void 0:t.totalStores)||0,icon:Bt,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-950",testId:"stat-total-stores"},{title:"إجمالي الطلبات",value:(t==null?void 0:t.totalOrders)||0,icon:Dr,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-950",testId:"stat-total-orders"},{title:"طلبات اليوم",value:(t==null?void 0:t.recentOrders)||0,icon:is,color:"text-indigo-600",bgColor:"bg-indigo-50 dark:bg-indigo-950",testId:"stat-recent-orders"},{title:"طلبات التوثيق المعلقة",value:(t==null?void 0:t.pendingVerifications)||0,icon:gt,color:"text-yellow-600",bgColor:"bg-yellow-50 dark:bg-yellow-950",testId:"stat-pending-verifications"},{title:"إجمالي الإيرادات",value:`${(t==null?void 0:t.totalRevenue)||"0"} دج`,icon:no,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-950",testId:"stat-total-revenue"}];return e?s.jsx(As,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"لوحة التحكم"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(8)].map((a,n)=>s.jsx(oe,{className:"animate-pulse",children:s.jsxs(le,{className:"p-6",children:[s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})},n))})]})}):s.jsx(As,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"لوحة التحكم"}),s.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["آخر تحديث: ",new Date().toLocaleString("ar-DZ")]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:r.map((a,n)=>s.jsxs(oe,{className:"relative overflow-hidden",children:[s.jsxs(xt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(Nt,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:a.title}),s.jsx("div",{className:`p-2 rounded-full ${a.bgColor}`,children:s.jsx(a.icon,{className:`h-4 w-4 ${a.color}`})})]}),s.jsx(le,{children:s.jsx("div",{className:`text-2xl font-bold ${a.color}`,"data-testid":a.testId,children:typeof a.value=="string"?a.value:a.value.toLocaleString("ar-DZ")})})]},n))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(xt,{children:s.jsxs(Nt,{className:"flex items-center gap-2",children:[s.jsx(gt,{className:"h-5 w-5 text-yellow-600"}),"طلبات التوثيق المعلقة"]})}),s.jsx(le,{children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-3xl font-bold text-yellow-600 mb-2",children:(t==null?void 0:t.pendingVerifications)||0}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"طلب في انتظار المراجعة"}),s.jsx("a",{href:"/admin/verification-requests",className:"inline-flex items-center px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors","data-testid":"link-verification-requests",children:"مراجعة الطلبات"})]})})]}),s.jsxs(oe,{children:[s.jsx(xt,{children:s.jsxs(Nt,{className:"flex items-center gap-2",children:[s.jsx(or,{className:"h-5 w-5 text-green-600"}),"النشاط اليومي"]})}),s.jsx(le,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"طلبات جديدة اليوم"}),s.jsx("span",{className:"font-semibold text-green-600",children:(t==null?void 0:t.recentOrders)||0})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"مستخدمون نشطون"}),s.jsx("span",{className:"font-semibold text-blue-600",children:(t==null?void 0:t.activeUsers)||0})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"معدل التوثيق"}),s.jsxs("span",{className:"font-semibold text-purple-600",children:[t!=null&&t.totalUsers?Math.round(t.verifiedUsers/t.totalUsers*100):0,"%"]})]})]})})]})]})]})})}const zS=Re.object({currentPassword:Re.string().min(1,"كلمة المرور الحالية مطلوبة"),newEmail:Re.string().email("يرجى إدخال بريد إلكتروني صحيح"),newPassword:Re.string().min(6,"كلمة المرور الجديدة يجب أن تكون 6 أحرف على الأقل"),confirmPassword:Re.string().min(6,"تأكيد كلمة المرور مطلوب")}).refine(t=>t.newPassword===t.confirmPassword,{message:"كلمتا المرور غير متطابقتان",path:["confirmPassword"]});function $S(){const[t,e]=d.useState(!1),[r,a]=d.useState(!1),[n,i]=d.useState(!1),{toast:o}=lt(),l=Ha({resolver:Za(zS),defaultValues:{currentPassword:"",newEmail:"",newPassword:"",confirmPassword:""}}),c=Se({mutationFn:u=>ce("/api/admin/update-credentials",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),onSuccess:u=>{o({title:"تم تحديث البيانات بنجاح",description:u.message}),l.reset(),console.log("تعليمات تحديث متغيرات البيئة:"),console.log("ADMIN_EMAIL =",u.newEmail),console.log("ADMIN_PASSWORD =",u.newPassword)},onError:u=>{o({title:"خطأ في تحديث البيانات",description:u.message||"حدث خطأ أثناء تحديث البيانات",variant:"destructive"})}}),h=u=>{c.mutate(u)};return s.jsx(As,{children:s.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:s.jsx(Dn,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"إعدادات الإدارة"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"تحديث بيانات اعتماد الإدارة"})]})]}),s.jsxs(oe,{children:[s.jsxs(xt,{children:[s.jsx(Nt,{children:"تحديث بيانات الاعتماد"}),s.jsx(lr,{children:"قم بتحديث الإيميل وكلمة المرور الخاصة بحساب الإدارة"})]}),s.jsx(le,{children:s.jsx(av,{...l,children:s.jsxs("form",{onSubmit:l.handleSubmit(h),className:"space-y-6",children:[s.jsx(Hr,{control:l.control,name:"currentPassword",render:({field:u})=>s.jsxs(jr,{children:[s.jsx(Nr,{children:"كلمة المرور الحالية"}),s.jsx(Sr,{children:s.jsxs("div",{className:"relative",children:[s.jsx(Tn,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(Ce,{...u,type:t?"text":"password",placeholder:"أدخل كلمة المرور الحالية",className:"pr-10 pl-10","data-testid":"input-current-password"}),s.jsx("button",{type:"button",onClick:()=>e(!t),className:"absolute left-3 top-3 h-4 w-4 text-gray-400 hover:text-gray-600","data-testid":"toggle-current-password",children:t?s.jsx(_n,{className:"h-4 w-4"}):s.jsx(La,{className:"h-4 w-4"})})]})}),s.jsx(kr,{})]})}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"البيانات الجديدة"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(Hr,{control:l.control,name:"newEmail",render:({field:u})=>s.jsxs(jr,{children:[s.jsx(Nr,{children:"الإيميل الجديد"}),s.jsx(Sr,{children:s.jsxs("div",{className:"relative",children:[s.jsx(Af,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(Ce,{...u,type:"email",placeholder:"أدخل الإيميل الجديد",className:"pr-10","data-testid":"input-new-email"})]})}),s.jsx(kr,{})]})}),s.jsx(Hr,{control:l.control,name:"newPassword",render:({field:u})=>s.jsxs(jr,{children:[s.jsx(Nr,{children:"كلمة المرور الجديدة"}),s.jsx(Sr,{children:s.jsxs("div",{className:"relative",children:[s.jsx(Tn,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(Ce,{...u,type:r?"text":"password",placeholder:"أدخل كلمة المرور الجديدة",className:"pr-10 pl-10","data-testid":"input-new-password"}),s.jsx("button",{type:"button",onClick:()=>a(!r),className:"absolute left-3 top-3 h-4 w-4 text-gray-400 hover:text-gray-600","data-testid":"toggle-new-password",children:r?s.jsx(_n,{className:"h-4 w-4"}):s.jsx(La,{className:"h-4 w-4"})})]})}),s.jsx(kr,{})]})}),s.jsx(Hr,{control:l.control,name:"confirmPassword",render:({field:u})=>s.jsxs(jr,{children:[s.jsx(Nr,{children:"تأكيد كلمة المرور الجديدة"}),s.jsx(Sr,{children:s.jsxs("div",{className:"relative",children:[s.jsx(Tn,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(Ce,{...u,type:n?"text":"password",placeholder:"أعد إدخال كلمة المرور الجديدة",className:"pr-10 pl-10","data-testid":"input-confirm-password"}),s.jsx("button",{type:"button",onClick:()=>i(!n),className:"absolute left-3 top-3 h-4 w-4 text-gray-400 hover:text-gray-600","data-testid":"toggle-confirm-password",children:n?s.jsx(_n,{className:"h-4 w-4"}):s.jsx(La,{className:"h-4 w-4"})})]})}),s.jsx(kr,{})]})})]})]}),s.jsxs("div",{className:"flex gap-4 pt-6 border-t",children:[s.jsxs(T,{type:"submit",disabled:c.isPending,className:"flex-1","data-testid":"button-save-settings",children:[s.jsx(If,{className:"h-4 w-4 ml-2"}),c.isPending?"جاري الحفظ...":"حفظ التغييرات"]}),s.jsx(T,{type:"button",variant:"outline",onClick:()=>l.reset(),className:"flex-1","data-testid":"button-reset-form",children:"إعادة تعيين"})]})]})})})]}),s.jsx(oe,{className:"border-yellow-200 bg-yellow-50 dark:bg-yellow-950 dark:border-yellow-800",children:s.jsx(le,{className:"pt-6",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-1 bg-yellow-100 dark:bg-yellow-900 rounded",children:s.jsx(Dn,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("h4",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"ملاحظة هامة"}),s.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"بعد تحديث بيانات الاعتماد، ستحتاج لتسجيل الدخول مرة أخرى باستخدام البيانات الجديدة. تأكد من حفظ البيانات الجديدة في مكان آمن."})]})]})})})]})})}function qS(){const[t,e]=d.useState(null),[r,a]=d.useState(""),[n,i]=d.useState("pending"),o=vs(),{toast:l}=lt(),{data:c,isLoading:h,refetch:u}=ye({queryKey:["/api/admin/verification-requests",{status:n}],queryFn:()=>ce(`/api/admin/verification-requests?status=${n}&limit=50`)}),p=Se({mutationFn:({requestId:m,status:S,adminNote:v})=>ce(`/api/admin/verification-requests/${m}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:S,adminNote:v})}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/admin/verification-requests"]}),o.invalidateQueries({queryKey:["/api/admin/dashboard-stats"]}),e(null),a(""),l({title:"تم التحديث",description:"تم تحديث حالة الطلب بنجاح"})},onError:()=>{l({title:"خطأ",description:"فشل في تحديث حالة الطلب",variant:"destructive"})}}),f=m=>{p.mutate({requestId:m,status:"approved",adminNote:r||void 0})},g=m=>{if(!r.trim()){l({title:"مطلوب",description:"يجب إضافة ملاحظة عند رفض الطلب",variant:"destructive"});return}p.mutate({requestId:m,status:"rejected",adminNote:r.trim()})},j=m=>{switch(m){case"pending":return s.jsxs(Te,{variant:"outline",className:"text-yellow-600 border-yellow-200",children:[s.jsx(is,{className:"w-3 h-3 ml-1"}),"معلق"]});case"approved":return s.jsxs(Te,{className:"bg-green-100 text-green-800 hover:bg-green-100",children:[s.jsx(gt,{className:"w-3 h-3 ml-1"}),"موافق عليه"]});case"rejected":return s.jsxs(Te,{variant:"destructive",children:[s.jsx($s,{className:"w-3 h-3 ml-1"}),"مرفوض"]});default:return s.jsx(Te,{variant:"secondary",children:m})}},x=m=>{switch(m){case"account":return"توثيق الحساب";case"store":return"توثيق المتجر";default:return m}};return h?s.jsx(As,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"طلبات التوثيق"}),s.jsx("div",{className:"grid gap-4",children:[...Array(3)].map((m,S)=>s.jsx(oe,{className:"animate-pulse",children:s.jsxs(le,{className:"p-6",children:[s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})},S))})]})}):s.jsx(As,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"طلبات التوثيق"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(T,{variant:n==="pending"?"default":"outline",size:"sm",onClick:()=>i("pending"),"data-testid":"filter-pending",children:"المعلقة"}),s.jsx(T,{variant:n==="approved"?"default":"outline",size:"sm",onClick:()=>i("approved"),"data-testid":"filter-approved",children:"الموافق عليها"}),s.jsx(T,{variant:n==="rejected"?"default":"outline",size:"sm",onClick:()=>i("rejected"),"data-testid":"filter-rejected",children:"المرفوضة"})]})]}),s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["إجمالي الطلبات: ",(c==null?void 0:c.total)||0]}),s.jsxs("div",{className:"grid gap-4",children:[c==null?void 0:c.requests.map(m=>s.jsx(oe,{className:"hover:shadow-md transition-shadow",children:s.jsx(le,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(_s,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"font-medium",children:["معرف المستخدم: ",m.userId]}),j(m.status)]}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[s.jsx(Dl,{className:"h-4 w-4"}),s.jsxs("span",{children:["نوع الطلب: ",x(m.requestType)]})]}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[s.jsx(mi,{className:"h-4 w-4"}),s.jsxs("span",{children:["تاريخ التقديم: ",new Date(m.submittedAt).toLocaleDateString("ar-DZ")]})]}),m.reason&&s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.jsx("strong",{children:"السبب:"})," ",m.reason]}),m.adminNote&&s.jsxs("div",{className:"text-sm bg-gray-50 dark:bg-gray-800 p-3 rounded-md",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(fn,{className:"h-4 w-4"}),s.jsx("strong",{children:"ملاحظة الإدارة:"})]}),s.jsx("p",{children:m.adminNote})]}),m.documents.length>0&&s.jsxs("div",{className:"text-sm",children:[s.jsx("strong",{children:"المستندات:"})," ",m.documents.length," مستند مرفق"]})]}),m.status==="pending"&&s.jsx("div",{className:"flex gap-2 ml-4",children:s.jsx(T,{onClick:()=>e(m),size:"sm","data-testid":`review-${m.id}`,children:"مراجعة"})})]})})},m.id)),!(c!=null&&c.requests.length)&&s.jsx(oe,{children:s.jsxs(le,{className:"p-12 text-center",children:[s.jsx(gt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"لا توجد طلبات"}),s.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["لا توجد طلبات توثيق ",n==="pending"?"معلقة":n==="approved"?"موافق عليها":"مرفوضة"," حالياً"]})]})})]}),t&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs(oe,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(xt,{children:s.jsxs(Nt,{children:["مراجعة طلب التوثيق - ",x(t.requestType)]})}),s.jsxs(le,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"معرف المستخدم:"})," ",t.userId]}),s.jsxs("div",{children:[s.jsx("strong",{children:"تاريخ التقديم:"})," ",new Date(t.submittedAt).toLocaleDateString("ar-DZ")]})]}),t.reason&&s.jsxs("div",{children:[s.jsx("strong",{children:"سبب الطلب:"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:t.reason})]}),t.documents.length>0&&s.jsxs("div",{children:[s.jsx("strong",{children:"المستندات المرفقة:"}),s.jsx("div",{className:"mt-2 space-y-2",children:t.documents.map((m,S)=>s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Dl,{className:"h-4 w-4"}),s.jsxs("span",{children:["مستند ",S+1]})]},S))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"ملاحظة الإدارة:"}),s.jsx(qs,{value:r,onChange:m=>a(m.target.value),placeholder:"أضف ملاحظة للمستخدم (مطلوبة عند الرفض)",className:"resize-none",rows:4,"data-testid":"admin-note"})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[s.jsx(T,{variant:"outline",onClick:()=>{e(null),a("")},"data-testid":"cancel-review",children:"إلغاء"}),s.jsx(T,{variant:"destructive",onClick:()=>g(t.id),disabled:p.isPending,"data-testid":"reject-request",children:p.isPending?"جاري الرفض...":"رفض"}),s.jsx(T,{onClick:()=>f(t.id),disabled:p.isPending,className:"bg-green-600 hover:bg-green-700","data-testid":"approve-request",children:p.isPending?"جاري الموافقة...":"موافقة"})]})]})]})})]})})}function US(){const[t,e]=d.useState(""),[r,a]=d.useState("all"),[n,i]=d.useState("all"),o=vs(),{toast:l}=lt(),{data:c,isLoading:h}=ye({queryKey:["/api/admin/users",{search:t,isVerified:r==="all"?void 0:r==="verified",isAdmin:n==="all"?void 0:n==="admin"}],queryFn:()=>{const m=new URLSearchParams;return t&&m.append("search",t),r!=="all"&&m.append("isVerified",r==="verified"?"true":"false"),n!=="all"&&m.append("isAdmin",n==="admin"?"true":"false"),m.append("limit","50"),ce(`/api/admin/users?${m.toString()}`)}}),u=Se({mutationFn:({userId:m,isAdmin:S})=>ce(`/api/admin/users/${m}/admin`,{method:"PUT",body:JSON.stringify({isAdmin:S})}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/admin/users"]}),l({title:"تم التحديث",description:"تم تحديث صلاحيات المستخدم بنجاح"})},onError:()=>{l({title:"خطأ",description:"فشل في تحديث صلاحيات المستخدم",variant:"destructive"})}}),p=Se({mutationFn:({userId:m,isVerified:S})=>ce(`/api/admin/users/${m}/verify`,{method:"PUT",body:JSON.stringify({isVerified:S})}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/admin/users"]}),l({title:"تم التحديث",description:"تم تحديث حالة التوثيق بنجاح"})},onError:()=>{l({title:"خطأ",description:"فشل في تحديث حالة التوثيق",variant:"destructive"})}}),f=m=>{u.mutate({userId:m.id,isAdmin:!m.isAdmin})},g=m=>{p.mutate({userId:m.id,isVerified:!m.isVerified})},j=m=>m.isAdmin?s.jsxs(Te,{className:"bg-purple-100 text-purple-800",children:[s.jsx(Ka,{className:"w-3 h-3 ml-1"}),"مدير"]}):m.isVerified?s.jsxs(Te,{className:"bg-green-100 text-green-800",children:[s.jsx(gt,{className:"w-3 h-3 ml-1"}),"موثق"]}):s.jsxs(Te,{variant:"outline",children:[s.jsx($s,{className:"w-3 h-3 ml-1"}),"غير موثق"]}),x=m=>{if(m.isOnline)return s.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-xs",children:"متصل"})]});const S=new Date(m.lastSeen),y=Math.floor((new Date().getTime()-S.getTime())/(1e3*60));let C="";return y<5?C="قبل قليل":y<60?C=`قبل ${y} دقيقة`:y<1440?C=`قبل ${Math.floor(y/60)} ساعة`:C=`قبل ${Math.floor(y/1440)} يوم`,s.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),s.jsx("span",{className:"text-xs",children:C})]})};return h?s.jsx(As,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"إدارة المستخدمين"}),s.jsx("div",{className:"grid gap-4",children:[...Array(5)].map((m,S)=>s.jsx(oe,{className:"animate-pulse",children:s.jsxs(le,{className:"p-6",children:[s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})},S))})]})}):s.jsx(As,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"إدارة المستخدمين"})}),s.jsx(oe,{children:s.jsx(le,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(cr,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(Ce,{placeholder:"البحث بالاسم أو رقم الهاتف...",value:t,onChange:m=>e(m.target.value),className:"pr-10","data-testid":"search-users"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(T,{variant:r==="all"?"default":"outline",size:"sm",onClick:()=>a("all"),"data-testid":"filter-all-verified",children:"الكل"}),s.jsx(T,{variant:r==="verified"?"default":"outline",size:"sm",onClick:()=>a("verified"),"data-testid":"filter-verified",children:"موثق"}),s.jsx(T,{variant:r==="unverified"?"default":"outline",size:"sm",onClick:()=>a("unverified"),"data-testid":"filter-unverified",children:"غير موثق"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(T,{variant:n==="all"?"default":"outline",size:"sm",onClick:()=>i("all"),"data-testid":"filter-all-admin",children:"الكل"}),s.jsx(T,{variant:n==="admin"?"default":"outline",size:"sm",onClick:()=>i("admin"),"data-testid":"filter-admin",children:"مديرين"}),s.jsx(T,{variant:n==="user"?"default":"outline",size:"sm",onClick:()=>i("user"),"data-testid":"filter-regular-users",children:"مستخدمين عاديين"})]}),s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 self-center",children:["إجمالي المستخدمين: ",(c==null?void 0:c.total)||0]})]})})}),s.jsxs("div",{className:"grid gap-4",children:[c==null?void 0:c.users.map(m=>s.jsx(oe,{className:"hover:shadow-md transition-shadow",children:s.jsx(le,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center",children:m.avatar?s.jsx("img",{src:m.avatar,alt:m.name,className:"w-12 h-12 rounded-full object-cover"}):s.jsx(_s,{className:"h-6 w-6 text-gray-400"})}),s.jsxs("div",{className:"space-y-2 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h3",{className:"font-semibold text-lg",children:m.name}),j(m),x(m)]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Es,{className:"h-4 w-4"}),s.jsx("span",{children:m.phoneNumber})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gs,{className:"h-4 w-4"}),s.jsx("span",{children:m.location})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(mi,{className:"h-4 w-4"}),s.jsxs("span",{children:["انضم: ",new Date(m.createdAt).toLocaleDateString("ar-DZ")]})]})]})]})]}),s.jsxs("div",{className:"flex gap-2 ml-4",children:[s.jsx(T,{variant:m.isVerified?"outline":"default",size:"sm",onClick:()=>g(m),disabled:p.isPending,className:m.isVerified?"text-red-600 hover:text-red-700":"bg-green-600 hover:bg-green-700","data-testid":`toggle-verification-${m.id}`,children:m.isVerified?s.jsxs(s.Fragment,{children:[s.jsx($s,{className:"h-4 w-4 ml-1"}),"إلغاء التوثيق"]}):s.jsxs(s.Fragment,{children:[s.jsx(gt,{className:"h-4 w-4 ml-1"}),"توثيق"]})}),s.jsx(T,{variant:m.isAdmin?"outline":"secondary",size:"sm",onClick:()=>f(m),disabled:u.isPending,className:m.isAdmin?"text-orange-600 hover:text-orange-700":"","data-testid":`toggle-admin-${m.id}`,children:m.isAdmin?s.jsxs(s.Fragment,{children:[s.jsx(Ka,{className:"h-4 w-4 ml-1"}),"إزالة إدارة"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ba,{className:"h-4 w-4 ml-1"}),"جعل مدير"]})})]})]})})},m.id)),!(c!=null&&c.users.length)&&s.jsx(oe,{children:s.jsxs(le,{className:"p-12 text-center",children:[s.jsx(pr,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"لا توجد مستخدمين"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"لم يتم العثور على مستخدمين يطابقون معايير البحث"})]})})]})]})})}function BS(){const[t,e]=d.useState(""),[r,a]=d.useState("all"),[n,i]=d.useState(null),[o,l]=d.useState(""),c=vs(),{toast:h}=lt(),{data:u,isLoading:p}=ye({queryKey:["/api/admin/stores",{search:t,status:r==="all"?void 0:r}],queryFn:()=>{const y=new URLSearchParams;return t&&y.append("search",t),r!=="all"&&y.append("status",r),y.append("limit","50"),ce(`/api/admin/stores?${y.toString()}`)}}),f=Se({mutationFn:({storeId:y,status:C,rejectionReason:k})=>ce(`/api/admin/stores/${y}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:C,rejectionReason:k})}),onSuccess:(y,C)=>{c.invalidateQueries({queryKey:["/api/admin/stores"]}),c.invalidateQueries({queryKey:["/api/admin/dashboard-stats"]}),c.invalidateQueries({queryKey:["/api/user/store"]}),i(null),l("");const k=C.status==="approved"?"تم الموافقة على المتجر":C.status==="rejected"?"تم رفض المتجر":C.status==="suspended"?"تم تعليق المتجر":"تم تحديث حالة المتجر";h({title:"تم التحديث",description:k+" بنجاح"})},onError:()=>{h({title:"خطأ",description:"فشل في تحديث حالة المتجر",variant:"destructive"})}}),g=y=>{f.mutate({storeId:y,status:"approved"})},j=y=>{const C=o.trim()||"لم يتم تحديد سبب الرفض";f.mutate({storeId:y,status:"rejected",rejectionReason:C})},x=y=>{f.mutate({storeId:y,status:"suspended"})},m=y=>{switch(y){case"pending":return s.jsxs(Te,{variant:"outline",className:"text-yellow-600 border-yellow-200",children:[s.jsx(is,{className:"w-3 h-3 ml-1"}),"في الانتظار"]});case"approved":return s.jsxs(Te,{className:"bg-green-100 text-green-800 hover:bg-green-100",children:[s.jsx(gt,{className:"w-3 h-3 ml-1"}),"مفعل"]});case"rejected":return s.jsxs(Te,{variant:"destructive",children:[s.jsx($s,{className:"w-3 h-3 ml-1"}),"مرفوض"]});case"suspended":return s.jsxs(Te,{className:"bg-orange-100 text-orange-800 hover:bg-orange-100",children:[s.jsx($s,{className:"w-3 h-3 ml-1"}),"معلق"]});default:return s.jsx(Te,{variant:"secondary",children:y})}},S=y=>({electronics:"إلكترونيات",fashion:"أزياء",food:"طعام",books:"كتب",sports:"رياضة",beauty:"جمال",home:"منزل",automotive:"سيارات",health:"صحة",other:"أخرى"})[y]||y,v=y=>s.jsxs("div",{className:"flex items-center gap-1",children:[[...Array(5)].map((C,k)=>s.jsx(lo,{className:`w-4 h-4 ${k<y?"text-yellow-400 fill-current":"text-gray-300"}`},k)),s.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 mr-1",children:["(",y.toFixed(1),")"]})]});return p?s.jsx(As,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"إدارة المتاجر"}),s.jsx("div",{className:"grid gap-4",children:[...Array(5)].map((y,C)=>s.jsx(oe,{className:"animate-pulse",children:s.jsxs(le,{className:"p-6",children:[s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})},C))})]})}):s.jsx(As,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"إدارة المتاجر"})}),s.jsx(oe,{children:s.jsx(le,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(cr,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(Ce,{placeholder:"البحث بالاسم أو الفئة...",value:t,onChange:y=>e(y.target.value),className:"pr-10","data-testid":"search-stores"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(T,{variant:r==="all"?"default":"outline",size:"sm",onClick:()=>a("all"),"data-testid":"filter-all",children:"الكل"}),s.jsx(T,{variant:r==="pending"?"default":"outline",size:"sm",onClick:()=>a("pending"),"data-testid":"filter-pending",children:"في الانتظار"}),s.jsx(T,{variant:r==="approved"?"default":"outline",size:"sm",onClick:()=>a("approved"),"data-testid":"filter-approved",children:"مفعل"}),s.jsx(T,{variant:r==="suspended"?"default":"outline",size:"sm",onClick:()=>a("suspended"),"data-testid":"filter-suspended",children:"معلق"})]}),s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 self-center",children:["إجمالي المتاجر: ",(u==null?void 0:u.total)||0]})]})})}),s.jsxs("div",{className:"grid gap-4",children:[u==null?void 0:u.stores.map(y=>s.jsx(oe,{className:"hover:shadow-md transition-shadow",children:s.jsx(le,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:y.logo?s.jsx("img",{src:y.logo,alt:y.name,className:"w-16 h-16 rounded-lg object-cover"}):s.jsx(Bt,{className:"h-8 w-8 text-gray-400"})}),s.jsxs("div",{className:"space-y-3 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h3",{className:"font-semibold text-lg",children:y.name}),m(y.status),s.jsx(Te,{variant:"outline",className:"text-xs",children:S(y.category)})]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:y.description}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Es,{className:"h-4 w-4"}),s.jsx("span",{children:y.phoneNumber})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gs,{className:"h-4 w-4"}),s.jsx("span",{children:y.location})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Dt,{className:"h-4 w-4"}),s.jsxs("span",{children:[y.totalProducts," منتج"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(mi,{className:"h-4 w-4"}),s.jsxs("span",{children:["انضم: ",new Date(y.createdAt).toLocaleDateString("ar-DZ")]})]})]}),y.rating>0&&s.jsx("div",{className:"flex items-center gap-2",children:v(y.rating)})]})]}),s.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[y.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsxs(T,{size:"sm",onClick:()=>g(y.id),disabled:f.isPending,className:"bg-green-600 hover:bg-green-700","data-testid":`approve-${y.id}`,children:[s.jsx(gt,{className:"h-4 w-4 ml-1"}),"موافقة"]}),s.jsxs(T,{variant:"destructive",size:"sm",onClick:()=>j(y.id),disabled:f.isPending,"data-testid":`reject-${y.id}`,children:[s.jsx($s,{className:"h-4 w-4 ml-1"}),"رفض"]})]}),y.status==="approved"&&s.jsxs(T,{variant:"outline",size:"sm",onClick:()=>x(y.id),disabled:f.isPending,className:"text-orange-600 hover:text-orange-700","data-testid":`suspend-${y.id}`,children:[s.jsx(is,{className:"h-4 w-4 ml-1"}),"تعليق"]}),y.status==="suspended"&&s.jsxs(T,{size:"sm",onClick:()=>g(y.id),disabled:f.isPending,className:"bg-green-600 hover:bg-green-700","data-testid":`reactivate-${y.id}`,children:[s.jsx(gt,{className:"h-4 w-4 ml-1"}),"إعادة تفعيل"]}),s.jsx(T,{variant:"ghost",size:"sm",onClick:()=>i(y),"data-testid":`view-${y.id}`,children:"عرض التفاصيل"})]})]})})},y.id)),!(u!=null&&u.stores.length)&&s.jsx(oe,{children:s.jsxs(le,{className:"p-12 text-center",children:[s.jsx(Bt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"لا توجد متاجر"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"لم يتم العثور على متاجر تطابق معايير البحث"})]})})]}),n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs(oe,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(xt,{children:s.jsxs(Nt,{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:n.logo?s.jsx("img",{src:n.logo,alt:n.name,className:"w-12 h-12 rounded-lg object-cover"}):s.jsx(Bt,{className:"h-6 w-6 text-gray-400"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:n.name}),m(n.status)]})]})}),s.jsxs(le,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"الفئة:"}),s.jsx("p",{children:S(n.category)})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"رقم الهاتف:"}),s.jsx("p",{children:n.phoneNumber})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"الموقع:"}),s.jsx("p",{children:n.location})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"عدد المنتجات:"}),s.jsxs("p",{children:[n.totalProducts," منتج"]})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"تاريخ الانضمام:"}),s.jsx("p",{children:new Date(n.createdAt).toLocaleDateString("ar-DZ")})]}),n.verifiedAt&&s.jsxs("div",{children:[s.jsx("strong",{children:"تاريخ التوثيق:"}),s.jsx("p",{children:new Date(n.verifiedAt).toLocaleDateString("ar-DZ")})]})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"الوصف:"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:n.description})]}),n.rating>0&&s.jsxs("div",{children:[s.jsx("strong",{children:"التقييم:"}),s.jsx("div",{className:"mt-1",children:v(n.rating)})]}),s.jsx("div",{className:"flex justify-end gap-2 pt-4 border-t",children:s.jsx(T,{variant:"outline",onClick:()=>i(null),"data-testid":"close-details",children:"إغلاق"})})]})]})})]})})}const KS={pending:{label:"في الانتظار",color:"bg-yellow-100 text-yellow-800",icon:is},confirmed:{label:"مؤكد",color:"bg-blue-100 text-blue-800",icon:gt},prepared:{label:"جاهز",color:"bg-purple-100 text-purple-800",icon:Dt},delivered:{label:"تم التسليم",color:"bg-green-100 text-green-800",icon:Mf},cancelled:{label:"ملغي",color:"bg-red-100 text-red-800",icon:$s}};function QS(){const[t,e]=d.useState(""),[r,a]=d.useState("all"),[n,i]=d.useState(null),o=vs(),{toast:l}=lt(),{data:c,isLoading:h}=ye({queryKey:["/api/admin/orders",{search:t,status:r==="all"?void 0:r}],queryFn:()=>{const g=new URLSearchParams;return t&&g.append("search",t),r!=="all"&&g.append("status",r),g.append("limit","50"),ce(`/api/admin/orders?${g.toString()}`)}}),u=Se({mutationFn:({orderId:g,status:j})=>ce(`/api/admin/orders/${g}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:j})}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/admin/orders"]}),o.invalidateQueries({queryKey:["/api/admin/dashboard-stats"]}),i(null),l({title:"تم التحديث",description:"تم تحديث حالة الطلب بنجاح"})},onError:()=>{l({title:"خطأ",description:"فشل في تحديث حالة الطلب",variant:"destructive"})}}),p=(g,j)=>{u.mutate({orderId:g,status:j})},f=(c==null?void 0:c.orders)||[];return s.jsx(As,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"إدارة الطلبات"})}),s.jsx(oe,{children:s.jsx(le,{className:"pt-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Ce,{placeholder:"ابحث بالرقم أو اسم العميل...",value:t,onChange:g=>e(g.target.value),"data-testid":"search-orders"})}),s.jsxs(Co,{value:r,onValueChange:a,children:[s.jsx(si,{className:"w-full md:w-48","data-testid":"filter-status",children:s.jsx(_o,{placeholder:"حالة الطلب"})}),s.jsxs(ri,{children:[s.jsx(Vs,{value:"all",children:"جميع الحالات"}),s.jsx(Vs,{value:"pending",children:"في الانتظار"}),s.jsx(Vs,{value:"confirmed",children:"مؤكد"}),s.jsx(Vs,{value:"prepared",children:"جاهز"}),s.jsx(Vs,{value:"delivered",children:"تم التسليم"}),s.jsx(Vs,{value:"cancelled",children:"ملغي"})]})]})]})})}),s.jsx("div",{className:"grid gap-4",children:h?s.jsx("div",{className:"text-center py-8",children:s.jsx("div",{className:"text-gray-500",children:"جاري تحميل الطلبات..."})}):f.length===0?s.jsx(oe,{children:s.jsx(le,{className:"pt-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Dt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"لا توجد طلبات"})]})})}):f.map(g=>{const j=KS[g.status],x=j.icon;return s.jsx(oe,{className:"hover:shadow-md transition-shadow",children:s.jsx(le,{className:"pt-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-3 flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:["طلب #",g.id.slice(-8)]}),s.jsx("p",{className:"text-sm text-gray-500",children:new Date(g.createdAt).toLocaleDateString("ar-SA")})]}),s.jsxs(Te,{className:j.color,children:[s.jsx(x,{className:"h-3 w-3 ml-1"}),j.label]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_s,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:g.customerName})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Es,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:g.customerPhone})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gs,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"truncate",children:g.deliveryAddress})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-lg font-medium text-gray-900 dark:text-white",children:[g.totalAmount," دج"]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[g.items.length," منتج"]})]})]}),s.jsxs("div",{className:"flex gap-2 mr-4",children:[s.jsx(T,{variant:"outline",size:"sm",onClick:()=>i(g),"data-testid":`view-order-${g.id}`,children:s.jsx(La,{className:"h-4 w-4"})}),g.status==="pending"&&s.jsx(T,{size:"sm",onClick:()=>p(g.id,"confirmed"),"data-testid":`confirm-order-${g.id}`,children:"تأكيد"}),g.status==="confirmed"&&s.jsx(T,{size:"sm",onClick:()=>p(g.id,"prepared"),"data-testid":`prepare-order-${g.id}`,children:"جاهز"}),g.status==="prepared"&&s.jsx(T,{size:"sm",onClick:()=>p(g.id,"delivered"),"data-testid":`deliver-order-${g.id}`,children:"تم التسليم"})]})]})})},g.id)})}),c&&c.totalPages>1&&s.jsx("div",{className:"flex justify-center gap-2",children:Array.from({length:c.totalPages},(g,j)=>s.jsx(T,{variant:c.page===j+1?"default":"outline",size:"sm","data-testid":`page-${j+1}`,children:j+1},j+1))})]})})}var ml="Switch",[HS,Sk]=$r(ml),[ZS,WS]=HS(ml),ov=d.forwardRef((t,e)=>{const{__scopeSwitch:r,name:a,checked:n,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:h,form:u,...p}=t,[f,g]=d.useState(null),j=ot(e,y=>g(y)),x=d.useRef(!1),m=f?u||!!f.closest("form"):!0,[S=!1,v]=qa({prop:n,defaultProp:i,onChange:h});return s.jsxs(ZS,{scope:r,checked:S,disabled:l,children:[s.jsx(Ae.button,{type:"button",role:"switch","aria-checked":S,"aria-required":o,"data-state":dv(S),"data-disabled":l?"":void 0,disabled:l,value:c,...p,ref:j,onClick:xe(t.onClick,y=>{v(C=>!C),m&&(x.current=y.isPropagationStopped(),x.current||y.stopPropagation())})}),m&&s.jsx(GS,{control:f,bubbles:!x.current,name:a,value:c,checked:S,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});ov.displayName=ml;var lv="SwitchThumb",cv=d.forwardRef((t,e)=>{const{__scopeSwitch:r,...a}=t,n=WS(lv,r);return s.jsx(Ae.span,{"data-state":dv(n.checked),"data-disabled":n.disabled?"":void 0,...a,ref:e})});cv.displayName=lv;var GS=t=>{const{control:e,checked:r,bubbles:a=!0,...n}=t,i=d.useRef(null),o=my(r),l=Fv(e);return d.useEffect(()=>{const c=i.current,h=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(h,"checked").set;if(o!==r&&p){const f=new Event("click",{bubbles:a});p.call(c,r),c.dispatchEvent(f)}},[o,r,a]),s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:i,style:{...t.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function dv(t){return t?"checked":"unchecked"}var uv=ov,XS=cv;const hv=d.forwardRef(({className:t,...e},r)=>s.jsx(uv,{className:se("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:r,children:s.jsx(XS,{className:se("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));hv.displayName=uv.displayName;const pc=t=>{switch(t){case"communication":return s.jsx(Cs,{className:"h-4 w-4"});case"social":return s.jsx(pr,{className:"h-4 w-4"});case"commerce":return s.jsx(Bt,{className:"h-4 w-4"});case"monetization":return s.jsx(or,{className:"h-4 w-4"});case"account":return s.jsx(Ka,{className:"h-4 w-4"});default:return s.jsx(On,{className:"h-4 w-4"})}},gc=t=>{switch(t){case"communication":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";case"social":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300";case"commerce":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"monetization":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"account":return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}},xc=t=>{switch(t){case"communication":return"التواصل";case"social":return"اجتماعي";case"commerce":return"التجارة";case"monetization":return"الربح";case"account":return"الحساب";default:return"عام"}};function JS(){const[t,e]=d.useState(""),[r,a]=d.useState("all"),{toast:n}=lt(),{data:i=[],isLoading:o}=ye({queryKey:["/api/admin/features"]}),l=Se({mutationFn:async({featureId:p,isEnabled:f})=>ce(`/api/admin/features/${p}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isEnabled:f})}),onSuccess:p=>{ft.invalidateQueries({queryKey:["/api/admin/features"]}),ft.invalidateQueries({queryKey:["/api/features"]}),n({title:"تم تحديث الميزة",description:p.message})},onError:p=>{n({title:"خطأ في تحديث الميزة",description:p.message||"حدث خطأ أثناء تحديث الميزة",variant:"destructive"})}}),c=i.filter(p=>{const f=p.name.toLowerCase().includes(t.toLowerCase())||p.description.toLowerCase().includes(t.toLowerCase()),g=r==="all"||p.category===r;return f&&g}),h=Array.from(new Set(i.map(p=>p.category))),u=(p,f)=>{l.mutate({featureId:p,isEnabled:f})};return o?s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"text-lg",children:"جاري تحميل الميزات..."})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",dir:"rtl",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"إدارة ميزات التطبيق"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"تحكم في جميع ميزات التطبيق وقم بتفعيل أو إيقاف أي ميزة"})]}),s.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(cr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx(Ce,{placeholder:"البحث في الميزات...",value:t,onChange:p=>e(p.target.value),className:"pr-10","data-testid":"search-features"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(T,{variant:r==="all"?"default":"outline",onClick:()=>a("all"),size:"sm","data-testid":"filter-all",children:["الكل (",i.length,")"]}),h.map(p=>s.jsxs(T,{variant:r===p?"default":"outline",onClick:()=>a(p),size:"sm",className:"flex items-center gap-2","data-testid":`filter-${p}`,children:[pc(p),xc(p)," (",i.filter(f=>f.category===p).length,")"]},p))]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsx(oe,{children:s.jsx(le,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"إجمالي الميزات"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.length})]}),s.jsx(On,{className:"h-8 w-8 text-blue-600"})]})})}),s.jsx(oe,{children:s.jsx(le,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"الميزات المفعلة"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:i.filter(p=>p.isEnabled).length})]}),s.jsx("div",{className:"h-8 w-8 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx("div",{className:"h-4 w-4 bg-green-600 rounded-full"})})]})})}),s.jsx(oe,{children:s.jsx(le,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"الميزات المتوقفة"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:i.filter(p=>!p.isEnabled).length})]}),s.jsx("div",{className:"h-8 w-8 bg-red-100 rounded-full flex items-center justify-center",children:s.jsx("div",{className:"h-4 w-4 bg-red-600 rounded-full"})})]})})}),s.jsx(oe,{children:s.jsx(le,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"الفئات"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:h.length})]}),s.jsx(Dt,{className:"h-8 w-8 text-purple-600"})]})})})]}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:c.map(p=>s.jsxs(oe,{className:`transition-all duration-200 ${p.isEnabled?"bg-white dark:bg-gray-800 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700"}`,"data-testid":`feature-card-${p.id}`,children:[s.jsx(xt,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${gc(p.category)}`,children:pc(p.category)}),s.jsxs("div",{children:[s.jsx(Nt,{className:"text-lg",children:p.name}),s.jsx(Te,{variant:"secondary",className:`mt-1 text-xs ${gc(p.category)}`,children:xc(p.category)})]})]}),s.jsx(Te,{variant:p.isEnabled?"default":"secondary",className:p.isEnabled?"bg-green-600":"bg-gray-400",children:p.isEnabled?"مفعل":"متوقف"})]})}),s.jsxs(le,{children:[s.jsx(lr,{className:"mb-4 text-sm leading-relaxed",children:p.description}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2 rtl:space-x-reverse",children:[s.jsx(hv,{id:`feature-${p.id}`,checked:p.isEnabled,onCheckedChange:f=>u(p.id,f),disabled:l.isPending,"data-testid":`toggle-${p.id}`}),s.jsx(Pe,{htmlFor:`feature-${p.id}`,className:"text-sm",children:l.isPending?"جاري التحديث...":p.isEnabled?"تعطيل":"تفعيل"})]}),s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["الأولوية: ",p.priority]})]})]})]},p.id))}),c.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(On,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"لا توجد ميزات"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"لم يتم العثور على ميزات تطابق البحث أو الفلتر المحدد"})]})]})})}function yr({children:t}){const[,e]=ys(),[r,a]=d.useState(!0),[n,i]=d.useState(!1);return d.useEffect(()=>{(()=>{const l=localStorage.getItem("auth_token");if(!l||!l.startsWith("admin-")){e("/admin/login");return}i(!0),a(!1)})()},[e]),r?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:s.jsxs("div",{className:"text-center",children:[s.jsx(oo,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"جاري التحقق من صلاحيات الإدارة..."})]})}):n?s.jsx(s.Fragment,{children:t}):null}function YS(){const{isAuthenticated:t,isLoading:e}=rp(),[r]=ys();return e?s.jsx("div",{className:"min-h-screen bg-[#075e54] flex items-center justify-center",children:s.jsx("div",{className:"text-white text-lg",children:"جارِ التحميل..."})}):s.jsxs(s.Fragment,{children:[s.jsxs(m0,{children:[s.jsx(rt,{path:"/admin/login",component:LS}),s.jsx(rt,{path:"/admin/verification-requests",children:s.jsx(yr,{children:s.jsx(qS,{})})}),s.jsx(rt,{path:"/admin/users",children:s.jsx(yr,{children:s.jsx(US,{})})}),s.jsx(rt,{path:"/admin/stores",children:s.jsx(yr,{children:s.jsx(BS,{})})}),s.jsx(rt,{path:"/admin/orders",children:s.jsx(yr,{children:s.jsx(QS,{})})}),s.jsx(rt,{path:"/admin/features",children:s.jsx(yr,{children:s.jsx(JS,{})})}),s.jsx(rt,{path:"/admin/settings",children:s.jsx(yr,{children:s.jsx($S,{})})}),s.jsx(rt,{path:"/admin",children:s.jsx(yr,{children:s.jsx(VS,{})})}),t?s.jsxs(s.Fragment,{children:[s.jsx(rt,{path:"/",component:Bl}),s.jsx(rt,{path:"/chat/:chatId",component:Bl}),s.jsx(rt,{path:"/status",component:qj}),s.jsx(rt,{path:"/stores",component:Bj}),s.jsx(rt,{path:"/product/:productId",component:Zj}),s.jsx(rt,{path:"/my-store",component:M2}),s.jsx(rt,{path:"/cart",component:MS}),s.jsx(rt,{path:"/orders",component:OS}),s.jsx(rt,{path:"/affiliate",component:L2}),s.jsx(rt,{path:"/affiliate/:uniqueCode",component:z2}),s.jsx(rt,{path:"/profile",component:V2})]}):s.jsx(rt,{component:ES}),s.jsx(rt,{component:IS})]}),t&&!r.startsWith("/admin")&&s.jsx(Jw,{})]})}function ek(){return s.jsx(Hw,{defaultTheme:"dark",storageKey:"whatsapp-ui-theme",children:s.jsx(R0,{client:ft,children:s.jsx(Gw,{children:s.jsx(Yw,{children:s.jsxs(Bw,{children:[s.jsx(Cw,{}),s.jsx(YS,{})]})})})})})}let yc=!1;const mv=()=>{if(yc)return;const t=console.error;console.error=(...e)=>{const r=e.join(" ");if(r.includes("removeChild")||r.includes("Failed to execute 'removeChild'")||r.includes("Node")||r.includes("plugin:runtime-error-plugin")||r.includes("server.hmr.overlay")){console.debug("Portal safety: Handled DOM operation warning:",...e);return}t.apply(console,e)},window.addEventListener("error",e=>{var r,a,n;((r=e.message)!=null&&r.includes("removeChild")||(a=e.message)!=null&&a.includes("appendChild")||(n=e.message)!=null&&n.includes("insertBefore"))&&(e.preventDefault(),console.debug("Portal safety: Prevented DOM error:",e.message))}),window.addEventListener("unhandledrejection",e=>{var r,a,n,i;((a=(r=e.reason)==null?void 0:r.message)!=null&&a.includes("removeChild")||(i=(n=e.reason)==null?void 0:n.message)!=null&&i.includes("DOM"))&&(e.preventDefault(),console.debug("Portal safety: Handled DOM promise rejection:",e.reason))}),yc=!0,console.debug("Portal safety initialized successfully")},tk=()=>{if(typeof window<"u"&&window.__vite_plugin_error_overlay){const e=window.__vite_plugin_error_overlay;window.__vite_plugin_error_overlay={...e,close:()=>{Ye(()=>{var r;(r=e.close)==null||r.call(e)},"HMR overlay close warning")},show:(...r)=>{Ye(()=>{var a;(a=e.show)==null||a.call(e,...r)},"HMR overlay show warning")}}}const t=()=>{Ye(()=>{document.querySelectorAll("[data-runtime-error-overlay]").forEach(r=>{try{r.remove()}catch(a){console.debug("Portal safety: Overlay cleanup warning:",a)}})},"Existing overlays cleanup warning")};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()},sk=()=>{console.debug("Initializing runtime error fixes..."),mv(),tk(),rk(),ak(),nk(),ik(),console.debug("Runtime error fixes initialized successfully")},rk=()=>{try{const t=Node.prototype.removeChild,e=Node.prototype.appendChild,r=Node.prototype.insertBefore,a=Node.prototype.replaceChild;Node.prototype.removeChild=function(n){try{return this.contains&&this.contains(n)?t.call(this,n):(console.debug("Portal safety: Attempted to remove non-existent child"),n)}catch(i){return console.debug("Portal safety: RemoveChild warning:",i),n}},Node.prototype.appendChild=function(n){try{return e.call(this,n)}catch(i){return console.debug("Portal safety: AppendChild warning:",i),n}},Node.prototype.insertBefore=function(n,i){try{return r.call(this,n,i)}catch(o){return console.debug("Portal safety: InsertBefore warning:",o),n}},Node.prototype.replaceChild=function(n,i){try{return this.contains&&this.contains(i)?a.call(this,n,i):(console.debug("Portal safety: Attempted to replace non-existent child"),i)}catch(o){return console.debug("Portal safety: ReplaceChild warning:",o),i}}}catch(t){console.debug("DOM patching warning:",t)}},ak=()=>{const t=window.MutationObserver;window.MutationObserver=class extends t{constructor(r){const a=(n,i)=>{Ye(()=>{r(n,i)},"MutationObserver callback warning")};super(a)}observe(r,a){Ye(()=>{super.observe(r,a)},"MutationObserver observe warning")}disconnect(){Ye(()=>{super.disconnect()},"MutationObserver disconnect warning")}}},nk=()=>{const t=window.IntersectionObserver;t&&(window.IntersectionObserver=class extends t{constructor(r,a){const n=(i,o)=>{Ye(()=>{r(i,o)},"IntersectionObserver callback warning")};super(n,a)}observe(r){Ye(()=>{super.observe(r)},"IntersectionObserver observe warning")}unobserve(r){Ye(()=>{super.unobserve(r)},"IntersectionObserver unobserve warning")}disconnect(){Ye(()=>{super.disconnect()},"IntersectionObserver disconnect warning")}})},ik=()=>{const t=window.ResizeObserver;t&&(window.ResizeObserver=class extends t{constructor(r){const a=(n,i)=>{Ye(()=>{r(n,i)},"ResizeObserver callback warning")};super(a)}observe(r,a){Ye(()=>{super.observe(r,a)},"ResizeObserver observe warning")}unobserve(r){Ye(()=>{super.unobserve(r)},"ResizeObserver unobserve warning")}disconnect(){Ye(()=>{super.disconnect()},"ResizeObserver disconnect warning")}})},fv=()=>{Ye(()=>{document.querySelectorAll("[data-runtime-error-overlay], [data-vite-error-overlay], .error-overlay").forEach(r=>{try{r.remove()}catch(a){console.debug("Emergency cleanup: Overlay removal warning:",a)}}),document.querySelectorAll("[data-radix-portal]").forEach(r=>{try{r.hasChildNodes()||r.remove()}catch(a){console.debug("Emergency cleanup: Portal removal warning:",a)}})},"Emergency DOM cleanup warning")},fl=()=>{let t=0;return Ye(()=>{const e=document.querySelectorAll("[data-radix-portal]:empty"),r=document.querySelectorAll("[data-runtime-error-overlay]");t+=e.length+r.length,t>0?(console.debug(`DOM health check: Found ${t} potential issues`),fv()):console.debug("DOM health check: All good!")},"DOM health check warning"),t===0},pv=()=>{console.debug("🔧 Applying removeChild error fix..."),(()=>{const a={removeChild:Node.prototype.removeChild,appendChild:Node.prototype.appendChild,insertBefore:Node.prototype.insertBefore,replaceChild:Node.prototype.replaceChild};Node.prototype.removeChild=function(n){try{return this&&n&&this.contains&&this.contains(n)?a.removeChild.call(this,n):(console.debug("RemoveChild Fix: Prevented invalid removal"),n)}catch(i){return console.debug("RemoveChild Fix: Caught error:",i),n}},Node.prototype.appendChild=function(n){try{return a.appendChild.call(this,n)}catch(i){return console.debug("RemoveChild Fix: AppendChild error:",i),n}},Node.prototype.insertBefore=function(n,i){try{return a.insertBefore.call(this,n,i)}catch(o){return console.debug("RemoveChild Fix: InsertBefore error:",o),n}},Node.prototype.replaceChild=function(n,i){try{return this&&i&&this.contains&&this.contains(i)?a.replaceChild.call(this,n,i):(console.debug("RemoveChild Fix: Prevented invalid replacement"),i)}catch(o){return console.debug("RemoveChild Fix: ReplaceChild error:",o),i}}})();const e=console.error;console.error=(...a)=>{const n=a.join(" ");if(n.includes("removeChild")||n.includes("Failed to execute 'removeChild'")||n.includes("plugin:runtime-error-plugin")||n.includes("server.hmr.overlay")){console.debug("RemoveChild Fix: Silenced error:",n);return}e.apply(console,a)},window.addEventListener("error",a=>{a.message&&a.message.includes("removeChild")&&(a.preventDefault(),console.debug("RemoveChild Fix: Prevented global error"))});const r=()=>{Ye(()=>{document.querySelectorAll("[data-runtime-error-overlay], [data-vite-error-overlay], .vite-error-overlay").forEach(n=>{try{n.parentNode&&n.parentNode.removeChild(n)}catch{console.debug("RemoveChild Fix: Overlay cleanup handled")}})},"Error overlay cleanup")};r(),document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",r),setInterval(r,5e3),console.debug("✅ RemoveChild error fix applied successfully")},ok=()=>{let t=0;const e=window.onerror;window.onerror=(r,a,n,i,o)=>typeof r=="string"&&r.includes("removeChild")?(t++,console.debug(`RemoveChild Monitor: Caught error #${t}`),t>3&&(console.debug("RemoveChild Monitor: Re-applying fix due to multiple errors"),pv(),t=0),!0):e?e(r,a,n,i,o):!1},lk=()=>{pv(),ok(),console.debug("🛡️ All removeChild fixes applied")},ck=()=>{console.debug("🛡️ Initializing BizChat safety systems...");try{sk(),mv(),lk(),fl(),dk(),uk(),console.debug("✅ BizChat safety systems initialized successfully")}catch(t){console.debug("⚠️ Safety system initialization warning:",t)}},dk=()=>{setInterval(()=>{fl()},3e4),setInterval(()=>{fv()},3e5)},uk=()=>{document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&setTimeout(()=>{fl()},1e3)})};ck();Im(document.getElementById("root")).render(s.jsx(ek,{}));
